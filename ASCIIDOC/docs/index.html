<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<title>Zalando RESTful API Guidelines</title>
<style>
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.spread { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: #6f6f6f; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #2ba6cb; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #2795b6; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: bold; font-style: normal; color: #222222; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #6f6f6f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; color: #7f0a0c; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }

blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

body { -moz-osx-font-smoothing: grayscale; -webkit-font-smoothing: antialiased; tab-size: 4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 0; line-height: inherit; word-wrap: break-word; }
*:not(pre) > code.nobreak { word-wrap: normal; }
*:not(pre) > code.nowrap { white-space: nowrap; }

pre, pre > code { line-height: 1.4; color: black; font-family: monospace, serif; font-weight: normal; }

em em { font-style: normal; }

strong strong { font-weight: normal; }

.keyseq { color: #555555; }

kbd { font-family: Consolas, "Liberation Mono", Courier, monospace; display: inline-block; color: #222222; font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menuref { color: #000; }

.menuseq b:not(.caret), .menuref { font-weight: inherit; }

.menuseq { word-spacing: -0.02em; }
.menuseq b.caret { font-size: 1.25em; line-height: 0.8; }
.menuseq i.caret { font-weight: bold; text-align: center; width: 0.45em; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: black; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #dddddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #dddddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #dddddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #555555; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #6f6f6f; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #6f6f6f; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: black; border-bottom: 1px solid #dddddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 1px solid #dddddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #6f6f6f; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #f2f2f2; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }

#footer-text { color: #dddddd; line-height: 1.44; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { .sect1 { padding-bottom: 1.25em; } }
.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #222222; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #151515; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: black; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: initial; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #555555; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #6f6f6f; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #eeeeee; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border: 1px solid #cccccc; -webkit-border-radius: 0; border-radius: 0; word-wrap: break-word; padding: 0.8em 0.8em 0.65em 0.8em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #eeeeee; background-color: black; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 0.8em 0.8em 0.65em 0.8em; -webkit-border-radius: 0; border-radius: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; line-height: 1.4; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: #6f6f6f; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #6f6f6f; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid #555555; }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #6f6f6f; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: #555555; }

.quoteblock.abstract { margin: 0 0 1.25em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dddddd; }

table.grid-all > thead > tr > .tableblock, table.grid-all > tbody > tr > .tableblock { border-width: 0 1px 1px 0; }

table.grid-all > tfoot > tr > .tableblock { border-width: 1px 1px 0 0; }

table.grid-cols > * > tr > .tableblock { border-width: 0 1px 0 0; }

table.grid-rows > thead > tr > .tableblock, table.grid-rows > tbody > tr > .tableblock { border-width: 0 0 1px 0; }

table.grid-rows > tfoot > tr > .tableblock { border-width: 1px 0 0 0; }

table.grid-all > * > tr > .tableblock:last-child, table.grid-cols > * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-all > tbody > tr:last-child > .tableblock, table.grid-all > thead:last-child > tr > .tableblock, table.grid-rows > tbody > tr:last-child > .tableblock, table.grid-rows > thead:last-child > tr > .tableblock { border-bottom-width: 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.4; background: whitesmoke; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222222; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.checklist, ul.none, ol.none, ul.no-bullet, ol.no-bullet, ol.unnumbered, ul.unstyled, ol.unstyled { list-style-type: none; }

ul.no-bullet, ol.no-bullet, ol.unnumbered { margin-left: 0.625em; }

ul.unstyled, ol.unstyled { margin-left: 0; }

ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1.25em; font-size: 0.8em; position: relative; bottom: 0.125em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 1.25em; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0.4em 0.75em 0 0.75em; line-height: 1; vertical-align: top; }
.colist > table tr > td:first-of-type img { max-width: initial; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.05em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }
a span.icon > .fa { cursor: inherit; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #207c98; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

.literalblock pre, .listingblock pre { background: #eeeeee; }

object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.spread { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: #6f6f6f; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #2ba6cb; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #2795b6; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: bold; font-style: normal; color: #404040; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #6f6f6f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; color: #7f0a0c; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }

blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

body { -moz-osx-font-smoothing: grayscale; -webkit-font-smoothing: antialiased; tab-size: 4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 0; line-height: inherit; word-wrap: break-word; }
*:not(pre) > code.nobreak { word-wrap: normal; }
*:not(pre) > code.nowrap { white-space: nowrap; }

pre, pre > code { line-height: 1.4; color: black; font-family: monospace, serif; font-weight: normal; }

em em { font-style: normal; }

strong strong { font-weight: normal; }

.keyseq { color: #555555; }

kbd { font-family: Consolas, "Liberation Mono", Courier, monospace; display: inline-block; color: #222222; font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menuref { color: #000; }

.menuseq b:not(.caret), .menuref { font-weight: inherit; }

.menuseq { word-spacing: -0.02em; }
.menuseq b.caret { font-size: 1.25em; line-height: 0.8; }
.menuseq i.caret { font-weight: bold; text-align: center; width: 0.45em; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: black; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #dddddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #dddddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #dddddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #555555; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #6f6f6f; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #6f6f6f; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: black; border-bottom: 1px solid #dddddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 1px solid #dddddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #6f6f6f; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #f2f2f2; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }

#footer-text { color: #dddddd; line-height: 1.44; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { .sect1 { padding-bottom: 1.25em; } }
.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #404040; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #333333; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: black; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: initial; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #555555; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #6f6f6f; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #eeeeee; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border: 1px solid #cccccc; -webkit-border-radius: 0; border-radius: 0; word-wrap: break-word; padding: 0.8em 0.8em 0.65em 0.8em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #eeeeee; background-color: black; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 0.8em 0.8em 0.65em 0.8em; -webkit-border-radius: 0; border-radius: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; line-height: 1.4; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: #6f6f6f; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #6f6f6f; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid #555555; }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #6f6f6f; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: #555555; }

.quoteblock.abstract { margin: 0 0 1.25em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dddddd; }

table.grid-all > thead > tr > .tableblock, table.grid-all > tbody > tr > .tableblock { border-width: 0 1px 1px 0; }

table.grid-all > tfoot > tr > .tableblock { border-width: 1px 1px 0 0; }

table.grid-cols > * > tr > .tableblock { border-width: 0 1px 0 0; }

table.grid-rows > thead > tr > .tableblock, table.grid-rows > tbody > tr > .tableblock { border-width: 0 0 1px 0; }

table.grid-rows > tfoot > tr > .tableblock { border-width: 1px 0 0 0; }

table.grid-all > * > tr > .tableblock:last-child, table.grid-cols > * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-all > tbody > tr:last-child > .tableblock, table.grid-all > thead:last-child > tr > .tableblock, table.grid-rows > tbody > tr:last-child > .tableblock, table.grid-rows > thead:last-child > tr > .tableblock { border-bottom-width: 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.4; background: whitesmoke; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222222; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.checklist, ul.none, ol.none, ul.no-bullet, ol.no-bullet, ol.unnumbered, ul.unstyled, ol.unstyled { list-style-type: none; }

ul.no-bullet, ol.no-bullet, ol.unnumbered { margin-left: 0.625em; }

ul.unstyled, ol.unstyled { margin-left: 0; }

ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1.25em; font-size: 0.8em; position: relative; bottom: 0.125em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 1.25em; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0.4em 0.75em 0 0.75em; line-height: 1; vertical-align: top; }
.colist > table tr > td:first-of-type img { max-width: initial; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.05em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }
a span.icon > .fa { cursor: inherit; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #207c98; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Zalando RESTful API Guidelines</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#conventions-used-in-these-guidelines">1.1. Conventions Used in These Guidelines</a></li>
<li><a href="#zalando-specific-information">1.2. Zalando specific information</a></li>
</ul>
</li>
<li><a href="#principles">2. Principles</a>
<ul class="sectlevel2">
<li><a href="#api-as-a-product">2.1. API as a Product</a></li>
<li><a href="#api-design-principles">2.2. API Design Principles</a></li>
</ul>
</li>
<li><a href="#general-guidelines">3. General Guidelines</a>
<ul class="sectlevel2">
<li><a href="#book.must-follow-api-first-principle">3.1. <span style="color:#bf0000"><strong>MUST</strong></span> Follow API First Principle</a></li>
<li><a href="#book.must-provide-api-reference-definition-using-openapi">3.2. <span style="color:#bf0000"><strong>MUST</strong></span> Provide API Reference Definition using OpenAPI</a></li>
<li><a href="#book.should-provide-user-manual-documentation">3.3. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Provide User Manual Documentation</a></li>
<li><a href="#book.must-write-apis-in-u.s.-english">3.4. <span style="color:#bf0000"><strong>MUST</strong></span> Write APIs in U.S. English</a></li>
</ul>
</li>
<li><a href="#security">4. Security</a>
<ul class="sectlevel2">
<li><a href="#book.must-secure-endpoints-with-oauth-2.0">4.1. <span style="color:#bf0000"><strong>MUST</strong></span> Secure Endpoints with OAuth 2.0</a></li>
<li><a href="#book.must-define-and-assign-access-rights-scopes">4.2. <span style="color:#bf0000"><strong>MUST</strong></span> Define and Assign Access Rights (Scopes)</a></li>
</ul>
</li>
<li><a href="#compatibility">5. Compatibility</a>
<ul class="sectlevel2">
<li><a href="#book.must-dont-break-backward-compatibility">5.1. <span style="color:#bf0000"><strong>MUST</strong></span> Dont Break Backward Compatibility</a></li>
<li><a href="#book.should-prefer-compatible-extensions">5.2. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Prefer Compatible Extensions</a></li>
<li><a href="#book.must-prepare-clients-to-not-crash-on-compatible-api-extensions">5.3. <span style="color:#bf0000"><strong>MUST</strong></span> Prepare Clients To Not Crash On Compatible API Extensions</a></li>
<li><a href="#book.should-design-apis-conservatively">5.4. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Design APIs Conservatively</a></li>
<li><a href="#book.must-always-return-json-objects-as-top-level-data-structures-to-support-extensibility">5.5. <span style="color:#bf0000"><strong>MUST</strong></span> Always Return JSON Objects As Top-Level Data Structures To Support Extensibility</a></li>
<li><a href="#book.must-treat-open-api-definitions-as-open-for-extension-by-default">5.6. <span style="color:#bf0000"><strong>MUST</strong></span> Treat Open API Definitions As Open For Extension By Default</a></li>
<li><a href="#book.should-used-open-ended-list-of-values-x-extensible-enum-instead-of-enumerations">5.7. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Used Open-Ended List of Values (x-extensible-enum) Instead of Enumerations</a></li>
<li><a href="#book.should-avoid-versioning">5.8. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Avoid Versioning</a></li>
<li><a href="#book.must-use-media-type-versioning">5.9. <span style="color:#bf0000"><strong>MUST</strong></span> Use Media Type Versioning</a></li>
<li><a href="#book.must-do-not-use-uri-versioning">5.10. <span style="color:#bf0000"><strong>MUST</strong></span> Do Not Use URI Versioning</a></li>
</ul>
</li>
<li><a href="#json-guidelines">6. JSON Guidelines</a>
<ul class="sectlevel2">
<li><a href="#book.must-use-consistent-property-names">6.1. <span style="color:#bf0000"><strong>MUST</strong></span> Use Consistent Property Names</a></li>
<li><a href="#book.must-property-names-must-be-snake_case-and-never-camelcase.">6.2. <span style="color:#bf0000"><strong>MUST</strong></span> Property names must be snake_case (and never camelCase).</a></li>
<li><a href="#book.must-property-names-must-be-an-ascii-subset">6.3. <span style="color:#bf0000"><strong>MUST</strong></span> Property names must be an ASCII subset</a></li>
<li><a href="#book.should-array-names-should-be-pluralized">6.4. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Array names should be pluralized</a></li>
<li><a href="#book.must-use-consistent-property-values">6.5. <span style="color:#bf0000"><strong>MUST</strong></span> Use Consistent Property Values</a></li>
<li><a href="#book.must-boolean-property-values-must-not-be-null">6.6. <span style="color:#bf0000"><strong>MUST</strong></span> Boolean property values must not be null</a></li>
<li><a href="#book.should-null-values-should-have-their-fields-removed">6.7. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Null values should have their fields removed</a></li>
<li><a href="#book.should-empty-array-values-should-not-be-null">6.8. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Empty array values should not be null</a></li>
<li><a href="#book.should-enumerations-should-be-represented-as-strings">6.9. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Enumerations should be represented as Strings</a></li>
<li><a href="#book.should-date-property-values-should-conform-to-rfc-3399">6.10. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Date property values should conform to RFC 3399</a></li>
<li><a href="#book.may-time-durations-and-intervals-could-conform-to-iso-8601">6.11. <span style="color:#006000"><strong>MAY</strong></span> Time durations and intervals could conform to ISO 8601</a></li>
<li><a href="#book.may-standards-could-be-used-for-language-country-and-currency">6.12. <span style="color:#006000"><strong>MAY</strong></span> Standards could be used for Language, Country and Currency</a></li>
<li><a href="#book.must-use-lowercase-separate-words-with-hyphens-for-path-segments">6.13. <span style="color:#bf0000"><strong>MUST</strong></span> Use lowercase separate words with hyphens for Path Segments</a></li>
<li><a href="#book.must-use-snake_case-never-camelcase-for-query-parameters">6.14. <span style="color:#bf0000"><strong>MUST</strong></span> Use snake_case (never camelCase) for Query Parameters</a></li>
<li><a href="#book.must-use-hyphenated-http-headers">6.15. <span style="color:#bf0000"><strong>MUST</strong></span> Use Hyphenated HTTP Headers</a></li>
<li><a href="#book.should-prefer-hyphenated-pascal-case-for-http-header-fields">6.16. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Prefer Hyphenated-Pascal-Case for HTTP header Fields</a></li>
<li><a href="#book.may-use-standardized-headers">6.17. <span style="color:#006000"><strong>MAY</strong></span> Use Standardized Headers</a></li>
<li><a href="#book.must-pluralize-resource-names">6.18. <span style="color:#bf0000"><strong>MUST</strong></span> Pluralize Resource Names</a></li>
<li><a href="#book.may-use-api-as-first-path-segment">6.19. <span style="color:#006000"><strong>MAY</strong></span> Use /api as first Path Segment</a></li>
<li><a href="#book.must-avoid-trailing-slashes">6.20. <span style="color:#bf0000"><strong>MUST</strong></span> Avoid Trailing Slashes</a></li>
<li><a href="#book.may-use-conventional-query-strings">6.21. <span style="color:#006000"><strong>MAY</strong></span> Use Conventional Query Strings</a></li>
<li><a href="#book.must-avoid-actions-think-about-resources">6.22. <span style="color:#bf0000"><strong>MUST</strong></span> Avoid Actions  Think About Resources</a></li>
<li><a href="#book.should-model-complete-business-processes">6.23. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Model complete business processes</a></li>
<li><a href="#book.should-define-useful-resources">6.24. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Define <em>useful</em> resources</a></li>
<li><a href="#book.must-keep-urls-verb-free">6.25. <span style="color:#bf0000"><strong>MUST</strong></span> Keep URLs Verb-Free</a></li>
<li><a href="#book.must-use-domain-specific-resource-names">6.26. <span style="color:#bf0000"><strong>MUST</strong></span> Use Domain-Specific Resource Names</a></li>
<li><a href="#book.must-identify-resources-and-sub-resources-via-path-segments">6.27. <span style="color:#bf0000"><strong>MUST</strong></span> Identify resources and Sub-Resources via Path Segments</a></li>
<li><a href="#book.should-only-use-uuids-if-necessary">6.28. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Only Use UUIDs If Necessary</a></li>
<li><a href="#book.may-consider-using-non--nested-urls">6.29. <span style="color:#006000"><strong>MAY</strong></span> Consider Using (Non-) Nested URLs</a></li>
<li><a href="#book.should-limit-number-of-resources">6.30. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Limit number of Resources</a></li>
<li><a href="#book.should-limit-number-of-sub-resource-levels">6.31. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Limit number of Sub-Resource Levels</a></li>
</ul>
</li>
<li><a href="#http">7. HTTP</a>
<ul class="sectlevel2">
<li><a href="#book.must-use-http-methods-correctly">7.1. <span style="color:#bf0000"><strong>MUST</strong></span> Use HTTP Methods Correctly</a></li>
<li><a href="#book.must-fulfill-safeness-and-idempotency-properties">7.2. <span style="color:#bf0000"><strong>MUST</strong></span> Fulfill Safeness and Idempotency Properties</a></li>
<li><a href="#book.must-use-specific-http-status-codes">7.3. <span style="color:#bf0000"><strong>MUST</strong></span> Use Specific HTTP Status Codes</a></li>
<li><a href="#book.must-provide-error-documentation">7.4. <span style="color:#bf0000"><strong>MUST</strong></span> Provide Error Documentation</a></li>
<li><a href="#book.must-use-207-for-batch-or-bulk-requests">7.5. <span style="color:#bf0000"><strong>MUST</strong></span> Use 207 for Batch or Bulk Requests</a></li>
<li><a href="#book.must-use-429-with-headers-for-rate-limits">7.6. <span style="color:#bf0000"><strong>MUST</strong></span> Use 429 with Headers for Rate Limits</a></li>
<li><a href="#book.should-explicitly-define-the-collection-format-of-query-parameters">7.7. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Explicitly define the Collection Format of Query Parameters</a></li>
</ul>
</li>
<li><a href="#performance">8. Performance</a>
<ul class="sectlevel2">
<li><a href="#book.should-reduce-bandwidth-needs-and-improve-responsiveness">8.1. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Reduce Bandwidth Needs and Improve Responsiveness</a></li>
<li><a href="#book.should-use-gzip-compression">8.2. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Use gzip Compression</a></li>
<li><a href="#book.should-support-filtering-of-resource-fields">8.3. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Support Filtering of Resource Fields</a></li>
<li><a href="#book.should-allow-optional-embedding-of-sub-resources">8.4. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Allow Optional Embedding of Sub-Resources</a></li>
</ul>
</li>
<li><a href="#pagination">9. Pagination</a>
<ul class="sectlevel2">
<li><a href="#book.must-support-pagination">9.1. <span style="color:#bf0000"><strong>MUST</strong></span> Support Pagination</a></li>
<li><a href="#book.should-prefer-cursor-based-pagination-avoid-offset-based-pagination">9.2. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Prefer Cursor-Based Pagination, Avoid Offset-Based Pagination</a></li>
<li><a href="#book.may-use-pagination-links-where-applicable">9.3. <span style="color:#006000"><strong>MAY</strong></span> Use Pagination Links Where Applicable</a></li>
</ul>
</li>
<li><a href="#hypermedia">10. Hypermedia</a>
<ul class="sectlevel2">
<li><a href="#book.must-use-rest-maturity-level-2">10.1. <span style="color:#bf0000"><strong>MUST</strong></span> Use REST Maturity Level 2</a></li>
<li><a href="#book.may-use-rest-maturity-level-3---hateoas">10.2. <span style="color:#006000"><strong>MAY</strong></span> Use REST Maturity Level 3 - HATEOAS</a></li>
<li><a href="#book.must-use-common-hypertext-controls">10.3. <span style="color:#bf0000"><strong>MUST</strong></span> Use Common Hypertext Controls</a></li>
<li><a href="#book.should-use-simple-hypertext-controls-for-pagination-and-self-references">10.4. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Use Simple Hypertext Controls for Pagination and Self-References</a></li>
<li><a href="#book.must-not-use-link-headers-with-json-entities">10.5. <span style="color:#bf0000"><strong>MUST</strong></span> Not Use Link Headers with JSON entities</a></li>
</ul>
</li>
<li><a href="#data-formats">11. Data Formats</a>
<ul class="sectlevel2">
<li><a href="#book.must-use-json-to-encode-structured-data">11.1. <span style="color:#bf0000"><strong>MUST</strong></span> Use JSON to Encode Structured Data</a></li>
<li><a href="#book.may-use-non-json-media-types-for-binary-data-or-alternative-content-representations">11.2. <span style="color:#006000"><strong>MAY</strong></span> Use non JSON Media Types for Binary Data or Alternative Content Representations</a></li>
<li><a href="#book.must-use-standard-date-and-time-formats">11.3. <span style="color:#bf0000"><strong>MUST</strong></span> Use Standard Date and Time Formats</a></li>
<li><a href="#book.may-use-standards-for-country-language-and-currency-codes">11.4. <span style="color:#006000"><strong>MAY</strong></span> Use Standards for Country, Language and Currency Codes</a></li>
<li><a href="#book.must-define-format-for-type-number-and-integer">11.5. <span style="color:#bf0000"><strong>MUST</strong></span> Define Format for Type Number and Integer</a></li>
<li><a href="#book.should-prefer-standard-media-type-name-applicationjson">11.6. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Prefer standard Media type name <code>application/json</code></a></li>
</ul>
</li>
<li><a href="#common-data-types">12. Common Data Types</a>
<ul class="sectlevel2">
<li><a href="#book.should-use-a-common-money-object">12.1. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Use a Common Money Object</a></li>
<li><a href="#book.must-use-common-field-names-and-semantics">12.2. <span style="color:#bf0000"><strong>MUST</strong></span> Use common field names and semantics</a></li>
<li><a href="#book.must-follow-hypertext-control-conventions">12.3. <span style="color:#bf0000"><strong>MUST</strong></span> Follow Hypertext Control Conventions</a></li>
<li><a href="#book.must-use-problem-json">12.4. <span style="color:#bf0000"><strong>MUST</strong></span> Use Problem JSON</a></li>
<li><a href="#book.must-do-not-expose-stack-traces">12.5. <span style="color:#bf0000"><strong>MUST</strong></span> Do not expose Stack Traces</a></li>
</ul>
</li>
<li><a href="#common-headers">13. Common Headers</a>
<ul class="sectlevel2">
<li><a href="#book.must-use-content-headers-correctly">13.1. <span style="color:#bf0000"><strong>MUST</strong></span> Use Content Headers Correctly</a></li>
<li><a href="#book.may-use-content-location-header">13.2. <span style="color:#006000"><strong>MAY</strong></span> Use Content-Location Header</a></li>
<li><a href="#book.should-use-location-header-instead-of-content-location-header">13.3. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Use Location Header instead of Content-Location Header</a></li>
<li><a href="#book.may-use-the-prefer-header-to-indicate-processing-preferences">13.4. <span style="color:#006000"><strong>MAY</strong></span> Use the Prefer header to indicate processing preferences</a></li>
<li><a href="#book.may-consider-using-etag-together-with-if-none-match-header">13.5. <span style="color:#006000"><strong>MAY</strong></span> Consider using ETag together with If-(None-)Match header</a></li>
</ul>
</li>
<li><a href="#proprietary-headers">14. Proprietary Headers</a>
<ul class="sectlevel2">
<li><a href="#book.must-use-only-the-specified-proprietary-zalando-headers">14.1. <span style="color:#bf0000"><strong>MUST</strong></span> Use Only the Specified Proprietary Zalando Headers</a></li>
<li><a href="#book.must-propagate-proprietary-headers">14.2. <span style="color:#bf0000"><strong>MUST</strong></span> Propagate Proprietary Headers</a></li>
</ul>
</li>
<li><a href="#deprecation">15. Deprecation</a>
<ul class="sectlevel2">
<li><a href="#book.must-obtain-approval-of-clients">15.1. <span style="color:#bf0000"><strong>MUST</strong></span> Obtain Approval of Clients</a></li>
<li><a href="#book.must-external-partners-must-agree-on-deprecation-timespan">15.2. <span style="color:#bf0000"><strong>MUST</strong></span> External Partners Must Agree on Deprecation Timespan</a></li>
<li><a href="#book.must-reflect-deprecation-in-api-definition">15.3. <span style="color:#bf0000"><strong>MUST</strong></span> Reflect Deprecation in API Definition</a></li>
<li><a href="#book.must-monitor-usage-of-deprecated-apis">15.4. <span style="color:#bf0000"><strong>MUST</strong></span> Monitor Usage of Deprecated APIs</a></li>
<li><a href="#book.should-add-a-warning-header-to-responses">15.5. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Add a Warning Header to Responses</a></li>
<li><a href="#book.should-add-monitoring-for-warning-header">15.6. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Add Monitoring for Warning Header</a></li>
<li><a href="#book.must-not-start-using-deprecated-apis">15.7. <span style="color:#bf0000"><strong>MUST</strong></span> Not Start Using Deprecated APIs</a></li>
</ul>
</li>
<li><a href="#api-operation">16. API Operation</a>
<ul class="sectlevel2">
<li><a href="#book.must-provide-online-access-to-openapi-reference-definition">16.1. <span style="color:#bf0000"><strong>MUST</strong></span> Provide Online Access to OpenAPI Reference Definition</a></li>
<li><a href="#book.should-monitor-api-usage">16.2. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Monitor API Usage</a></li>
</ul>
</li>
<li><a href="#events">17. Events</a>
<ul class="sectlevel2">
<li><a href="#book.must-treat-events-as-part-of-the-service-interface">17.1. <span style="color:#bf0000"><strong>MUST</strong></span> Treat Events as part of the service interface</a></li>
<li><a href="#book.must-make-events-available-for-review">17.2. <span style="color:#bf0000"><strong>MUST</strong></span> Make Events available for review</a></li>
<li><a href="#book.must-ensure-event-type-schemas-conform-to-open-apis-schema-object">17.3. <span style="color:#bf0000"><strong>MUST</strong></span> Ensure Event Type schemas conform to Open API&#8217;s Schema Object</a></li>
<li><a href="#book.must-ensure-that-events-are-registered-as-event-types">17.4. <span style="color:#bf0000"><strong>MUST</strong></span> Ensure that Events are registered as Event Types</a></li>
<li><a href="#book.must-ensure-events-conform-to-a-well-known-event-category">17.5. <span style="color:#bf0000"><strong>MUST</strong></span> Ensure Events conform to a well-known Event Category</a></li>
<li><a href="#book.must-ensure-that-events-define-useful-business-resources">17.6. <span style="color:#bf0000"><strong>MUST</strong></span> Ensure that Events define useful business resources</a></li>
<li><a href="#book.must-events-must-not-provide-sensitive-customer-personal-data.">17.7. <span style="color:#bf0000"><strong>MUST</strong></span> Events must not provide sensitive customer personal data.</a></li>
<li><a href="#book.must-use-the-general-event-category-to-signal-steps-and-arrival-points-in-business-processes">17.8. <span style="color:#bf0000"><strong>MUST</strong></span> Use the General Event Category to signal steps and</a></li>
<li><a href="#book.must-use-data-change-events-to-signal-mutations">17.9. <span style="color:#bf0000"><strong>MUST</strong></span> Use Data Change Events to signal mutations</a></li>
<li><a href="#book.should-provide-a-means-for-explicit-event-ordering">17.10. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Provide a means for explicit event ordering</a></li>
<li><a href="#book.should-use-the-hash-partition-strategy-for-data-change-events">17.11. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Use the hash partition strategy for Data Change Events</a></li>
<li><a href="#book.should-ensure-that-data-change-events-match-api-representations">17.12. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Ensure that Data Change Events match API representations</a></li>
<li><a href="#book.must-permissions-on-events-must-correspond-to-api-permissions">17.13. <span style="color:#bf0000"><strong>MUST</strong></span> Permissions on events must correspond to API permissions</a></li>
<li><a href="#book.must-indicate-ownership-of-event-types">17.14. <span style="color:#bf0000"><strong>MUST</strong></span> Indicate ownership of Event Types</a></li>
<li><a href="#book.must-define-event-payloads-in-accordance-with-the-overall-guidelines">17.15. <span style="color:#bf0000"><strong>MUST</strong></span> Define Event Payloads in accordance with the overall Guidelines</a></li>
<li><a href="#book.must-maintain-backwards-compatibility-for-events">17.16. <span style="color:#bf0000"><strong>MUST</strong></span> Maintain backwards compatibility for Events</a></li>
<li><a href="#book.should-avoid-additionalproperties-in-event-type-definitions">17.17. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Avoid <code>additionalProperties</code> in event type definitions</a></li>
<li><a href="#book.must-use-unique-event-identifiers">17.18. <span style="color:#bf0000"><strong>MUST</strong></span> Use unique Event identifiers</a></li>
<li><a href="#book.should-design-for-idempotent-out-of-order-processing">17.19. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Design for idempotent out-of-order processing</a></li>
<li><a href="#book.must-follow-conventions-for-event-type-names">17.20. <span style="color:#bf0000"><strong>MUST</strong></span> Follow conventions for Event Type names</a></li>
<li><a href="#book.must-prepare-for-duplicate-events">17.21. <span style="color:#bf0000"><strong>MUST</strong></span> Prepare for duplicate Events</a></li>
</ul>
</li>
<li><a href="#references">18. Appendix: References</a>
<ul class="sectlevel2">
<li><a href="#references-open-api-specification">18.1. OpenAPI Specification</a></li>
<li><a href="#references-publications-specifications-and-standards">18.2. Publications, specifications and standards</a></li>
<li><a href="#references-dissertations">18.3. Dissertations</a></li>
<li><a href="#references-books">18.4. Books</a></li>
<li><a href="#references-blogs">18.5. Blogs</a></li>
</ul>
</li>
<li><a href="#appendix-tooling">19. Appendix: Tooling</a>
<ul class="sectlevel2">
<li><a href="#api-first-integrations">19.1. API First Integrations</a></li>
<li><a href="#support-libraries">19.2. Support Libraries</a></li>
<li><a href="#rule-changes">19.3. Rule Changes</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="assets/api-zalando-small.jpg" alt="API Guild Logo">
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="api-zalando-small.jpg" alt="APIGuild icon"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="link" href="#introduction">1. Introduction</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Zalandos software architecture centers around decoupled microservices
that provide functionality via RESTful APIs with a JSON payload. Small
engineering teams own, deploy and operate these microservices in their
AWS (team) accounts. Our APIs most purely express what our systems do,
and are therefore highly valuable business assets. Designing
high-quality, long-lasting APIs has become even more critical for us
since we started developing our new open platform strategy, which
transforms Zalando from an online shop into an expansive fashion
platform. Our strategy emphasizes developing lots of public APIs for our
external business partners to use via third-party applications.</p>
</div>
<div class="paragraph">
<p>With this in mind, weve adopted API First as one of our key
engineering principles. Microservices development begins with API
definition outside the code and ideally involves ample peer-review
feedback to achieve high-quality APIs. API First encompasses a set of
quality-related standards and fosters a peer review culture including a
lightweight review procedure. We encourage our teams to follow them to
ensure that our APIs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>are easy to understand and learn</p>
</li>
<li>
<p>are general and abstracted from specific implementation and use cases</p>
</li>
<li>
<p>are robust and easy to use</p>
</li>
<li>
<p>have a common look and feel</p>
</li>
<li>
<p>follow a consistent RESTful style and syntax</p>
</li>
<li>
<p>are consistent with other teams APIs and our global architecture</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Ideally, all Zalando APIs will look like the same author created them.</p>
</div>
<div class="sect2">
<h3 id="conventions-used-in-these-guidelines"><a class="link" href="#conventions-used-in-these-guidelines">1.1. Conventions Used in These Guidelines</a></h3>
<div class="paragraph">
<p>The requirement level keywords "MUST", "MUST NOT", "REQUIRED", "SHALL",
"SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
"OPTIONAL" used in this document (case insensitive) are to be
interpreted as described in <a href="https://www.ietf.org/rfc/rfc2119.txt">RFC
2119</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="zalando-specific-information"><a class="link" href="#zalando-specific-information">1.2. Zalando specific information</a></h3>
<div class="paragraph">
<p>The purpose of our RESTful API guidelines is to define standards to
successfully establish consistent API look and feel quality. The
<a href="https://techwiki.zalando.net/display/GUL/API+Guild">API Guild [internal
link</a>] drafted and owns this document. Teams are responsible to fulfill
these guidelines during API development and are encouraged to contribute
to guideline evolution via pull requests.</p>
</div>
<div class="paragraph">
<p>These guidelines will, to some extent, remain work in progress as our
work evolves, but teams can confidently follow and trust them.</p>
</div>
<div class="paragraph">
<p>In case guidelines are changing, following rules apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>existing APIs don&#8217;t have to be changed, but we recommend it</p>
</li>
<li>
<p>clients of existing APIs have to cope with these APIs based on
outdated rules</p>
</li>
<li>
<p>new APIs have to respect the current guidelines</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Furthermore you should keep in mind that once an API becomes public
externally available, it has to be re-reviewed and changed according to
current guidelines - for sake of overall consistency.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="principles"><a class="link" href="#principles">2. Principles</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="api-as-a-product"><a class="link" href="#api-as-a-product">2.1. API as a Product</a></h3>
<div class="paragraph">
<p>As mentioned above, Zalando is transforming from an online shop into an
expansive fashion platform comprising a rich set of products following a
Software as a Platform (SaaS) model for our business partners. As a
company we want to deliver products to our (internal and external)
customers which can be consumed like a service.</p>
</div>
<div class="paragraph">
<p>Platform products provide their functionality via (public) APIs; hence,
the design of our APIs should be based on the API as a Product
principle:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Treat your API as product and understand the needs of its customers</p>
</li>
<li>
<p>Take ownership and advocate for the customer and continuous
improvement</p>
</li>
<li>
<p>Emphasize easy understanding, discovery and usage of APIs; design APIs
irresistible for client engineers</p>
</li>
<li>
<p>Actively improve and maintain API consistency over the long term</p>
</li>
<li>
<p>Make use of customer feedback and provide service level support</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>RESTful API as a Product makes the difference between enterprise
integration business and agile, innovative product service business
built on a platform of APIs.</p>
</div>
<div class="paragraph">
<p>Based on your concrete customer use cases, you should carefully check
the trade-offs of API design variants and avoid short-term server side
implementation optimizations at the expense of unnecessary client side
obligations and have a high attention on API quality and client
developer experience.</p>
</div>
<div class="paragraph">
<p>API as a Product is closely related to our
<a href="../general-guidelines/GeneralGuidelines.md#Must-Follow-API-First-Principle">API
First principle</a> (see next chapter) which is more focussed on how we
engineer high quality APIs.</p>
</div>
</div>
<div class="sect2">
<h3 id="api-design-principles"><a class="link" href="#api-design-principles">2.2. API Design Principles</a></h3>
<div class="paragraph">
<p>Comparing SOA web service interfacing style of SOAP vs. REST, the former
tend to be centered around operations that are usually use-case specific
and specialized. In contrast, REST is centered around business (data)
entities exposed as resources that are identified via URIs and can be
manipulated via standardized CRUD-like methods using different
representations, self-descriptive messages and hypermedia. RESTful APIs
tend to be less use-case specific and comes with less rigid client /
server coupling and are more suitable as a platform interface being open
for diverse client applications.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We prefer REST-based APIs with JSON payloads</p>
</li>
<li>
<p>We prefer systems to be truly RESTful</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We apply the RESTful web service principles to all kind of application
components, whether they provide functionality via the Internet or via
the intranet as larger application elements. We strive to build
interoperating distributed systems that different teams can evolve in
parallel.</p>
</div>
<div class="paragraph">
<p>An important principle for (RESTful) API design and usage is Postel&#8217;s
Law, aka <a href="http://en.wikipedia.org/wiki/Robustness_principle">the
Robustness Principle</a> (RFC 1122):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Be liberal in what you accept, be conservative in what you send</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Readings:</em> Read the following to gain additional insight on the RESTful
service architecture paradigm and general RESTful API design style:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Book:
<a href="https://www.amazon.de/Irresistible-APIs-Designing-that-developers/dp/1617292559">Irresistable
APIs: Designing web APIs that developers will love</a></p>
</li>
<li>
<p>Book:
<a href="http://www.amazon.de/REST-Practice-Hypermedia-Systems-Architecture/dp/0596805829">REST
in Practice: Hypermedia and Systems Architecture</a></p>
</li>
<li>
<p>Book: <a href="https://leanpub.com/build-apis-you-wont-hate">Build APIs You
Won&#8217;t Hate</a></p>
</li>
<li>
<p>InfoQ eBook: <a href="http://www.infoq.com/minibooks/emag-web-api">Web APIs:
From Start to Finish</a></p>
</li>
<li>
<p>Lessons-learned blog:
<a href="http://restful-api-design.readthedocs.org/en/latest/">Thoughts on RESTful
API Design</a></p>
</li>
<li>
<p>Fielding Dissertation:
<a href="http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm">Architectural
Styles and the Design of Network-Based Software Architectures</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Footnote:</em> Per definition of R.Fielding REST APIs have to support
HATEOAS (maturity level 3). Our guidelines do not strongly advocate for
full REST compliance, but limited hypermedia usage, e.g. for pagination
(see <a href="../hyper-media/Hypermedia.md#Hypermedia">Hypermedia Section</a>
below). However, we still use the term "RESTful API", due to the absence
of an alternative established term and to keep it like the very majority
of web service industry that also use the term for their REST
approximations  in fact, in today&#8217;s industry full HATEOAS compliant
APIs are a very rare exception.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="general-guidelines"><a class="link" href="#general-guidelines">3. General Guidelines</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The titles are marked with the corresponding labels: <span style="color:#bf0000"><strong>MUST</strong></span>,
<span style="color:#bfbf00"><strong>SHOULD</strong></span>, <span style="color:#006000"><strong>MAY</strong></span>.</p>
</div>
<div class="sect2">
<h3 id="book.must-follow-api-first-principle"><a class="link" href="#book.must-follow-api-first-principle">3.1. <span style="color:#bf0000"><strong>MUST</strong></span> Follow API First Principle</a></h3>
<div class="paragraph">
<p>As mentioned in the introduction, API First is one of our
<a href="https://github.com/zalando-incubator/zalando-tech-principles">engineering
and architecture principles</a>. In a nutshell API First requires two
aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>define APIs outside the code first using a standard specification
language</p>
</li>
<li>
<p>get early review feedback from peers and client developers</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By defining APIs outside the code, we want to facilitate early review
feedback and also a development discipline that focus service interface
design on&#8230;&#8203;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>profound understanding of the domain and required functionality</p>
</li>
<li>
<p>generalized business entities / resources, i.e. avoidance of use case
specific APIs</p>
</li>
<li>
<p>clear separation of WHAT vs. HOW concerns, i.e. abstraction from
implementation aspects  APIs should be stable even if we replace
complete service implementation including its underlying technology
stack</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Moreover, API definitions with standardized specification format also
facilitate&#8230;&#8203;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>single source of truth for the API specification; it is a crucial part
of a contract between service provider and client users</p>
</li>
<li>
<p>infrastructure tooling for API discovery, API GUIs, API documents,
automated quality checks</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An element of API First are also this API Guidelines and a
<a href="https://github.bus.zalan.do/ApiGuild/ApiReviewProcedure">lightweight API
review process [internal link</a>] as to get early review feedback from
peers and client developers. Peer review is important for us to get high
quality APIs, to enable architectural and design alignment and to
supported development of client applications decoupled from service
provider engineering life cycle.</p>
</div>
<div class="paragraph">
<p>It is important to learn, that API First is <strong>not in conflict with the
agile development principles</strong> that we love. Service applications should
evolve incrementally  and so its APIs. Of course, our API specification
will and should evolve iteratively in different cycles; however, each
starting with draft status and <em>early</em> team and peer review feedback.
API may change and profit from implementation concerns and automated
testing feedback. API evolution during development life cycle may
include breaking changes for not yet productive features and as long as
we have aligned the changes with the clients. Hence, API First does
<em>not</em> mean that you must have 100% domain and requirement understanding
and can never produce code before you have defined the complete API and
get it confirmed by peer review. On the other hand, API First obviously
is in conflict with the bad practice of publishing API definition and
asking for peer review after the service integration or even the service
productive operation has started. It is crucial to request and get early
feedback  as early as possible, but not before the API changes are
comprehensive with focus to the next evolution step and have a certain
quality (including API Guideline compliance), already confirmed via team
internal reviews.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-provide-api-reference-definition-using-openapi"><a class="link" href="#book.must-provide-api-reference-definition-using-openapi">3.2. <span style="color:#bf0000"><strong>MUST</strong></span> Provide API Reference Definition using OpenAPI</a></h3>
<div class="paragraph">
<p>We use the <a href="http://swagger.io/specification/">OpenAPI specification</a> (aka
Swagger spec) as standard for our REST API definitions. You <strong>have to
provide the API definition in YAML format</strong> (instead of JSON) for the
OpenAPI API definition files due to its improved readability.</p>
</div>
<div class="paragraph">
<p>Please stick to version 2.0 of the specification for now, until we
succeed to update all our tooling to support the upcoming version 3.0.</p>
</div>
<div class="paragraph">
<p>We also call the OpenAPI API definition the "API Reference definition"
(or "API definition"); as a reference manual it provides all information
needed by an experienced API client developer to use this API.</p>
</div>
<div class="paragraph">
<p>The OpenAPI API specification file should be subject of version control
together with source code management. Services also have to support an
<a href="../api-operation/ApiOperation.md#must-Provide-Online-Access-to-OpenAPI-Reference-Definition">endpoint
to access the API Reference definition</a> for their external API(s).</p>
</div>
<div class="paragraph">
<p>Furthermore you should make use of
<a href="https://github.com/zalando-incubator/zally">Zally</a>, our own API linter
which supports you in designing a guideline compliant API. You find more
information in the Github repository itself and in
<a href="https://pages.github.bus.zalan.do/ApiGuild/ApiReviewProcedure/">API
review procedures [internal link</a>].</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-provide-user-manual-documentation"><a class="link" href="#book.should-provide-user-manual-documentation">3.3. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Provide User Manual Documentation</a></h3>
<div class="paragraph">
<p>In addition to the API as OpenAPI Reference Definition, its good
practice to provide an API User Manual documentation to improve client
developer experience, especially of engineers that are less experienced
in using this API. A helpful API User Manual typically describes the
following API aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>APIs scope, purpose and use cases</p>
</li>
<li>
<p>concrete examples of API usage</p>
</li>
<li>
<p>edge cases, error situation details and repair hints</p>
</li>
<li>
<p>architecture context and major dependencies - including figures and
sequence flows</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The User Manual must be posted online, e.g. via GitHub Enterprise pages,
on specific team web servers, or as a Google doc. And don&#8217;t forget to
include a link to this user manual into your OpenAPI definition using
the externalDocs property.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-write-apis-in-u.s.-english"><a class="link" href="#book.must-write-apis-in-u.s.-english">3.4. <span style="color:#bf0000"><strong>MUST</strong></span> Write APIs in U.S. English</a></h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="security"><a class="link" href="#security">4. Security</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="book.must-secure-endpoints-with-oauth-2.0"><a class="link" href="#book.must-secure-endpoints-with-oauth-2.0">4.1. <span style="color:#bf0000"><strong>MUST</strong></span> Secure Endpoints with OAuth 2.0</a></h3>
<div class="paragraph">
<p>Every API endpoint needs to be secured using OAuth 2.0. Please refer to
the
<a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md#security-definitions-object">official
OpenAPI spec</a> on how to specify security definitions in you API
specification or take a look at the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">securityDefinitions:
  oauth2:
    type: oauth2
    flow: password
    tokenUrl: https://token.services.auth.zalando.com/oauth2/access_token
    scopes:
      fulfillment-order-service.read: Access right needed to read from the fulfillment order service.
      fulfillment-order-service.write: Access right needed to write to the fulfillment order service.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example defines OAuth2 with password flow as security standard used
for authentication when accessing endpoints; additionally, there are two
API access rights defined via the scopes section for later endpoint
authorization usage - please see next section.</p>
</div>
<div class="paragraph">
<p>It makes little sense specifying the flow to retrieve OAuth tokens in
the <code>securityDefinitions</code> section, as API endpoints should not care, how
OAuth tokens were created. Unfortunately the <code>flow</code> field is mandatory
and cannot be ommited. API endpoints should always set <code>flow: password</code>
and ignore this information.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-define-and-assign-access-rights-scopes"><a class="link" href="#book.must-define-and-assign-access-rights-scopes">4.2. <span style="color:#bf0000"><strong>MUST</strong></span> Define and Assign Access Rights (Scopes)</a></h3>
<div class="paragraph">
<p>Every API needs to define access rights, called scopes here, and every
endpoint needs to have at least one scope assigned. Scopes are defined
by name and description per API specification, as shown in the previous
section. Please refer to the following rules when creating scope names:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;api-scope&gt; ::= &lt;api-standard-scope&gt; |            -- should be sufficient for majority of use cases
                &lt;api-resource-specific-scope&gt; |   -- for special security access differentiation use cases
                &lt;api-pseudo-scope&gt;                -- used to explicitly indicate that access is not restricted

&lt;api-standard-scope&gt;          ::= &lt;application-id&gt;.&lt;access-type&gt;
&lt;api-resource-specific-scope&gt; ::= &lt;application-id&gt;.&lt;resource-id&gt;.&lt;access-type&gt;
&lt;api-pseudo-scope&gt;            ::= uid

&lt;application-id&gt; ::= &lt;as defined via STUPS&gt;
&lt;access-type&gt;    ::= read | write           -- might be extended in future
&lt;resource-id&gt;    ::= &lt;free identifier following application-id syntax&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>APIs should stick to standard scopes by default&#8201;&#8212;&#8201;for the majority of
use cases, restricting access to specific APIs (with read vs. write
differentiation) is sufficient for controlling access for client types
like merchant or retailer business partners, customers or operational
staff. We want to avoid too many, fine grained scopes increasing
governance complexity without real value add. In some situations, where
the API serves different types of resources for different owners,
resource specific scopes may make sense.</p>
</div>
<div class="paragraph">
<p>Some examples for standard and resource-specific scopes:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Application ID</th>
<th class="tableblock halign-left valign-top">Resource ID</th>
<th class="tableblock halign-left valign-top">Access Type</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fulfillment-order</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>read</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fulfillment-order.read</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fulfillment-order</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>write</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fulfillment-order.write</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sales-order</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sales_order</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>read</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sales-order.sales_order.read</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sales-order</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>shipment_order</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>read</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sales-order.shipment_order.read</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>After scopes names are defined and the scope is declared in the security
definition at the top of an API specification, it should be assigned to
each API operation by specifying a
<a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md#securityRequirementObject"><code>security</code>
requirement</a> like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">paths:
  /sales-orders/{order-number}:
    get:
      summary: Retrieves a sales order
      security:
        - oauth2:
          - sales-order-service.sales_order.read</code></pre>
</div>
</div>
<div class="paragraph">
<p>In very rare cases a whole API or some selected endpoints may not
require specific access control. However, to make this explicit you
should assign the <code>uid</code> pseudo access right scope in this case. It is
the user id and always available as OAuth2 default scope.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">paths:
  /public-information:
    get:
      summary: Provides public information about ...
               Accessible by any user; no access rights needed.
      security:
        - oauth2:
          - uid</code></pre>
</div>
</div>
<div class="paragraph">
<p>Hint: you need not explicitly define the "Authorization" header; it is a
standard header so to say implicitly defined via the security section.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="compatibility"><a class="link" href="#compatibility">5. Compatibility</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="book.must-dont-break-backward-compatibility"><a class="link" href="#book.must-dont-break-backward-compatibility">5.1. <span style="color:#bf0000"><strong>MUST</strong></span> Dont Break Backward Compatibility</a></h3>
<div class="paragraph">
<p>Change APIs, but keep all consumers running. Consumers usually have
independent release lifecycles, focus on stability, and avoid changes
that do not provide additional value. APIs are contracts between service
providers and service consumers that cannot be broken via unilateral
decisions.</p>
</div>
<div class="paragraph">
<p>There are two techniques to change APIs without breaking them:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>follow rules for compatible extensions</p>
</li>
<li>
<p>introduce new API versions and still support older versions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We strongly encourage using compatible API extensions and discourage
versioning. The below guideline rules for service providers and
consumers enable us (having Postels Law in mind) to make compatible
changes without versioning.</p>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> Please note that the compatibility guarantees are for the "on
the wire" format. Binary or source compatibility of code generated from
an API definition is not covered by these rules. If client
implementations update their generation process to a new version of the
API definition, it has to be expected that code changes are necessary.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-prefer-compatible-extensions"><a class="link" href="#book.should-prefer-compatible-extensions">5.2. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Prefer Compatible Extensions</a></h3>
<div class="paragraph">
<p>API designers should apply the following rules to evolve RESTful APIs
for services in a backward-compatible way:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add only optional, never mandatory fields.</p>
</li>
<li>
<p>Never change the semantic of fields (e.g. changing the semantic from
customer-number to customer-id, as both are different unique customer
keys)</p>
</li>
<li>
<p>Input fields may have (complex) constraints being validated via
server-side business logic. Never change the validation logic to be more
restrictive and make sure that all constraints a clearly defined in
description.</p>
</li>
<li>
<p>Enum ranges can be reduced when used as input parameters, only if the
server is ready to accept and handle old range values too. Enum range
can be reduced when used as output parameters.</p>
</li>
<li>
<p>Enum ranges cannot not be extended when used for output parameters 
clients may not be prepared to handle it. However, enum ranges can be
extended when used for input parameters.</p>
</li>
<li>
<p>Use
<a href="#should-used-openended-list-of-values-xextensibleenum-instead-of-enumerations"><code>x-extensible-enum</code></a>,
if range is used for output parameters and likely to be extended with
growing functionality. It defines an open list of explicit values and
clients must be agnostic to new values.</p>
</li>
<li>
<p>Support redirection in case an URL has to change
(<a href="https://en.wikipedia.org/wiki/HTTP_301">301 Moved Permanently</a>).</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="book.must-prepare-clients-to-not-crash-on-compatible-api-extensions"><a class="link" href="#book.must-prepare-clients-to-not-crash-on-compatible-api-extensions">5.3. <span style="color:#bf0000"><strong>MUST</strong></span> Prepare Clients To Not Crash On Compatible API Extensions</a></h3>
<div class="paragraph">
<p>Service clients should apply the robustness principle:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Be conservative with API requests and data passed as input, e.g. avoid
to exploit definition eficits like passing megabytes for strings with
unspecified maximum length.</p>
</li>
<li>
<p>Be tolerant in processing and reading data of API responses, more
specifically&#8230;&#8203;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Service clients must be prepared for compatible API extensions of
service providers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Be tolerant with unknown fields in the payload (see also Fowlers
<a href="http://martinfowler.com/bliki/TolerantReader.html">"TolerantReader"</a>
post), i.e. ignore new fields but do not eliminate them from payload if
needed for subsequent PUT requests.</p>
</li>
<li>
<p>Be prepared that
<a href="#should-used-openended-list-of-values-xextensibleenum-instead-of-enumerations"><code>x-extensible-enum</code></a>
return parameter may deliver new values; either be agnostic or provide
default behavior for unknown values.</p>
</li>
<li>
<p>Be prepared to handle HTTP status codes not explicitly specified in
endpoint definitions. Note also, that status codes are extensible.
Default handling is how you would treat the corresponding x00 code (see
<a href="https://tools.ietf.org/html/rfc7231#section-6">RFC7231 Section 6</a>).</p>
</li>
<li>
<p>Follow the redirect when the server returns HTTP status
<a href="https://en.wikipedia.org/wiki/HTTP_301">301 Moved Permanently</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="book.should-design-apis-conservatively"><a class="link" href="#book.should-design-apis-conservatively">5.4. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Design APIs Conservatively</a></h3>
<div class="paragraph">
<p>Designers of service provider APIs should be conservative and accurate
in what they accept from clients:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Unknown input fields in payload or URL should not be ignored; servers
should provide error feedback to clients via an HTTP 400 response code.</p>
</li>
<li>
<p>Be accurate in defining input data constraints (like formats, ranges,
lengths etc.)  and check constraints and return dedicated error
information in case of violations.</p>
</li>
<li>
<p>Prefer being more specific and restrictive (if compliant to functional
requirements), e.g. by defining length range of strings. It may simplify
implementation while providing freedom for further evolution as
compatible extensions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Not ignoring unknown input fields is a specific deviation from Postel&#8217;s
Law (e.g. see also<br>
<a href="https://cacm.acm.org/magazines/2011/8/114933-the-robustness-principle-reconsidered/fulltext">The
Robustness Principle Reconsidered</a>) and a strong recommendation. Servers
might want to take different approach but should be aware of the
following problems and be explicit in what is supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ignoring unknown input fields is actually not an option for PUT, since
it becomes asymmetric with subsequent GET response and HTTP is clear
about the PUT "replace" semantics and default roundtrip expectations
(see <a href="https://tools.ietf.org/html/rfc7231#section-4.3.4">RFC7231 Section
4.3.4</a>). Note, accepting (i.e. not ignoring) unknown input fields and
returning it in subsequent GET responses is a different situation and
compliant to PUT semantics.</p>
</li>
<li>
<p>Certain client errors cannot be recognized by servers, e.g. attribute
name typing errors will be ignored without server error feedback. The
server cannot differentiate between the client intentionally providing
an additional field versus the client sending a mistakenly named field,
when the client&#8217;s actual intent was to provide an optional input field.</p>
</li>
<li>
<p>Future extensions of the input data structure might be in conflict
with already ignored fields and, hence, will not be compatible, i.e.
break clients that already use this field but with different type.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In specific situations, where a (known) input field is not needed
anymore, it either can stay in the API definition with "not used
anymore" description or can be removed from the API definition as long
as the server ignores this specific parameter.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-always-return-json-objects-as-top-level-data-structures-to-support-extensibility"><a class="link" href="#book.must-always-return-json-objects-as-top-level-data-structures-to-support-extensibility">5.5. <span style="color:#bf0000"><strong>MUST</strong></span> Always Return JSON Objects As Top-Level Data Structures To Support Extensibility</a></h3>
<div class="paragraph">
<p>In a response body, you must always return a JSON objects (and not e.g.
an array) as a top level data structure to support future extensibility.
JSON objects support compatible extension by additional attributes. This
allows you to easily extend your response and e.g. add pagination later,
without breaking backwards compatibility.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-treat-open-api-definitions-as-open-for-extension-by-default"><a class="link" href="#book.must-treat-open-api-definitions-as-open-for-extension-by-default">5.6. <span style="color:#bf0000"><strong>MUST</strong></span> Treat Open API Definitions As Open For Extension By Default</a></h3>
<div class="paragraph">
<p>The Open API 2.0 specification is not very specific on default
extensibility of objects, and redefines JSON-Schema keywords related to
extensibility, like <code>additionalProperties</code>. Following our overall
compatibility guidelines, Open API object definitions are considered
open for extension by default as per
<a href="http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.18">Section
5.18 "additionalProperties"</a> of JSON-Schema.</p>
</div>
<div class="paragraph">
<p>When it comes to Open API 2.0, this means an <code>additionalProperties</code>
declaration is not required to make an object definition extensible:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>API clients consuming data must not assume that objects are closed for
extension in the absence of an <code>additionalProperties</code> declaration and
must ignore fields sent by the server they cannot process. This allows
API servers to evolve their data formats.</p>
</li>
<li>
<p>For API servers receiving unxpected data, the situation is slightly
different. Instead of ignoring fields, servers <em>may</em> reject requests
whose entities contain undefined fields in order to signal to clients
that those fields would not be stored on behalf of the client. API
designers must document clearly how unexpected fields are handled for
PUT, POST and PATCH requests.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>API formats must not declare <code>additionalProperties</code> to be false, as this
prevents objects being extended in the future.</p>
</div>
<div class="paragraph">
<p>Note that this guideline concentrates on default extensibility and does
not exclude the use of <code>additionalProperties</code> with a schema as a value,
which might be appropriate in some circumstances.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-used-open-ended-list-of-values-x-extensible-enum-instead-of-enumerations"><a class="link" href="#book.should-used-open-ended-list-of-values-x-extensible-enum-instead-of-enumerations">5.7. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Used Open-Ended List of Values (x-extensible-enum) Instead of Enumerations</a></h3>
<div class="paragraph">
<p>Enumerations are per definition closed sets of values, that are assumed
to be complete and not intended for extension. This closed principle of
enumerations imposes compatibility issues when an enumeration must be
extended. To avoid these issues, we strongly recommend to use an
open-ended list of values instead of an enumeration unless:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the API has full control of the enumeration values, i.e. the list of
values does not depend on any external tool or interface, and</p>
</li>
<li>
<p>the list of value is complete with respect to any thinkable and
unthinkable future feature.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To specify an open-ended list of values use the marker
<code>x-extensible-enum</code> as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>deliver_methods:
  type: string
  x-extensible-enum:
    - parcel
    - letter
    - email</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> <code>x-extensible-enum</code> is not JSON Schema conform but will be
ignored by most tools.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-avoid-versioning"><a class="link" href="#book.should-avoid-versioning">5.8. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Avoid Versioning</a></h3>
<div class="paragraph">
<p>When changing your RESTful APIs, do so in a compatible way and avoid
generating additional API versions. Multiple versions can significantly
complicate understanding, testing, maintaining, evolving, operating and
releasing our systems
(<a href="http://martinfowler.com/articles/enterpriseREST.html">supplementary
reading</a>).</p>
</div>
<div class="paragraph">
<p>If changing an API cant be done in a compatible way, then proceed in
one of these three ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>create a new resource (variant) in addition to the old resource
variant</p>
</li>
<li>
<p>create a new service endpoint  i.e. a new application with a new API
(with a new domain name)</p>
</li>
<li>
<p>create a new API version supported in parallel with the old API by the
same microservice</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As we discourage versioning by all means because of the manifold
disadvantages, we suggest to only use the first two approaches.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-use-media-type-versioning"><a class="link" href="#book.must-use-media-type-versioning">5.9. <span style="color:#bf0000"><strong>MUST</strong></span> Use Media Type Versioning</a></h3>
<div class="paragraph">
<p>When API versioning is unavoidable, you have to design your
multi-version RESTful APIs using media type versioning (instead of URI
versioning, see below). Media type versioning is less tightly coupled
since it supports content negotiation and hence reduces complexity of
release management.</p>
</div>
<div class="paragraph">
<p>Media type versioning: Here, version information and media type are
provided together via the HTTP Content-Type header  e.g.
application/x.zalando.cart+json;version=2. For incompatible changes, a
new media type version for the resource is created. To generate the new
representation version, consumer and producer can do content negotiation
using the HTTP Content-Type and Accept headers. Note: This versioning
only applies to the request and response content schema, not to URI or
method semantics.</p>
</div>
<div class="paragraph">
<p>In this example, a client wants only the new version of the response:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Accept: application/x.zalando.cart+json;version=2</pre>
</div>
</div>
<div class="paragraph">
<p>A server responding to this, as well as a client sending a request with
content should use the Content-Type header, declaring that one is
sending the new version:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Content-Type: application/x.zalando.cart+json;version=2</pre>
</div>
</div>
<div class="paragraph">
<p>Using header versioning should:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>include versions in request and response headers to increase
visibility</p>
</li>
<li>
<p>include Content-Type in the Vary header to enable proxy caches to
differ between versions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Hint: <a href="https://github.com/OAI/OpenAPI-Specification/issues/146">OpenAPI
currently doesnt support content negotiation</a>, though
<a href="https://github.com/OAI/OpenAPI-Specification/issues/146#issuecomment-117288707">a
comment in this issue</a> mentions a workaround (using a fragment
identifier that gets stripped off). Another way would be to document
just the new version, but let the server accept the old one (with the
previous content-type).</p>
</div>
<div class="paragraph">
<p>Until an incompatible change is necessary, it is recommended to stay
with the standard <code>application/json</code> media type.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-do-not-use-uri-versioning"><a class="link" href="#book.must-do-not-use-uri-versioning">5.10. <span style="color:#bf0000"><strong>MUST</strong></span> Do Not Use URI Versioning</a></h3>
<div class="paragraph">
<p>With URI versioning a (major) version number is included in the path,
e.g. /v1/customers. The consumer has to wait until the provider has been
released and deployed. If the consumer also supports hypermedia links 
even in their APIs  to drive workflows (HATEOAS), this quickly becomes
complex. So does coordinating version upgrades  especially with
hyperlinked service dependencies  when using URL versioning. To avoid
this tighter coupling and complexer release management we do not use URI
versioning, and go instead with media type versioning and content
negotiation (see above).</p>
</div>
<div id="book.should-provide-version-information-in-openapi-documentation" class="paragraph">
<p><span style="color:#bfbf00"><strong>SHOULD</strong></span> Provide Version Information in OpenAPI Documentation</p>
</div>
<div class="paragraph">
<p>Only the documentation, not the API itself, needs version information.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"swagger": "2.0",
"info": {
  "title": "Parcel service API",
  "description": "API for &lt;...&gt;",
  "version": "1.0.0",
    &lt;...&gt;
}</pre>
</div>
</div>
<div class="paragraph">
<p>During a (possibly) long-running API review phase you need different
versions of the API description. These versions may include changes that
are incompatible with earlier draft versions. So we apply the following
version schema MAJOR.MINOR.DRAFT that increments the&#8230;&#8203;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>MAJOR version, when you make incompatible API changes</p>
</li>
<li>
<p>MINOR version, when you add functionality in a backwards-compatible
manner</p>
</li>
<li>
<p>DRAFT version, when you make changes during the review phase that are
not related to production releases</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We recommend using the DRAFT version only for unreleased API definitions
that are still under review; for example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>version 1.4.0  -- current version
version 1.4.1  -- first draft and call for review of API extensions compatible with 1.4.0
version 1.4.2  -- second draft and call for review of API extensions that are still compatible
                   with 1.4.0 but possibly incompatible with 1.4.1
version 1.5.0  -- approved version for implementation and release
version 1.5.1  -- first draft for next review and API change cycle;
                   compatible with 1.4.0 and 1.5.0</pre>
</div>
</div>
<div class="paragraph">
<p>Hint: This versioning scheme differs in the less strict DRAFT aspect
from <a href="http://semver.org">semantic version information</a> used for released
APIs and service applications.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="json-guidelines"><a class="link" href="#json-guidelines">6. JSON Guidelines</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>These guidelines provides recommendations for defining JSON data at
Zalando. JSON here refers to
<a href="http://www.rfc-editor.org/rfc/rfc7159.txt">RFC 7159</a> (which updates
<a href="https://www.ietf.org/rfc/rfc4627.txt">RFC 4627</a>), the application/json
media type and custom JSON media types defined for APIs. The guidelines
clarifies some specific cases to allow Zalando JSON data to have an
idiomatic form across teams and services.</p>
</div>
<div class="sect2">
<h3 id="book.must-use-consistent-property-names"><a class="link" href="#book.must-use-consistent-property-names">6.1. <span style="color:#bf0000"><strong>MUST</strong></span> Use Consistent Property Names</a></h3>

</div>
<div class="sect2">
<h3 id="book.must-property-names-must-be-snake_case-and-never-camelcase."><a class="link" href="#book.must-property-names-must-be-snake_case-and-never-camelcase.">6.2. <span style="color:#bf0000"><strong>MUST</strong></span> Property names must be snake_case (and never camelCase).</a></h3>
<div class="paragraph">
<p>No established industry standard exists, but many popular Internet
companies prefer snake_case: e.g. GitHub, Stack Exchange, Twitter.
Others, like Google and Amazon, use both - but not only camelCase. Its
essential to establish a consistent look and feel such that JSON looks
as if it came from the same hand.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-property-names-must-be-an-ascii-subset"><a class="link" href="#book.must-property-names-must-be-an-ascii-subset">6.3. <span style="color:#bf0000"><strong>MUST</strong></span> Property names must be an ASCII subset</a></h3>
<div class="paragraph">
<p>Property names are restricted to ASCII encoded strings. The first
character must be a letter, an underscore or a dollar sign, and
subsequent characters can be a letter, an underscore, a dollar sign, or
a number.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-array-names-should-be-pluralized"><a class="link" href="#book.should-array-names-should-be-pluralized">6.4. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Array names should be pluralized</a></h3>
<div class="paragraph">
<p>To indicate they contain multiple values prefer to pluralize array
names. This implies that object names should in turn be singular.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-use-consistent-property-values"><a class="link" href="#book.must-use-consistent-property-values">6.5. <span style="color:#bf0000"><strong>MUST</strong></span> Use Consistent Property Values</a></h3>

</div>
<div class="sect2">
<h3 id="book.must-boolean-property-values-must-not-be-null"><a class="link" href="#book.must-boolean-property-values-must-not-be-null">6.6. <span style="color:#bf0000"><strong>MUST</strong></span> Boolean property values must not be null</a></h3>
<div class="paragraph">
<p>Schema based JSON properties that are by design booleans must not be
presented as nulls. A boolean is essentially a closed enumeration of two
values, true and false. If the content has a meaningful null value,
strongly prefer to replace the boolean with enumeration of named values
or statuses - for example accepted_terms_and_conditions with true or
false can be replaced with terms_and_conditions with values yes, no and
unknown.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-null-values-should-have-their-fields-removed"><a class="link" href="#book.should-null-values-should-have-their-fields-removed">6.7. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Null values should have their fields removed</a></h3>
<div class="paragraph">
<p>Swagger/OpenAPI, which is in common use, doesn&#8217;t support null field
values (it does allow omitting that field completely if it is not marked
as required). However that doesn&#8217;t prevent clients and servers sending
and receiving those fields with null values. Also, in some cases null
may be a meaningful value - for example, JSON Merge Patch
<a href="https://tools.ietf.org/html/rfc7386">RFC 7382</a>) using null to indicate
property deletion.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-empty-array-values-should-not-be-null"><a class="link" href="#book.should-empty-array-values-should-not-be-null">6.8. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Empty array values should not be null</a></h3>
<div class="paragraph">
<p>Empty array values can unambiguously be represented as the the empty
list, <code>[]</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-enumerations-should-be-represented-as-strings"><a class="link" href="#book.should-enumerations-should-be-represented-as-strings">6.9. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Enumerations should be represented as Strings</a></h3>
<div class="paragraph">
<p>Strings are a reasonable target for values that are by design
enumerations.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-date-property-values-should-conform-to-rfc-3399"><a class="link" href="#book.should-date-property-values-should-conform-to-rfc-3399">6.10. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Date property values should conform to RFC 3399</a></h3>
<div class="paragraph">
<p>Use the date and time formats defined by
<a href="http://tools.ietf.org/html/rfc3339#section-5.6">RFC 3339</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>for "date" use strings matching
<code>date-fullyear "-" date-month "-" date-mday</code>, for example: <code>2015-05-28</code></p>
</li>
<li>
<p>for "date-time" use strings matching <code>full-date "T" full-time</code>, for
example <code>2015-05-28T14:07:17Z</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that the
<a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md#data-types">OpenAPI
format</a> "date-time" corresponds to "date-time" in the RFC) and
<code>2015-05-28</code> for a date (note that the OpenAPI format "date" corresponds
to "full-date" in the RFC). Both are specific profiles, a subset of the
international standard <a href="http://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a>.</p>
</div>
<div class="paragraph">
<p>A zone offset may be used (both, in request and responses)&#8201;&#8212;&#8201;this is
simply defined by the standards. However, we encourage restricting dates
to UTC and without offsets. For example <code>2015-05-28T14:07:17Z</code> rather
than <code>2015-05-28T14:07:17+00:00</code>. From experience we have learned that
zone offsets are not easy to understand and often not correctly handled.
Note also that zone offsets are different from local times that might be
including daylight saving time. Localization of dates should be done by
the services that provide user interfaces, if required.</p>
</div>
<div class="paragraph">
<p>When it comes to storage, all dates should be consistently stored in UTC
without a zone offset. Localization should be done locally by the
services that provide user interfaces, if required.</p>
</div>
<div class="paragraph">
<p>Sometimes it can seem data is naturally represented using numerical
timestamps, but this can introduce interpretation issues with precision
- for example whether to represent a timestamp as 1460062925,
1460062925000 or 1460062925.000. Date strings, though more verbose and
requiring more effort to parse, avoid this ambiguity.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.may-time-durations-and-intervals-could-conform-to-iso-8601"><a class="link" href="#book.may-time-durations-and-intervals-could-conform-to-iso-8601">6.11. <span style="color:#006000"><strong>MAY</strong></span> Time durations and intervals could conform to ISO 8601</a></h3>
<div class="paragraph">
<p>Schema based JSON properties that are by design durations and intervals
could be strings formatted as recommended by ISO 8601
(<a href="https://tools.ietf.org/html/rfc3339#appendix-A">Appendix A of RFC 3399
contains a grammar</a> for durations).</p>
</div>
</div>
<div class="sect2">
<h3 id="book.may-standards-could-be-used-for-language-country-and-currency"><a class="link" href="#book.may-standards-could-be-used-for-language-country-and-currency">6.12. <span style="color:#006000"><strong>MAY</strong></span> Standards could be used for Language, Country and Currency</a></h3>
<div class="ulist">
<ul>
<li>
<p><a href="http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">ISO 3166-1-alpha2
country</a></p>
</li>
<li>
<p>(It&#8217;s "GB", not "UK", even though "UK" has seen some use at Zalando)</p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes">ISO 639-1
language code</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/bcp47">BCP-47</a> (based on ISO 639-1) for
language variants</p>
</li>
<li>
<p><a href="http://en.wikipedia.org/wiki/ISO_4217">ISO 4217 currency codes</a>
= API Naming</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="book.must-use-lowercase-separate-words-with-hyphens-for-path-segments"><a class="link" href="#book.must-use-lowercase-separate-words-with-hyphens-for-path-segments">6.13. <span style="color:#bf0000"><strong>MUST</strong></span> Use lowercase separate words with hyphens for Path Segments</a></h3>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/shipment-orders/{shipment-order-id}</pre>
</div>
</div>
<div class="paragraph">
<p>This applies to concrete path segments and not the names of path
parameters. For example <code>{shipment_order_id}</code> would be ok as a path
parameter.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-use-snake_case-never-camelcase-for-query-parameters"><a class="link" href="#book.must-use-snake_case-never-camelcase-for-query-parameters">6.14. <span style="color:#bf0000"><strong>MUST</strong></span> Use snake_case (never camelCase) for Query Parameters</a></h3>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>customer_number, order_id, billing_address</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="book.must-use-hyphenated-http-headers"><a class="link" href="#book.must-use-hyphenated-http-headers">6.15. <span style="color:#bf0000"><strong>MUST</strong></span> Use Hyphenated HTTP Headers</a></h3>

</div>
<div class="sect2">
<h3 id="book.should-prefer-hyphenated-pascal-case-for-http-header-fields"><a class="link" href="#book.should-prefer-hyphenated-pascal-case-for-http-header-fields">6.16. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Prefer Hyphenated-Pascal-Case for HTTP header Fields</a></h3>
<div class="paragraph">
<p>This is for consistency in your documentation (most other headers follow
this convention). Avoid camelCase (without hyphens). Exceptions are
common abbreviations like ID.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Accept-Encoding
Apply-To-Redirect-Ref
Disposition-Notification-Options
Original-Message-ID</pre>
</div>
</div>
<div class="paragraph">
<p>See also: <a href="http://tools.ietf.org/html/rfc7230#page-22">HTTP Headers are
case-insensitive (RFC 7230)</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.may-use-standardized-headers"><a class="link" href="#book.may-use-standardized-headers">6.17. <span style="color:#006000"><strong>MAY</strong></span> Use Standardized Headers</a></h3>
<div class="paragraph">
<p>Use <a href="http://en.wikipedia.org/wiki/List_of_HTTP_header_fields">this list</a>
and mention its support in your OpenAPI definition.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-pluralize-resource-names"><a class="link" href="#book.must-pluralize-resource-names">6.18. <span style="color:#bf0000"><strong>MUST</strong></span> Pluralize Resource Names</a></h3>
<div class="paragraph">
<p>Usually, a collection of resource instances is provided (at least API
should be ready here). The special case of a resource singleton is a
collection with cardinality 1.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.may-use-api-as-first-path-segment"><a class="link" href="#book.may-use-api-as-first-path-segment">6.19. <span style="color:#006000"><strong>MAY</strong></span> Use /api as first Path Segment</a></h3>
<div class="paragraph">
<p>In most cases, all resources provided by a service are part of the
public API, and therefore should be made available under the root /
base path. If the service should also support non-public, internal APIs
 for specific operational support functions, for example  add /api
as base path to clearly separate public and non-public API resources.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-avoid-trailing-slashes"><a class="link" href="#book.must-avoid-trailing-slashes">6.20. <span style="color:#bf0000"><strong>MUST</strong></span> Avoid Trailing Slashes</a></h3>
<div class="paragraph">
<p>The trailing slash must not have specific semantics. Resource paths must
deliver the same results whether they have the trailing slash or not.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.may-use-conventional-query-strings"><a class="link" href="#book.may-use-conventional-query-strings">6.21. <span style="color:#006000"><strong>MAY</strong></span> Use Conventional Query Strings</a></h3>
<div class="paragraph">
<p>If you provide query support for sorting, pagination, filtering
functions or other actions, use the following standardized naming
conventions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>q</code>  default query parameter (e.g. used by browser tab completion);
should have an entity specific alias, like sku</p>
</li>
<li>
<p><code>limit</code>  to restrict the number of entries. See Pagination section
below. Hint: You can use size as an alternate query string.</p>
</li>
<li>
<p><code>cursor</code>  key-based page start. See Pagination section below.</p>
</li>
<li>
<p><code>offset</code>  numeric offset page start. See Pagination section below.
Hint: In combination with limit, you can use page as an alternative to
offset.</p>
</li>
<li>
<p><code>sort</code>  comma-separated list of fields to sort. To indicate sorting
direction, fields my prefixed with + (ascending) or - (descending,
default), e.g. /sales-orders?sort=+id</p>
</li>
<li>
<p><code>fields</code>  to retrieve a subset of fields. See
<a href="../performance/Performance.md#should-support-filtering-of-resource-fields"><em>Support
Filtering of Resource Fields</em></a> below.</p>
</li>
<li>
<p><code>embed</code>  to expand embedded entities (ie.: inside of an article
entity, expand silhouette code into the silhouette object). Implementing
expand correctly is difficult, so do it with care. See
<a href="../hyper-media/Hypermedia.md#should-allow-embedding-of-complex-subresources"><em>Embedding
resources</em></a> for more details.</p>
<div id="resources" class="paragraph">
<p>= Resources</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="book.must-avoid-actions-think-about-resources"><a class="link" href="#book.must-avoid-actions-think-about-resources">6.22. <span style="color:#bf0000"><strong>MUST</strong></span> Avoid Actions  Think About Resources</a></h3>
<div class="paragraph">
<p>REST is all about your resources, so consider the domain entities that
take part in web service interaction, and aim to model your API around
these using the standard HTTP methods as operation indicators. For
instance, if an application has to lock articles explicitly so that only
one user may edit them, create an article lock with PUT or POST instead
of using a lock action.</p>
</div>
<div class="paragraph">
<p>Request:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PUT /article-locks/{article-id}</pre>
</div>
</div>
<div class="paragraph">
<p>The added benefit is that you already have a service for browsing and
filtering article locks.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-model-complete-business-processes"><a class="link" href="#book.should-model-complete-business-processes">6.23. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Model complete business processes</a></h3>
<div class="paragraph">
<p>An API should contain the complete business processes containing all
resources representing the process. This enables clients to understand
the business process, foster a consistent design of the business
process, allow for synergies from description and implementation
perspective, and eliminates implicit invisible dependencies between
APIs.</p>
</div>
<div class="paragraph">
<p>In addition, it prevents services from being designed as thin wrappers
around databases, which normally tends to shift business logic to the
clients.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-define-useful-resources"><a class="link" href="#book.should-define-useful-resources">6.24. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Define <em>useful</em> resources</a></h3>
<div class="paragraph">
<p>As a rule of thumb resources should be defined to cover 90% of all its
client&#8217;s use cases. A <em>useful</em> resource should contain as much
information as necessary, but as little as possible. A great way to
support the last 10% is to allow clients to specify their needs for
more/less information by supporting filtering and
<a href="../hyper-media/Hypermedia.md#should-allow-embedding-of-complex-subresources">embedding</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-keep-urls-verb-free"><a class="link" href="#book.must-keep-urls-verb-free">6.25. <span style="color:#bf0000"><strong>MUST</strong></span> Keep URLs Verb-Free</a></h3>
<div class="paragraph">
<p>The API describes resources, so the only place where actions should
appear is in the HTTP methods. In URLs, use only nouns. Instead of
thinking of actions (verbs), it&#8217;s often helpful to think about putting a
message in a letter box: e.g., instead of having the verb <em>cancel</em> in
the url, think of sending a message to cancel an order to the
<em>cancellations</em> letter box on the server side.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-use-domain-specific-resource-names"><a class="link" href="#book.must-use-domain-specific-resource-names">6.26. <span style="color:#bf0000"><strong>MUST</strong></span> Use Domain-Specific Resource Names</a></h3>
<div class="paragraph">
<p>API resources represent elements of the applications domain model.
Using domain-specific nomenclature for resource names helps developers
to understand the functionality and basic semantics of your resources.
It also reduces the need for further documentation outside the API
definition. For example, sales-order-items is superior to
order-items in that it clearly indicates which business object it
represents. Along these lines, items is too general.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-identify-resources-and-sub-resources-via-path-segments"><a class="link" href="#book.must-identify-resources-and-sub-resources-via-path-segments">6.27. <span style="color:#bf0000"><strong>MUST</strong></span> Identify resources and Sub-Resources via Path Segments</a></h3>
<div class="paragraph">
<p>Some API resources may contain or reference sub-resources. Embedded
sub-resources, which are not top-level resources, are parts of a
higher-level resource and cannot be used outside of its scope.
Sub-resources should be referenced by their name and identifier in the
path segments.</p>
</div>
<div class="paragraph">
<p>Composite identifiers must not contain / as a separator. In order to
improve the consumer experience, you should aim for intuitively
understandable URLs, where each sub-path is a valid reference to a
resource or a set of resources. For example, if
/customers/12ev123bv12v/addresses/DE_100100101 is a valid path of your
API, then /customers/12ev123bv12v/addresses, /customers/12ev123bv12v
and /customers must be valid as well in principle.</p>
</div>
<div class="paragraph">
<p>Basic URL structure:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/{resources}/[resource-id]/{sub-resources}/[sub-resource-id]
/{resources}/[partial-id-1][separator][partial-id-2]</pre>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/carts/1681e6b88ec1/items
/carts/1681e6b88ec1/items/1
/customers/12ev123bv12v/addresses/DE_100100101</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="book.should-only-use-uuids-if-necessary"><a class="link" href="#book.should-only-use-uuids-if-necessary">6.28. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Only Use UUIDs If Necessary</a></h3>
<div class="paragraph">
<p>Generating IDs can be a scaling problem in high frequency and near real
time use cases. UUIDs solve this problem, as they can be generated
without collisions in a distributed, non-coordinated way and without
additional server roundtrips.</p>
</div>
<div class="paragraph">
<p>However, they also come with some disadvantages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>pure technical key without meaning; not ready for naming or name scope
conventions that might be helpful for pragmatic reasons, e.g. we learned
to use names for product attributes, instead of UUIDs</p>
</li>
<li>
<p>less usable, because&#8230;&#8203;</p>
</li>
<li>
<p>cannot be memorized and easily communicated by humans</p>
</li>
<li>
<p>harder to use in debugging and logging analysis</p>
</li>
<li>
<p>less convenient for consumer facing usage</p>
</li>
<li>
<p>quite long: readable representation requires 36 characters and comes
with higher memory and bandwidth consumption</p>
</li>
<li>
<p>not ordered along their creation history and no indication of used id
volume</p>
</li>
<li>
<p>may be in conflict with additional backward compatibility support of
legacy ids</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>UUIDs should be avoided were not needed for large scale id generation.
Instead, for instance, server side support with id generation can be
preferred (POST on id resource, followed by idempotent PUT on entity
resource). Usage of UUIDs is especially discouraged as primary keys of
master and configuration data, like brand-ids or attribute-ids which
have low id volume but widespread steering functionality.</p>
</div>
<div class="paragraph">
<p>In any case, we should always use string rather than number type for
identifiers. This gives us more flexibility to evolve the identifier
naming scheme. Accordingly, if used as identifiers, UUIDs should not be
qualified using a format property.</p>
</div>
<div class="paragraph">
<p>Hint: Usually, random UUID is used - see UUID version 4 in
<a href="https://tools.ietf.org/html/rfc4122">RFC 4122</a>. Though UUID version 1
also contains leading timestamps it is not reflected by its
lexicographic sorting. This deficit is addressed by
<a href="https://github.com/alizain/ulid">ULID</a> (Universally Unique
Lexicographically Sortable Identifier). You may favour ULID instead of
UUID, for instance, for pagination use cases ordered along creation
time.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.may-consider-using-non--nested-urls"><a class="link" href="#book.may-consider-using-non--nested-urls">6.29. <span style="color:#006000"><strong>MAY</strong></span> Consider Using (Non-) Nested URLs</a></h3>
<div class="paragraph">
<p>If a sub-resource is only accessible via its parent resource and may not
exists without parent resource, consider using a nested URL structure,
for instance:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/carts/1681e6b88ec1/cart-items/1</pre>
</div>
</div>
<div class="paragraph">
<p>However, if the resource can be accessed directly via its unique id,
then the API should expose it as a top-level resource. For example,
customer is a collection for sales orders; however, sales orders have
globally unique id and some services may choose to access the orders
directly, for instance:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/customers/1681e6b88ec1
/sales-orders/5273gh3k525a</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="book.should-limit-number-of-resources"><a class="link" href="#book.should-limit-number-of-resources">6.30. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Limit number of Resources</a></h3>
<div class="paragraph">
<p>To keep maintenance and service evolution manageable, we should follow
"functional segmentation" and "separation of concern" design principles
and do not mix different business functionalities in same API
definition. In this sense the number of resources exposed via API should
be limited - our experience is that a typical range of resources for a
well-designed API is between 4 and 8. There may be exceptions with more
complex business domains that require more resources, but you should
first check if you can split them into separate subdomains with distinct
APIs.</p>
</div>
<div class="paragraph">
<p>Nevertheless one API should hold all necessary resources to model
complete business processes helping clients to understand these flows.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-limit-number-of-sub-resource-levels"><a class="link" href="#book.should-limit-number-of-sub-resource-levels">6.31. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Limit number of Sub-Resource Levels</a></h3>
<div class="paragraph">
<p>There are main resources (with root url paths) and sub-resources (or
nested resources with non-root urls paths). Use sub-resources if their
life cycle is (loosely) coupled to the main resource, i.e. the main
resource works as collection resource of the subresource entities. You
should use &#8656; 3 sub-resource (nesting) levels&#8201;&#8212;&#8201;more levels increase
API complexity and url path length. (Remember, some popular web browsers
do not support URLs of more than 2000 characters)</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="http"><a class="link" href="#http">7. HTTP</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="book.must-use-http-methods-correctly"><a class="link" href="#book.must-use-http-methods-correctly">7.1. <span style="color:#bf0000"><strong>MUST</strong></span> Use HTTP Methods Correctly</a></h3>
<div class="paragraph">
<p>Be compliant with the standardized HTTP method semantics summarized as
follows:</p>
</div>
<div class="sect3">
<h4 id="_get"><a class="link" href="#_get">7.1.1. GET</a></h4>
<div class="paragraph">
<p>GET requests are used to read a single resource or query set of
resources.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>GET requests for individual resources will usually generate a 404 if
the resource does not exist</p>
</li>
<li>
<p>GET requests for collection resources may return either 200 (if the
listing is empty) or 404 (if the list is missing)</p>
</li>
<li>
<p>GET requests must NOT have request body payload</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note:</strong> GET requests on collection resources should provide a sufficient
filter mechanism as well as
<a href="../pagination/Pagination.md">pagination</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_get_with_body"><a class="link" href="#_get_with_body">7.1.2. GET with Body</a></h4>
<div class="paragraph">
<p>APIs sometimes face the problem, that they have to provide extensive
structured request information with GET, that may even conflicts with
the size limits of clients, load-balancers, and servers. As we require
APIs to be standard conform (body in GET must be ignored on server
side), API designers have to check the following two options:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>GET with URL encoded query parameters: when it is possible to encode
the request information in query parameters, respecting the usual size
limits of clients, gateways, and servers, this should be the first
choice. The request information can either be provided distributed to
multiple query parameters or a single structured URL encoded string.</p>
</li>
<li>
<p>POST with body content: when a GET with URL encoded query parameters
is not possible, a POST with body content must be used. In this case the
endpoint must be documented with the hint <code>GET with    body</code> to
transport the GET semantic of this call.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Note:</strong> It is no option to encode the lengthy structured request
information in header parameters. From a conceptual point of view, the
semantic of an operation should always be expressed by resource name and
query parameters, i.e. what goes into the URL. Request headers are
reserved for general context information, e.g. FlowIDs. In addition,
size limits on query parameters and headers are not reliable and depend
on clients, gateways, server, and actual settings. Thus, switching to
headers does not solve the original problem.</p>
</div>
</div>
<div class="sect3">
<h4 id="_put"><a class="link" href="#_put">7.1.3. PUT</a></h4>
<div class="paragraph">
<p>PUT requests are used to create or update <strong>entire</strong> resources - single or
collection resources. The semantic is best described as <em>please put the
enclosed representation at the resource mentioned by the URL, replacing
any existing resource.</em>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>PUT requests are usually applied to single resources, and not to
collection resources, as this would imply replacing the entire
collection</p>
</li>
<li>
<p>PUT requests are usually robust against non-existence of resources by
implicitly creating before updating</p>
</li>
<li>
<p>on successful PUT requests, the server will <strong>replace the entire
resource</strong> addressed by the URL with the representation passed in the
payload (subsequent reads will deliver the same payload)</p>
</li>
<li>
<p>successful PUT requests will usually generate 200 or 204 (if the
resource was updated - with or without actual content returned), and 201
(if the resource was created)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note:</strong> Resource IDs with respect to PUT requests are maintained by the
client and passed as a URL path segment. Putting the same resource twice
is required to be idempotent and to result in the same single resource
instance. If PUT is applied for creating a resource, only URIs should be
allowed as resource IDs. If URIs are not available POST should be
preferred.</p>
</div>
<div class="paragraph">
<p>To prevent unnoticed concurrent updates when using PUT, the combination
of
<a href="../headers/CommonHeaders.md#could-consider-using-etag-together-with-ifnonematch-header"><code>ETag</code>
and <code>If-(None-)Match</code></a> headers should be considered to signal the server
stricter demands to expose conflicts and prevent lost updates.</p>
</div>
</div>
<div class="sect3">
<h4 id="_post"><a class="link" href="#_post">7.1.4. POST</a></h4>
<div class="paragraph">
<p>POST requests are idiomatically used to create single resources on a
collection resource endpoint, but other semantics on single resources
endpoint are equally possible. The semantic for collection endpoints is
best described as <em>please add the enclosed representation to the
collection resource identified by the URL</em>. The semantic for single
resource endpoints is best described as <em>please execute the given well
specified request on the collection resource identified by the URL</em>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>POST request should only be applied to collection resources, and
normally not on single resource, as this has an undefined semantic</p>
</li>
<li>
<p>on successful POST requests, the server will create one or multiple
new resources and provide their URI/URLs in the response</p>
</li>
<li>
<p>successful POST requests will usually generate 200 (if resources have
been updated), 201 (if resources have been created), and 202 (if the
request was accepted but has not been finished yet)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>More generally:</strong> POST should be used for scenarios that cannot be
covered by the other methods sufficiently. For instance, GET with
complex (e.g. SQL like structured) query that needs to be passed as
request body payload because of the URL-length constraint. In such
cases, make sure to document the fact that POST is used as a workaround.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> Resource IDs with respect to POST requests are created and
maintained by server and returned with response payload. Posting the
same resource twice is by itself <strong>not</strong> required to be idempotent and may
result in multiple resource instances. Anyhow, if external URIs are
present that can be used to identify duplicate requests, it is best
practice to implement POST in an idempotent way.</p>
</div>
</div>
<div class="sect3">
<h4 id="_patch"><a class="link" href="#_patch">7.1.5. PATCH</a></h4>
<div class="paragraph">
<p>PATCH request are only used for partial update of single resources, i.e.
where only a specific subset of resource fields should be replaced. The
semantic is best described as <em>please change the resource identified by
the URL according to my change request</em>. The semantic of the change
request is not defined in the HTTP standard and must be described in the
API specification by using suitable media types.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>PATCH requests are usually applied to single resources, and not on
collection resources, as this would imply patching on the entire
collection</p>
</li>
<li>
<p>PATCH requests are usually not robust against non-existence of
resource instances</p>
</li>
<li>
<p>on successful PATCH requests, the server will update parts of the
resource addressed by the URL as defined by the change request in the
payload</p>
</li>
<li>
<p>successful PATCH requests will usually generate 200 or 204 (if
resources have been updated</p>
</li>
<li>
<p>with or without updated content returned)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note:</strong> since implementing PATCH correctly is a bit tricky, we strongly
suggest to choose one and only one of the following patterns per
endpoint, unless forced by a
<a href="../compatibility/Compatibility#compatibility">backwards compatible
change</a>. In preference order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>use PUT with complete objects to update a resource as long as
feasible (i.e. do not use PATCH at all).</p>
</li>
<li>
<p>use PATCH with partial objects to only update parts of a resource,
when ever possible. (This is basically
<a href="https://tools.ietf.org/html/rfc7396">JSON Merge Patch</a>, a specialized
media type <code>application/merge-patch+json</code> that is a partial resource
representation.)</p>
</li>
<li>
<p>use PATCH with <a href="http://tools.ietf.org/html/rfc6902">JSON Patch</a>, a
specialized media type <code>application/json-patch+json</code> that includes
instructions on how to change the resource.</p>
</li>
<li>
<p>use POST (with a proper description of what is happening) instead of
PATCH if the request does not modify the resource in a way defined by
the semantics of the media type.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In practice <a href="https://tools.ietf.org/html/rfc7396">JSON Merge Patch</a>
quickly turns out to be too limited, especially when trying to update
single objects in large collections (as part of the resource). In this
cases <a href="http://tools.ietf.org/html/rfc6902">JSON Patch</a> can shown its full
power while still showing readable patch requests
(<a href="http://erosb.github.io/post/json-patch-vs-merge-patch">see also</a>).</p>
</div>
<div class="paragraph">
<p>To prevent unnoticed concurrent updates when using PATCH, the
combination of
<a href="../headers/CommonHeaders.md#could-consider-using-etag-together-with-ifnonematch-header"><code>ETag</code>
and <code>If-Match</code></a> headers should be considered to signal the server
stricter demands to expose conflicts and prevent lost updates.</p>
</div>
</div>
<div class="sect3">
<h4 id="_delete"><a class="link" href="#_delete">7.1.6. DELETE</a></h4>
<div class="paragraph">
<p>DELETE request are used to delete resources. The semantic is best
described as <em>please delete the resource identified by the URL</em>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DELETE requests are usually applied to single resources, not on
collection resources, as this would imply deleting the entire collection</p>
</li>
<li>
<p>successful DELETE request will usually generate 200 (if the deleted
resource is returned) or 204 (if no content is returned)</p>
</li>
<li>
<p>failed DELETE request will usually generate 404 (if the resource
cannot be found) or 410 (if the resource was already deleted before)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_head"><a class="link" href="#_head">7.1.7. HEAD</a></h4>
<div class="paragraph">
<p>HEAD requests are used retrieve to header information of single
resources and resource collections.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>HEAD has exactly the same semantics as GET, but returns headers only,
no body.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_options"><a class="link" href="#_options">7.1.8. OPTIONS</a></h4>
<div class="paragraph">
<p>OPTIONS are used to inspect the available operations (HTTP methods) of a
given endpoint.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>OPTIONS requests usually either return a comma separated list of
methods (provided by an <code>Allow:</code>-Header) or as a structured list of link
templates</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note:</strong> OPTIONS is rarely implemented, though it could be used to
self-describe the full functionality of a resource.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="book.must-fulfill-safeness-and-idempotency-properties"><a class="link" href="#book.must-fulfill-safeness-and-idempotency-properties">7.2. <span style="color:#bf0000"><strong>MUST</strong></span> Fulfill Safeness and Idempotency Properties</a></h3>
<div class="paragraph">
<p>An operation can be&#8230;&#8203;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>idempotent, i.e. operation will produce the same results if executed
once or multiple times (note: this does not necessarily mean returning
the same status code)</p>
</li>
<li>
<p>safe, i.e. must not have side effects such as state changes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Method implementations must fulfill the following basic properties:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">HTTP method</th>
<th class="tableblock halign-left valign-top">safe</th>
<th class="tableblock halign-left valign-top">idempotent</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPTIONS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HEAD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELETE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PATCH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Please see also <a href="https://goo.gl/vhwh8a">Best Practices [internal link</a>]
for further hints on how to support the different HTTP methods on
resources.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-use-specific-http-status-codes"><a class="link" href="#book.must-use-specific-http-status-codes">7.3. <span style="color:#bf0000"><strong>MUST</strong></span> Use Specific HTTP Status Codes</a></h3>
<div class="paragraph">
<p>This guideline groups the following rules for HTTP status codes usage:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You must not invent new HTTP status codes; only use standardized HTTP
status codes and consistent with its intended semantics.</p>
</li>
<li>
<p>You should use the most specific HTTP status code for your concrete
resource request processing status or error situation.</p>
</li>
<li>
<p>You should provide good documentation in the API definition when using
HTTP status codes that are less commonly used and not listed below.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are \~60 different HTTP status codes with specific semantics
defined in the HTTP standards (mainly
<a href="https://tools.ietf.org/html/rfc7231#section-6">RFC7231</a> and
<a href="https://tools.ietf.org/html/rfc6585">RFC-6585</a>) - and there are upcoming
new ones, e.g.
<a href="https://tools.ietf.org/html/draft-tbray-http-legally-restricted-status-05">draft
legally-restricted-status</a> (see overview on all error codes on
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">Wikipedia</a> or
via <a href="https://httpstatuses.com/" class="bare">https://httpstatuses.com/</a>). And there are unofficial ones, e.g. used
by specific web servers like Nginx.</p>
</div>
<div class="paragraph">
<p>Our list of most commonly used and best understood HTTP status codes:</p>
</div>
<div class="sect3">
<h4 id="_success_codes"><a class="link" href="#_success_codes">7.3.1. Success Codes</a></h4>
<table class="tableblock frame-all grid-all" style="width: 12%;">
<colgroup>
<col style="width: 34%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Code</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top">Methods</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OK - this is the standard success response</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Created - Returned on successful entity creation. You are free to
return either an empty response or the created resource in conjunction
with the Location header. (More details found in the
<a href="../headers/CommonHeaders.md">Common Headers section</a>.) <em>Always</em> set
the Location header.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST, PUT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">202</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Accepted - The request was successful and will be processed
asynchronously.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST, PUT, DELETE, PATCH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No content - There is no response body</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUT, DELETE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">207</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multi-Status - The response body contains multiple status
informations for different parts of a batch/bulk request. See
<a href="../http/Http.md#must-use-207-for-batch-or-bulk-requests">"Use 207
for Batch or Bulk Requests"</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_redirection_codes"><a class="link" href="#_redirection_codes">7.3.2. Redirection Codes</a></h4>
<table class="tableblock frame-all grid-all" style="width: 12%;">
<colgroup>
<col style="width: 34%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Code</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top">Methods</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">301</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Moved Permanently - This and all future requests should be
directed to the given URI.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">303</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See Other - The response to the request can be found under another
URI using a GET method.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PATCH, POST, PUT, DELETE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">304</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not Modified - resource has not been modified since the date or
version passed via request headers If-Modified-Since or If-None-Match.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_client_side_error_codes"><a class="link" href="#_client_side_error_codes">7.3.3. Client Side Error Codes</a></h4>
<table class="tableblock frame-all grid-all" style="width: 12%;">
<colgroup>
<col style="width: 34%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Code</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top">Methods</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bad request - generic / unknown error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">401</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unauthorized - the users must log in (this often means
Unauthenticated)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">403</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forbidden - the user is not authorized to use this resource</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not found - the resource is not found</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">405</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method Not Allowed - the method is not supported, see OPTIONS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">406</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not Acceptable - resource can only generate content not acceptable
according to the Accept headers sent in the request</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">408</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request timeout - the server times out waiting for the resource</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">409</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Conflict - request cannot be completed due to conflict, e.g. when
two clients try to create the same resource or if there are concurrent,
conflicting updates</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUT, DELETE, PATCH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">410</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gone - resource does not exist any longer, e.g. when accessing a
resource that has intentionally been deleted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">412</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Precondition Failed - returned for conditional requests, e.g.
If-Match if the condition failed. Used for optimistic locking.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUT,
DELETE, PATCH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">415</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unsupported Media Type - e.g. clients sends request body without
content type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUT, DELETE, PATCH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">423</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Locked - Pessimistic locking, e.g. processing states</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUT, DELETE,
PATCH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">428</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Precondition Required - server requires the request to be
conditional (e.g. to make sure that the lost update problem is
avoided).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">429</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Too many requests - the client does not consider rate limiting and
sent too many requests. See
<a href="../http/Http.md#must-use-429-with-headers-for-rate-limits">"Use 429
with Headers for Rate Limits"</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_server_side_error_codes"><a class="link" href="#_server_side_error_codes">7.3.4. Server Side Error Codes:</a></h4>
<table class="tableblock frame-all grid-all" style="width: 12%;">
<colgroup>
<col style="width: 34%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Code</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top">Methods</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">500</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internal Server Error - a generic error indication for an
unexpected server execution problem (here, client retry may be senseful)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">501</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not Implemented - server cannot fulfill the request (usually
implies future availability, e.g. new feature).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">503</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service Unavailable - server is (temporarily) not available (e.g.
due to overload)&#8201;&#8212;&#8201;client retry may be senseful.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="book.must-provide-error-documentation"><a class="link" href="#book.must-provide-error-documentation">7.4. <span style="color:#bf0000"><strong>MUST</strong></span> Provide Error Documentation</a></h3>
<div class="paragraph">
<p>APIs should define the functional, business view and abstract from
implementation aspects. Errors become a key element providing context
and visibility into how to use an API. The error object should be
extended by an application-specific error identifier if and only if the
HTTP status code is not specific enough to convey the domain-specific
error semantic. For this reason, we use a standardized error return
object definition  see
<a href="../common-data-types/CommonDataTypes.html#must-use-common-error-return-objects"><em>Use
Common Error Return Objects</em></a>.</p>
</div>
<div class="paragraph">
<p>The OpenAPI specification shall include definitions for error
descriptions that will be returned; they are part of the interface
definition and provide important information for service clients to
handle exceptional situations and support troubleshooting. You should
also think about a troubleshooting board  it is part of the associated
online API documentation, provides information and handling guidance on
application-specific errors and is referenced via links of the API
definition. This can reduce service support tasks and contribute to
service client and provider performance.</p>
</div>
<div class="paragraph">
<p>Service providers should differentiate between technical and functional
errors. In most cases it&#8217;s not useful to document technical errors that
are not in control of the service provider unless the status code convey
application-specific semantics. The list of status code that can be
omitted from API specifications includes but is not limited to: -
<code>401 Unauthorized</code> - <code>403 Forbidden</code> - <code>404 Not Found</code> unless it has
some additional semantics - <code>405 Method Not Allowed</code> -
<code>406 Not Acceptable</code> - <code>408 Request Timeout</code> - <code>413 Payload Too Large</code> -
<code>414 URI Too Long</code> - <code>415 Unsupported Media Type</code> -
<code>500 Internal Server Error</code> - <code>502 Bad Gateway</code> -
<code>503 Service Unavailable</code> - <code>504 Gateway Timeout</code></p>
</div>
<div class="paragraph">
<p>Even though they might not be documented - they may very much occur in
production, so clients should be prepared for unexpected response codes,
and in case of doubt handle them like they would handle the
corresponding x00 code. Adding new response codes (specially error
responses) should be considered a compatible API evolution.</p>
</div>
<div class="paragraph">
<p>Functional errors on the other hand, that convey domain-specific
semantics, must be documented and are strongly encouraged to be
expressed with
<a href="../common-data-types/CommonDataTypes.html#must-use-common-error-return-objects"><em>Problem
types</em></a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-use-207-for-batch-or-bulk-requests"><a class="link" href="#book.must-use-207-for-batch-or-bulk-requests">7.5. <span style="color:#bf0000"><strong>MUST</strong></span> Use 207 for Batch or Bulk Requests</a></h3>
<div class="paragraph">
<p>Some APIs are required to provide either <em>batch</em> or <em>bulk</em> requests
using POST for performance reasons, i.e. for communication and
processing efficiency. In this case services may be in need to signal
multiple response codes for each part of an batch or bulk request. As
HTTP does not provide proper guidance for handling batch/bulk requests
and responses, we herewith define the following approach:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A batch or bulk request <strong>always</strong> has to respond with HTTP status code
<strong>207</strong>, unless it encounters a generic or unexpected failure before
looking at individual parts.</p>
</li>
<li>
<p>A batch or bulk response with status code 207 <strong>always</strong> returns a
multi-status object containing sufficient status and/or monitoring
information for each part of the batch or bulk request.</p>
</li>
<li>
<p>A batch or bulk request may result in a status code 400/500, only if
the service encounters a failure before looking at individual parts or,
if an unanticipated failure occurs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The before rules apply <em>even in the case</em> that processing of all
individual part <em>fail</em> or each part is executed <em>asynchronously</em>! They
are intended to allow clients to act on batch and bulk responses by
inspecting the individual results in a consistent way.</p>
</div>
<div class="paragraph">
<p><strong>Note</strong>: while a <em>batch</em> defines a collection of requests triggering
independent processes, a <em>bulk</em> defines a collection of independent
resources created or updated together in one request. With respect to
response processing this distinction normally does not matter.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-use-429-with-headers-for-rate-limits"><a class="link" href="#book.must-use-429-with-headers-for-rate-limits">7.6. <span style="color:#bf0000"><strong>MUST</strong></span> Use 429 with Headers for Rate Limits</a></h3>
<div class="paragraph">
<p>APIs that wish to manage the request rate of clients must use the
<a href="http://tools.ietf.org/html/rfc6585">'429 Too Many Requests'</a> response
code if the client exceeded the request rate and therefore the request
can&#8217;t be fulfilled. Such responses must also contain header information
providing further details to the client. There are two approaches a
service can take for header information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Return a
<a href="https://tools.ietf.org/html/rfc7231#section-7.1.3">'Retry-After'</a> header
indicating how long the client ought to wait before making a follow-up
request. The Retry-After header can contain a HTTP date value to retry
after or the number of seconds to delay. Either is acceptable but APIs
should prefer to use a delay in seconds.</p>
</li>
<li>
<p>Return a trio of 'X-RateLimit' headers. These headers (described
below) allow a server to express a service level in the form of a number
of allowing requests within a given window of time and when the window
is reset.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The 'X-RateLimit' headers are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>X-RateLimit-Limit</code>: The maximum number of requests that the client is
allowed to make in this window.</p>
</li>
<li>
<p><code>X-RateLimit-Remaining</code>: The number of requests allowed in the current
window.</p>
</li>
<li>
<p><code>X-RateLimit-Reset</code>: The relative time in seconds when the rate limit
window will be reset.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The reason to allow both approaches is that APIs can have different
needs. Retry-After is often sufficient for general load handling and
request throttling scenarios and notably, does not strictly require the
concept of a calling entity such as a tenant or named account. In turn
this allows resource owners to minimise the amount of state they have to
carry with respect to client requests. The 'X-RateLimit' headers are
suitable for scenarios where clients are associated with pre-existing
account or tenancy structures. 'X-RateLimit' headers are generally
returned on every request and not just on a 429, which implies the
service implementing the API is carrying sufficient state to track the
number of requests made within a given window for each named entity.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-explicitly-define-the-collection-format-of-query-parameters"><a class="link" href="#book.should-explicitly-define-the-collection-format-of-query-parameters">7.7. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Explicitly define the Collection Format of Query Parameters</a></h3>
<div class="paragraph">
<p>There are different ways of supplying a set of values as a query
parameter. One particular type should be selected and stated explicitly
in the API definition. The OpenAPI property
<code>[collectionFormat](<a href="http://swagger.io/specification/" class="bare">http://swagger.io/specification/</a>)</code> is used to
specify the format of the query parameter.</p>
</div>
<div class="paragraph">
<p>Only the <code>csv</code> or <code>multi</code> formats should be used for multi-value query
parameters as described below.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 22%;">
<col style="width: 28%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Collection Format</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>csv</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma separated values</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>?parameter=value1,value2,value3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>multi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiple parameter instances</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>?parameter=value1&amp;parameter=value2&amp;parameter=value3</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>When choosing the collection format, take into account the tool support,
the escaping of special characters and the maximal URL length.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performance"><a class="link" href="#performance">8. Performance</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="book.should-reduce-bandwidth-needs-and-improve-responsiveness"><a class="link" href="#book.should-reduce-bandwidth-needs-and-improve-responsiveness">8.1. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Reduce Bandwidth Needs and Improve Responsiveness</a></h3>
<div class="paragraph">
<p>APIs should support techniques for reducing bandwidth based on client
needs. This holds for APIs that (might) have high payloads and/or are
used in high-traffic scenarios like the public Internet and
telecommunication networks. Typical examples are APIs used by mobile web
app clients with (often) less bandwidth connectivity. (Zalando is a
'Mobile First' company, so be mindful of this point.)</p>
</div>
<div class="paragraph">
<p>Common techniques include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>gzip compression</p>
</li>
<li>
<p>querying field filters to retrieve a subset of resource attributes
(see
<a href="../performance/Performance.md#should-support-filtering-of-resource-fields"><em>Support
Filtering of Resource Fields</em></a> below)</p>
</li>
<li>
<p>paginate lists of data items (see
<a href="../pagination/Pagination.md"><em>Pagination</em></a> below)</p>
</li>
<li>
<p><code>ETag</code> and <code>If-(None-)Match</code> headers to avoid re-fetching of unchanged
resources (see
<a href="../headers/CommonHeaders.md#could-consider-using-etag-together-with-ifnonematch-header"><em>Common
Headers</em></a></p>
</li>
<li>
<p>pagination for incremental access of larger (result) lists</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each of these items is described in greater detail below.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-use-gzip-compression"><a class="link" href="#book.should-use-gzip-compression">8.2. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Use gzip Compression</a></h3>
<div class="paragraph">
<p>Compress the payload of your APIs responses with gzip, unless theres a
good reason not to  for example, you are serving so many requests that
the time to compress becomes a bottleneck. This helps to transport data
faster over the network (fewer bytes) and makes frontends respond
faster.</p>
</div>
<div class="paragraph">
<p>Though gzip compression might be the default choice for server payload,
the server should also support payload without compression and its
client control via Accept-Encoding request header&#8201;&#8212;&#8201;see also
<a href="http://tools.ietf.org/html/rfc7231#section-5.3.4">RFC 7231 Section
5.3.4</a>. The server should indicate used gzip compression via the
Content-Encoding header.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-support-filtering-of-resource-fields"><a class="link" href="#book.should-support-filtering-of-resource-fields">8.3. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Support Filtering of Resource Fields</a></h3>
<div class="paragraph">
<p>Depending on your use case and payload size, you can significantly
reduce network bandwidth need by supporting filtering of returned entity
fields. Here, the client can determine the subset of fields he wants to
receive via the fields query parameter  example see
<a href="https://cloud.google.com/appengine/docs/python/taskqueue/rest/performance#partial-response">Google
AppEngine API&#8217;s partial response</a>:</p>
</div>
<div class="sect3">
<h4 id="_unfiltered"><a class="link" href="#_unfiltered">8.3.1. Unfiltered</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-http" data-lang="http">GET http://api.example.org/resources/123 HTTP/1.1

HTTP/1.1 200 OK
Content-Type: application/json

{
  "id": "cddd5e44-dae0-11e5-8c01-63ed66ab2da5",
  "name": "John Doe",
  "address": "1600 Pennsylvania Avenue Northwest, Washington, DC, United States",
  "birthday": "1984-09-13",
  "partner": {
    "id": "1fb43648-dae1-11e5-aa01-1fbc3abb1cd0",
    "name": "Jane Doe",
    "address": "1600 Pennsylvania Avenue Northwest, Washington, DC, United States",
    "birthday": "1988-04-07"
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_filtered"><a class="link" href="#_filtered">8.3.2. Filtered</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-http" data-lang="http">GET http://api.example.org/resources/123?fields=(name,partner(name)) HTTP/1.1

HTTP/1.1 200 OK
Content-Type: application/json

{
  "name": "John Doe",
  "partner": {
    "name": "Jane Doe"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As illustrated by this example, field filtering should be done via
request parameter "fields" with value range defined by the following
<a href="https://en.wikipedia.org/wiki/Backus%E2%80%93Naur_form">BNF</a> grammar.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;fields&gt; ::= &lt;negation&gt; &lt;fields_expression&gt; | &lt;fields_expression&gt;

&lt;negation&gt; ::= "!"

&lt;fields_expression&gt; ::= "(" &lt;field_set&gt; ")"

&lt;field_set&gt; ::= &lt;qualified_field&gt; | &lt;qualified_field&gt; "," &lt;field_set&gt;

&lt;qualified_field&gt; ::= &lt;field&gt; | &lt;field&gt; &lt;fields_expression&gt;

&lt;field&gt; ::= &lt;DASH_LETTER_DIGIT&gt; | &lt;DASH_LETTER_DIGIT&gt; &lt;field&gt;

&lt;DASH_LETTER_DIGIT&gt; ::= &lt;DASH&gt; | &lt;LETTER&gt; | &lt;DIGIT&gt;

&lt;DASH&gt; ::= "-" | "_"

&lt;LETTER&gt; ::= "A" | "B" | "C" | "D" | "E" | "F" | "G" | "H" | "I" | "J" | "K" | "L" | "M" | "N" | "O" | "P" | "Q" | "R" | "S" | "T" | "U" | "V" | "W" | "X" | "Y" | "Z" | "a" | "b" | "c" | "d" | "e" | "f" | "g" | "h" | "i" | "j" | "k" | "l" | "m" | "n" | "o" | "p" | "q" | "r" | "s" | "t" | "u" | "v" | "w" | "x" | "y" | "z"

&lt;DIGIT&gt; ::= "0" | "1" | "2" | "3" | "4" | "5" | "6" | "7" | "8" | "9"</pre>
</div>
</div>
<div class="paragraph">
<p>A <code>fields_expression</code> as defined by the grammar describes the properties
of an object, i.e. <code>(name)</code> returns only the <code>name</code> property of the root
object. <code>(name,partner(name))</code> returns the <code>name</code> and <code>partner</code>
properties where <code>partner</code> itself is also an object and only its <code>name</code>
property is returned.</p>
</div>
<div class="paragraph">
<p>Hint: OpenAPI doesn&#8217;t allow you to formally specify whether depending on
a given parameter will return different parts of the specified result
schema. Explain this in English in the parameter description.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="book.should-allow-optional-embedding-of-sub-resources"><a class="link" href="#book.should-allow-optional-embedding-of-sub-resources">8.4. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Allow Optional Embedding of Sub-Resources</a></h3>
<div class="paragraph">
<p>Embedding related resources (also know as <em>Resource expansion</em>) is a
great way to reduce the number of requests. In cases where clients know
upfront that they need some related resources they can instruct the
server to prefetch that data eagerly. Whether this is optimized on the
server, e.g. a database join, or done in a generic way, e.g. an HTTP
proxy that transparently embeds resources, is up to the implementation.</p>
</div>
<div class="paragraph">
<p>See
<a href="../naming/Naming.md#could-use-conventional-query-strings"><em>Conventional
Query Parameters</em></a> for naming, e.g. "embed" for steering of embedded
resource expansion. Please use the
<a href="https://en.wikipedia.org/wiki/Backus%E2%80%93Naur_form">BNF</a> grammar, as
already defined above for filtering, when it comes to an embedding query
syntax.</p>
</div>
<div class="paragraph">
<p>Embedding a sub-resource can possibly look like this where an order
resource has its order items as sub-resource (/order/{orderId}/items):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-http" data-lang="http">GET /order/123?embed=(items) HTTP/1.1

{
  "id": "123",
  "_embedded": {
    "items": [
      {
        "position": 1,
        "sku": "1234-ABCD-7890",
        "price": {
          "amount": 71.99,
          "currency": "EUR"
        }
      }
    ]
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="pagination"><a class="link" href="#pagination">9. Pagination</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="book.must-support-pagination"><a class="link" href="#book.must-support-pagination">9.1. <span style="color:#bf0000"><strong>MUST</strong></span> Support Pagination</a></h3>
<div class="paragraph">
<p>Access to lists of data items must support pagination for best client
side batch processing and iteration experience. This holds true for all
lists that are (potentially) larger than just a few hundred entries.</p>
</div>
<div class="paragraph">
<p>There are two page iteration techniques:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://developer.infoconnect.com/paging-results-limit-and-offset">Offset/Limit-based
pagination</a>: numeric offset identifies the first page entry</p>
</li>
<li>
<p><a href="https://dev.twitter.com/overview/api/cursoring">Cursor-based</a>  aka
key-based  pagination: a unique key element identifies the first page
entry (see also
<a href="https://developers.facebook.com/docs/graph-api/using-graph-api/v2.4#paging">Facebooks
guide</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The technical conception of pagination should also consider user
experience related issues. As mentioned in this
<a href="https://www.smashingmagazine.com/2016/03/pagination-infinite-scrolling-load-more-buttons/">article</a>,
jumping to a specific page is far less used than navigation via
next/previous page links. This favours cursor-based over offset-based
pagination.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-prefer-cursor-based-pagination-avoid-offset-based-pagination"><a class="link" href="#book.should-prefer-cursor-based-pagination-avoid-offset-based-pagination">9.2. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Prefer Cursor-Based Pagination, Avoid Offset-Based Pagination</a></h3>
<div class="paragraph">
<p>Cursor-based pagination is usually better and more efficient when
compared to offset-based pagination. Especially when it comes to
high-data volumes and / or storage in NoSQL databases.</p>
</div>
<div class="paragraph">
<p>Before choosing cursor-based pagination, consider the following
trade-offs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Usability/framework support:</p>
<div class="ulist">
<ul>
<li>
<p>Offset / limit based pagination is more known than cursor-based
pagination, so it has more framework support and is easier to use for
API clients</p>
</li>
</ul>
</div>
</li>
<li>
<p>Use case: Jump to a certain page</p>
<div class="ulist">
<ul>
<li>
<p>If jumping to a particular page in a range (e.g., 51 of 100) is
really a required use case, cursor-based navigation is not feasible</p>
</li>
</ul>
</div>
</li>
<li>
<p>Variability of data may lead to anomalies in result pages</p>
<div class="ulist">
<ul>
<li>
<p>Offset-based pagination may create duplicates or lead to missing
entries if rows are inserted or deleted between two subsequent paging
requests.</p>
</li>
<li>
<p>When using cursor-based pagination, paging cannot continue when the
cursor entry has been deleted while fetching two pages</p>
</li>
</ul>
</div>
</li>
<li>
<p>Performance considerations - efficient server-side processing using
offset-based pagination is hardly feasible for:</p>
<div class="ulist">
<ul>
<li>
<p>Higher data list volumes, especially if they do not reside in the
databases main memory</p>
</li>
<li>
<p>Sharded or NoSQL databases</p>
</li>
</ul>
</div>
</li>
<li>
<p>Cursor-based navigation may not work if you need the total count of
results and / or backward iteration support</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Further reading:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://dev.twitter.com/rest/public/timelines">Twitter</a></p>
</li>
<li>
<p><a href="http://use-the-index-luke.com/no-offset">Use the Index, Luke</a></p>
</li>
<li>
<p><a href="https://www.citusdata.com/blog/1872-joe-nelson/409-five-ways-paginate-postgres-basic-exotic">Paging
in PostgreSQL</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="book.may-use-pagination-links-where-applicable"><a class="link" href="#book.may-use-pagination-links-where-applicable">9.3. <span style="color:#006000"><strong>MAY</strong></span> Use Pagination Links Where Applicable</a></h3>
<div class="ulist">
<ul>
<li>
<p>API implementing
<a href="../hyper-media/Hypermedia.html#may-use-rest-maturity-level-3&#8212;&#8203;hateoas">HATEOS</a>
may use
<a href="../hyper-media/Hypermedia.html#should-pagination-and-self-references">simplified
hypertext controls</a> for pagination within collections.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Those collections should then have an <code>items</code> attribute holding the
items of the current page. The collection may contain additional
metadata about the collection or the current page (e.g. <code>index</code>,
<code>page_size</code>) when necessary.</p>
</div>
<div class="paragraph">
<p>You should avoid providing a total count in your API unless there&#8217;s a
clear need to do so. Very often, there are systems and performance
implications to supporting full counts, especially as datasets grow and
requests become complex queries or filters that drive full scans (e.g.,
your database might need to look at all candidate items to count them).
While this is an implementation detail relative to the API, it&#8217;s
important to consider your ability to support serving counts over the
life of a service.</p>
</div>
<div class="paragraph">
<p>If the collection consists of links to other resources, the collection
name should use
<a href="http://www.iana.org/assignments/link-relations/link-relations.xml">IANA
registered link relations</a> as names whenever appropriate, but use plural
form.</p>
</div>
<div class="paragraph">
<p>E.g. a service for articles could represent the collection of hyperlinks
to an article&#8217;s <code>authors</code> like that:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "self": "https://.../articles/xyz/authors/",
  "index": 0,
  "page_size": 5,
  "items": [
    {
      "href": "https://...",
      "id": "123e4567-e89b-12d3-a456-426655440000",
      "name": "Kent Beck"
    },
    {
      "href": "https://...",
      "id": "987e2343-e89b-12d3-a456-426655440000",
      "name": "Mike Beedle"
    },
    ...
  ],
  "first": "https://...",
  "next": "https://...",
  "prev": "https://...",
  "last": "https://..."
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="hypermedia"><a class="link" href="#hypermedia">10. Hypermedia</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="book.must-use-rest-maturity-level-2"><a class="link" href="#book.must-use-rest-maturity-level-2">10.1. <span style="color:#bf0000"><strong>MUST</strong></span> Use REST Maturity Level 2</a></h3>
<div class="paragraph">
<p>We strive for a good implementation of
<a href="http://martinfowler.com/articles/richardsonMaturityModel.html#level2">REST
Maturity Level 2</a> as it enables us to build resource-oriented APIs that
make full use of HTTP verbs and status codes. You can see this expressed
by many rules throughout these guidelines, e.g.: -
<a href="../resources/Resources.md#must-avoid-actions--think-about-resources">Avoid
Actions  Think About Resources</a> -
<a href="../resources/Resources.md#must-keep-urls-verbfree">Keep URLs
Verb-Free</a> - <a href="../http/Http.md#must-use-http-methods-correctly">Use
HTTP Methods Correctly</a> -
<a href="../http/Http.md#must-use-meaningful-http-status-codes">Use
Meaningful HTTP Status Codes</a></p>
</div>
<div class="paragraph">
<p>Although this is not HATEOAS, it should not prevent you from designing
proper link relationships in your APIs as stated in rules below.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.may-use-rest-maturity-level-3---hateoas"><a class="link" href="#book.may-use-rest-maturity-level-3---hateoas">10.2. <span style="color:#006000"><strong>MAY</strong></span> Use REST Maturity Level 3 - HATEOAS</a></h3>
<div class="paragraph">
<p>We do not generally recommend to implement
<a href="http://martinfowler.com/articles/richardsonMaturityModel.html#level3">REST
Maturity Level 3</a>. HATEOAS comes with additional API complexity without
real value in our SOA context where client and server interact via REST
APIs and provide complex business functions as part of our e-commerce
SaaS platform.</p>
</div>
<div class="paragraph">
<p>Our major concerns regarding the promised advantages of HATEOAS (see
also
<a href="https://www.infoq.com/news/2014/03/rest-at-odds-with-web-apis%20for%20detailed%20discussion">RESTistential
Crisis over Hypermedia APIs</a>,
<a href="https://jeffknupp.com/blog/2014/06/03/why-i-hate-hateoas/">Why I Hate
HATEOAS</a> and others): - We follow the
<a href="../general-guidelines/GeneralGuidelines.md#must-follow-api-first-principle">API
First principle</a> with APIs explicitly defined outside the code with
standard specification language. HATEOAS does not really add value for
SOA client engineers in terms of API self-descriptiveness: a client
engineer finds necessary links and usage description (depending on
resource state) in the API reference definition anyway. - Generic
HATEOAS clients which need no prior knowledge about APIs and explore API
capabilities based on hypermedia information provided, is a theoretical
concept that we haven&#8217;t seen working in practise and does not fit to our
SOA set-up. The OpenAPI description format (and tooling based on
OpenAPI) doesn&#8217;t provide sufficient support for HATEOAS either. - In
practice relevant HATEOAS approximations (e.g. following specifications
like HAL or JSON API) support API navigation by abstracting from URL
endpoint and HTTP method aspects via link types. So, Hypermedia does not
prevent clients from required manual changes when domain model changes
over time. - Hypermedia make sense for humans, less for SOA machine
clients. We would expect use cases where it may provide value more
likely in the frontend and human facing service domain. - Hypermedia
does not prevent API clients to implement shortcuts and directly target
resources without 'discovering' them</p>
</div>
<div class="paragraph">
<p>However, we do not forbid HATEOAS; you could use it, if you checked its
limitations and still see clear value for your usage scenario that
justifies its additional complexity. If you use HATEOAS please share
experience and present your findings in the
<a href="https://techwiki.zalando.net/display/GUL/API+Guild">API Guild [internal
link</a>].</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-use-common-hypertext-controls"><a class="link" href="#book.must-use-common-hypertext-controls">10.3. <span style="color:#bf0000"><strong>MUST</strong></span> Use Common Hypertext Controls</a></h3>
<div class="paragraph">
<p>When embedding links to other resources into representations you must
use the common hypertext control object. It contains at least one
attribute:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>href</code>: The URI of the resource the hypertext control is linking to.
All our API are using HTTP(s) as URI scheme.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In API that contain any hypertext controls, the attribute name <code>href</code> is
reserved for usage within hypertext controls.</p>
</div>
<div class="paragraph">
<p>The schema for hypertext controls can be derived from this model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">HttpLink:
  description: A base type of objects representing links to resources.
  type: object
  properties:
    href:
      description: Any URI that is using http or https protocol
      type: string
      format: uri
  required: [ "href" ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The name of an attribute holding such a <code>HttpLink</code> object specifies the
relation between the object that contains the link and the linked
resource. Implementations should use names from the
<a href="http://www.iana.org/assignments/link-relations/link-relations.xhtml">IANA
Link Relation Registry</a> whenever appropriate. As IANA link relation
names use hyphen-case notation, while this guide enforces snake_case
notation for attribute names, hyphens in IANA names have to be replaced
with underscores (e.g. the IANA link relation type <code>version-history</code>
would become the attribute <code>version_history</code>)</p>
</div>
<div class="paragraph">
<p>Specific link objects may extend the basic link type with additional
attributes, to give additional information related to the linked
resource or the relationship between the source resource and the linked
one.</p>
</div>
<div class="paragraph">
<p>E.g. a service providing "Person" resources could model a person who is
married with some other person with a hypertext control that contains
attributes which describe the other person (<code>id</code>, <code>name</code>) but also the
relationship "spouse" between between the two persons (<code>since</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "446f9876-e89b-12d3-a456-426655440000",
  "name": "Peter Mustermann",
  "spouse": {
    "href": "https://...",
    "since": "1996-12-19",
    "id": "123e4567-e89b-12d3-a456-426655440000",
    "name": "Linda Mustermann"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Hypertext controls are allowed anywhere within a JSON model. While this
specification would allow
<a href="http://stateless.co/hal_specification.html">HAL</a>, we actually don&#8217;t
recommend/enforce the usage of HAL anymore as the structural separation
of meta-data and data creates more harm than value to the
understandability and usability of an API.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-use-simple-hypertext-controls-for-pagination-and-self-references"><a class="link" href="#book.should-use-simple-hypertext-controls-for-pagination-and-self-references">10.4. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Use Simple Hypertext Controls for Pagination and Self-References</a></h3>
<div class="paragraph">
<p>Hypertext controls for pagination inside collections and self-references
should use a simple URI value in combination with their corresponding
<a href="http://www.iana.org/assignments/link-relations/link-relations.xml">link
relations</a> (<code>next</code>, <code>prev</code>, <code>first</code>, <code>last</code>, <code>self</code>) instead of the
extensible common hypertext control</p>
</div>
<div class="paragraph">
<p>See <a href="../pagination/Pagination.html">Pagination</a> for information how
to best represent paginateable collections.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-not-use-link-headers-with-json-entities"><a class="link" href="#book.must-not-use-link-headers-with-json-entities">10.5. <span style="color:#bf0000"><strong>MUST</strong></span> Not Use Link Headers with JSON entities</a></h3>
<div class="paragraph">
<p>We don&#8217;t allow the use of the
<a href="http://tools.ietf.org/html/rfc5988#section-5"><code>Link</code> Header defined by
RFC 5988</a> in conjunction with JSON media types. We prefer links directly
embedded in JSON payloads to the uncommon link header syntax.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="data-formats"><a class="link" href="#data-formats">11. Data Formats</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="book.must-use-json-to-encode-structured-data"><a class="link" href="#book.must-use-json-to-encode-structured-data">11.1. <span style="color:#bf0000"><strong>MUST</strong></span> Use JSON to Encode Structured Data</a></h3>
<div class="paragraph">
<p>Use JSON-encoded body payload for transferring structured data. The JSON
payload must follow <a href="https://tools.ietf.org/html/rfc7159">RFC-7159</a> by
having (if possible) a serialized object as the top-level structure,
since it would allow for future extension. This also applies for
collection resources where one naturally would assume an array. See the
<a href="../pagination/Pagination.md#could-use-pagination-links-where-applicable">pagination</a>
section for an example.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.may-use-non-json-media-types-for-binary-data-or-alternative-content-representations"><a class="link" href="#book.may-use-non-json-media-types-for-binary-data-or-alternative-content-representations">11.2. <span style="color:#006000"><strong>MAY</strong></span> Use non JSON Media Types for Binary Data or Alternative Content Representations</a></h3>
<div class="paragraph">
<p>Other media types may be used in following cases: * Transferring binary
data or data whose structure is not relevant. This is the case if
payload structure is not interpreted and consumed by clients as is.
Example of such use case is downloading images in formats JPG, PNG, GIF.
* In addition to JSON version alternative data representations (e.g. in
formats PDF, DOC, XML) may be made available through content
negotiation.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-use-standard-date-and-time-formats"><a class="link" href="#book.must-use-standard-date-and-time-formats">11.3. <span style="color:#bf0000"><strong>MUST</strong></span> Use Standard Date and Time Formats</a></h3>
<div class="sect3">
<h4 id="_json_payload"><a class="link" href="#_json_payload">11.3.1. JSON Payload</a></h4>
<div class="paragraph">
<p>Read more about date and time format in
<a href="../json-guidelines/JsonGuidelines.md#date-property-values-should-conform-to-rfc-3399">Json
Guideline</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_http_headers"><a class="link" href="#_http_headers">11.3.2. HTTP headers</a></h4>
<div class="paragraph">
<p>Http headers including the proprietary headers. Use the
<a href="http://tools.ietf.org/html/rfc7231#section-7.1.1.1">HTTP date format
defined in RFC 7231</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="book.may-use-standards-for-country-language-and-currency-codes"><a class="link" href="#book.may-use-standards-for-country-language-and-currency-codes">11.4. <span style="color:#006000"><strong>MAY</strong></span> Use Standards for Country, Language and Currency Codes</a></h3>
<div class="paragraph">
<p>Use the following standard formats for country, language and currency
codes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">ISO 3166-1-alpha2
country codes</a></p>
<div class="ulist">
<ul>
<li>
<p>(It is GB, not UK, even though UK has seen some use at Zalando)</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes">ISO 639-1
language code</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="https://tools.ietf.org/html/bcp47">BCP-47</a> (based on ISO 639-1) for
language variants</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/ISO_4217">ISO 4217 currency codes</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="book.must-define-format-for-type-number-and-integer"><a class="link" href="#book.must-define-format-for-type-number-and-integer">11.5. <span style="color:#bf0000"><strong>MUST</strong></span> Define Format for Type Number and Integer</a></h3>
<div class="paragraph">
<p>Whenever an API defines a property of type <code>number</code> or <code>integer</code>, the
precision must be defined by the format as follows to prevent clients
from guessing the precision incorrectly, and thereby changing the value
unintentionally:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">format</th>
<th class="tableblock halign-left valign-top">specified value range</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer between -231 and 231-1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer between -263 and 263-1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bigint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">arbitrarily large signed integer number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IEEE 754-2008/ISO 60559:2011 binary64 decimal number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IEEE 754-2008/ISO 60559:2011 binary128 decimal number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">arbitrarily precise signed decimal number</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The precision must be translated by clients and servers into the most
specific language types. E.g. for the following definitions the most
specific language types in Java will translate to <code>BigDecimal</code> for
<code>Money.amount</code> and <code>int</code> or <code>Integer</code> for the <code>OrderList.page_size</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">Money:
  type: object
  properties:
    amount:
      type: number
      description: Amount expressed as a decimal number of major currency units
      format: decimal
      example: 99.95
   ...

OrderList:
  type: object
  properties:
    page_size:
      type: integer
      description: Number of orders in list
      format: int32
      example: 42</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="book.should-prefer-standard-media-type-name-applicationjson"><a class="link" href="#book.should-prefer-standard-media-type-name-applicationjson">11.6. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Prefer standard Media type name <code>application/json</code></a></h3>
<div class="paragraph">
<p>Previously, this guideline allowed the use of custom media types like
<code>application/x.zalando.article+json</code>. This usage is not recommended
anymore and should be avoided, except where it is necessary for cases of
<a href="../compatibility/Compatibility.md#must-use-media-type-versioning">media
type versioning</a>. Instead, the standard media type name
<code>application/json</code> (or
<a href="http://zalando.github.io/restful-api-guidelines/common-data-types/CommonDataTypes.html#must-use-problem-json"><code>application/problem+json</code>
for HTTP error details</a>) should be used for JSON-formatted data.</p>
</div>
<div class="paragraph">
<p>Custom media types with subtypes beginning with <code>x</code> bring no advantage
compared to the standard media type for JSON, and make automated
processing more difficult. They are also
<a href="https://tools.ietf.org/html/rfc6838#section-3.4">discouraged by RFC
6838</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="common-data-types"><a class="link" href="#common-data-types">12. Common Data Types</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Definitions of data objects that are good candidates for wider usage:</p>
</div>
<div class="sect2">
<h3 id="book.should-use-a-common-money-object"><a class="link" href="#book.should-use-a-common-money-object">12.1. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Use a Common Money Object</a></h3>
<div class="paragraph">
<p>Use the following common money structure:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Money:
  type: object
  properties:
    amount:
      type: number
      description: Amount expressed as a decimal number of major currency units
      format: decimal
      example: 99.95
    currency:
      type: string
      description: 3 letter currency code as defined by ISO-4217
      format: iso-4217
      example: EUR
  required:
    - amount
    - currency</pre>
</div>
</div>
<div class="paragraph">
<p>The decimal values for "amount" describe unit and subunit of the
currency in a single value, where the digits before the decimal point
are for the major unit and the digits after the decimal point are for
the minor unit. Note that some business cases (e.g. transactions in
Bitcoin) call for a higher precision, so applications must be prepared
to accept values with unlimited precision, unless explicitly stated
otherwise in the API specification. Examples for correct representations
(in EUR):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>42.20</code> or <code>42.2</code> = 42 Euros, 20 Cent</p>
</li>
<li>
<p><code>0.23</code> = 23 Cent</p>
</li>
<li>
<p><code>42.0</code> or <code>42</code> = 42 Euros</p>
</li>
<li>
<p><code>1024.42</code> = 1024 Euros, 42 Cent</p>
</li>
<li>
<p><code>1024.4225</code> = 1024 Euros, 42.25 Cent</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Make sure that you dont convert the amount field to <code>float</code> /
<code>double</code> types when implementing this interface in a specific language
or when doing calculations. Otherwise, you might lose precision.
Instead, use exact formats like Javas
<a href="https://docs.oracle.com/javase/8/docs/api/java/math/BigDecimal.html"><code>BigDecimal</code></a>.
See <a href="http://stackoverflow.com/a/3730040/342852">Stack Overflow</a> for more
info.</p>
</div>
<div class="paragraph">
<p>Some JSON parsers (NodeJSs, for example) convert numbers to floats by
default. After discussing the
<a href="https://docs.google.com/spreadsheets/d/12wTj-2w39f69XZGwRDrosNc1yWPwQpGgEs_DCt5ODaQ">pros
and cons</a>, weve decided on "decimal" as our amount format. It is not a
standard OpenAPI format, but should help us to avoid parsing numbers as
float / doubles.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-use-common-field-names-and-semantics"><a class="link" href="#book.must-use-common-field-names-and-semantics">12.2. <span style="color:#bf0000"><strong>MUST</strong></span> Use common field names and semantics</a></h3>
<div class="paragraph">
<p>There exist a variety of field types that are required in multiple
places. To achieve consistency across all API implementations, you must
use common field names and semantics whenever applicable.</p>
</div>
<div class="sect3">
<h4 id="_generic_fields"><a class="link" href="#_generic_fields">12.2.1. Generic Fields</a></h4>
<div class="paragraph">
<p>There are some data fields that come up again and again in API data:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>id</code>: the identity of the object. If used, IDs must opaque strings and
not numbers. IDs are unique within some documented context, are stable
and don&#8217;t change for a given object once assigned, and are never
recycled cross entities.</p>
</li>
<li>
<p><code>xyz_id</code>: an attribute within one object holding the identifier of
another object must use a name that corresponds to the type of the
referenced object or the relationship to the referenced object followed
by <code>_id</code> (e.g. <code>customer_id</code> not <code>customer_number</code>; <code>parent_node_id</code> for
the reference to a parent node from a child node, even if both have the
type <code>Node</code>)</p>
</li>
<li>
<p><code>created</code>: when the object was created. If used, this must be a
<code>date-time</code> construct.</p>
</li>
<li>
<p><code>modified</code>: when the object was updated. If used, this must be a
<code>date-time</code> construct.</p>
</li>
<li>
<p><code>type</code>: the kind of thing this object is. If used, the type of this
field should be a string. Types allow runtime information on the entity
provided that otherwise requires examining the Open API file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example JSON schema:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>tree_node:
  type: object
  properties:
    id:
      description: the identifier of this node
      type: string
    created:
      description: when got this node created
      type: string
      format: 'date-time'
    modified:
      description: when got this node last updated
      type: string
      format: 'date-time'
    type:
      type: string
      enum: [ 'LEAF', 'NODE' ]
    parent_node_id:
      description: the identifier of the parent node of this node
      type: string
  example:
    id: '123435'
    created: '2017-04-12T23:20:50.52Z'
    modified: '2017-04-12T23:20:50.52Z'
    type: 'LEAF'
    parent_node_id: '534321'</pre>
</div>
</div>
<div class="paragraph">
<p>These properties are not always strictly necessary, but making them
idiomatic allows API client developers to build up a common
understanding of Zalando&#8217;s resources. There is very little utility for
API consumers in having different names or value types for these fields
across APIs.</p>
</div>
</div>
<div class="sect3">
<h4 id="_address_fields"><a class="link" href="#_address_fields">12.2.2. Address Fields</a></h4>
<div class="paragraph">
<p>Address structures play a role in different functional and use-case
contexts, including country variances. All attributes that relate to
address information should follow the naming and semantics defined
below.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>addressee:
    description:
      a (natural or legal) person that gets addressed
    type: object
    required:
      - first_name
      - last_name
      - street
      - city
      - zip
      - country_code
    properties:
      salutation:
        description: |
          a salutation and/or title used for personal contacts to some addressee;
          not to be confused with the gender information!
        type: string
        example: Mr
      first_name:
        description: |
          given name(s) or first name(s) of a person; may also include the middle names.
        type: string
        example: Hans Dieter
      last_name:
        description: |
          family name(s) or surname(s) of a person
        type: string
        example: Mustermann
      business_name:
        description: |
          company name of the business organization. Used when a business is the actual
          addressee; for personal shipments to office addresses, use `care_of` instead.
        type: string
        example: Consulting Services GmbH
    required:
      - first_name
      - last_name

address:
    description:
      an address of a location/destination
    type: object
    properties:
      care_of:
        description: |
          (aka c/o) the person that resides at the address, if different from
          addressee. E.g. used when sending a personal parcel to the
          office /someone else's home where the addressee resides temporarily
        type: string
        example: Consulting Services GmbH
      street:
        description: |
          the full street address including house number and street name
        type: string
        example: Schnhauser Allee 103
      additional:
        description: |
          further details like building name, suite, apartment number, etc.
        type: string
        example: 2. Hinterhof rechts
      city:
        description: |
          name of the city / locality
        type: string
        example: Berlin
      zip:
        description: |
          zip code or postal code
        type: string
        example: 14265
      country_code:
        description: |
          the country code according to
          [iso-3166-1-alpha-2](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2)
        type: string
        example: DE
    required:
      - street
      - city
      - zip
      - country_code</pre>
</div>
</div>
<div class="paragraph">
<p>Grouping and cardinality of fields in specific data types may vary based
on the specific use case (e.g. combining addressee and address fields
into a single type when modeling an address label vs distinct addressee
and address types when modeling users and their addresses).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="book.must-follow-hypertext-control-conventions"><a class="link" href="#book.must-follow-hypertext-control-conventions">12.3. <span style="color:#bf0000"><strong>MUST</strong></span> Follow Hypertext Control Conventions</a></h3>
<div class="paragraph">
<p>APIs that provide hypertext controls (links) to interconnect API
resources must follow the conventions for naming and modeling of
hypertext controls as defined in section
<a href="../hyper-media/Hypermedia.html">Hypermedia</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-use-problem-json"><a class="link" href="#book.must-use-problem-json">12.4. <span style="color:#bf0000"><strong>MUST</strong></span> Use Problem JSON</a></h3>
<div class="paragraph">
<p><a href="http://tools.ietf.org/html/rfc7807">RFC 7807</a> defines the media type
<code>application/problem+json</code>. Operations should return that (together with
a suitable status code) when any problem occurred during processing and
you can give more details than the status code itself can supply,
whether it be caused by the client or the server (i.e. both for 4xx or
5xx errors).</p>
</div>
<div class="paragraph">
<p>A previous version of this guideline (before the publication of that RFC
and the registration of the media type) told to return
<code>application/x.problem+json</code> in these cases (with the same contents).
Servers for APIs defined before this change should pay attention to the
<code>Accept</code> header sent by the client and set the <code>Content-Type</code> header of
the problem response correspondingly. Clients of such APIs should accept
both media types.</p>
</div>
<div class="paragraph">
<p>APIs may define custom problems types with extension properties,
according to their specific needs.</p>
</div>
<div class="paragraph">
<p>The Open API schema definition can be found
<a href="https://zalando.github.io/problem/schema.yaml">on github</a>. You can
reference it by using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">responses:
  503:
    description: Service Unavailable
    schema:
      $ref: 'https://zalando.github.io/problem/schema.yaml#/Problem'</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="book.must-do-not-expose-stack-traces"><a class="link" href="#book.must-do-not-expose-stack-traces">12.5. <span style="color:#bf0000"><strong>MUST</strong></span> Do not expose Stack Traces</a></h3>
<div class="paragraph">
<p>Stack traces contain implementation details that are not part of an API,
and on which clients should never rely. Moreover, stack traces can leak
sensitive information that partners and third parties are not allowed to
receive and may disclose insights about vulnerabilities to attackers.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="common-headers"><a class="link" href="#common-headers">13. Common Headers</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes a handful of headers, which we found raised the
most questions in our daily usage, or which are useful in particular
circumstances but not widely known.</p>
</div>
<div class="sect2">
<h3 id="book.must-use-content-headers-correctly"><a class="link" href="#book.must-use-content-headers-correctly">13.1. <span style="color:#bf0000"><strong>MUST</strong></span> Use Content Headers Correctly</a></h3>
<div class="paragraph">
<p>Content or entity headers are headers with a <code>Content-</code> prefix. They
describe the content of the body of the message and they can be used in
both, HTTP requests and responses. Commonly used content headers include
but are not limited to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://tools.ietf.org/html/rfc6266"><code>Content-Disposition</code></a> can
indicate that the representation is supposed to be saved as a file, and
the proposed file name.</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc7231#section-3.1.2.2"><code>Content-Encoding</code></a>
indicates compression or encryption algorithms applied to the content.</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc7230#section-3.3.2"><code>Content-Length</code></a>
indicates the length of the content (in bytes).</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc7231#section-3.1.3.2"><code>Content-Language</code></a>
indicates that the body is meant for people literate in some human
language(s).</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc7231#section-3.1.4.2"><code>Content-Location</code></a>
indicates where the body can be found otherwise
(<a href="../headers/CommonHeaders.md#could-use-contentlocation-header">see
below for more details</a>).</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc7233#section-4.2"><code>Content-Range</code></a> is
used in responses to range requests to indicate which part of the
requested resource representation is delivered with the body.</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc7231#section-3.1.1.5"><code>Content-Type</code></a>
indicates the media type of the body content.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="book.may-use-content-location-header"><a class="link" href="#book.may-use-content-location-header">13.2. <span style="color:#006000"><strong>MAY</strong></span> Use Content-Location Header</a></h3>
<div class="paragraph">
<p>The Content-Location header is <em>optional</em> and can be used in successful
write operations (PUT, POST or PATCH) or read operations (GET, HEAD) to
guide caching and signal a receiver the actual location of the resource
transmitted in the response body. This allows clients to identify the
resource and to update their local copy when receiving a response with
this header.</p>
</div>
<div class="paragraph">
<p>The Content-Location header can be used to support the following use
cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For reading operations GET and HEAD, a different location than the
requested URI can be used to indicate that the returned resource is
subject to content negotiations, and that the value provides a more
specific identifier of the resource.</p>
</li>
<li>
<p>For writing operations PUT and PATCH, an identical location to the
requested URI, can be used to explicitly indicate that the returned
resource is the current representation of the newly created or updated
resource.</p>
</li>
<li>
<p>For writing operations POST and DELETE, a content location can be used
to indicate that the body contains a status report resource in response
to the requested action, which is available at provided location.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note</strong>: When using the Content-Location header, the Content-Type header
has to be set as well. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-http" data-lang="http">GET /products/123/images HTTP/1.1

HTTP/1.1 200 OK
Content-Type: image/png
Content-Location: /products/123/images?format=raw</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="book.should-use-location-header-instead-of-content-location-header"><a class="link" href="#book.should-use-location-header-instead-of-content-location-header">13.3. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Use Location Header instead of Content-Location Header</a></h3>
<div class="paragraph">
<p>As the correct usage of Content-Location with respect to semantics and
caching is difficult, we <em>discourage</em> the use of Content-Location. In
most cases it is sufficient to direct clients to the resource location
by using the Location header instead without hitting the
Content-Location specific ambiguities and complexities.</p>
</div>
<div class="paragraph">
<p>More details in RFC 7231
<a href="https://tools.ietf.org/html/rfc7231#section-7.1.2">7.1.2 Location</a>,
<a href="https://tools.ietf.org/html/rfc7231#section-3.1.4.2">3.1.4.2
Content-Location</a></p>
</div>
</div>
<div class="sect2">
<h3 id="book.may-use-the-prefer-header-to-indicate-processing-preferences"><a class="link" href="#book.may-use-the-prefer-header-to-indicate-processing-preferences">13.4. <span style="color:#006000"><strong>MAY</strong></span> Use the Prefer header to indicate processing preferences</a></h3>
<div class="paragraph">
<p>The <code>Prefer</code> header defined in
<a href="https://tools.ietf.org/html/rfc7240">RFC7240</a> allows clients to request
processing behaviors from servers.
<a href="https://tools.ietf.org/html/rfc7240">RFC7240</a> pre-defines a number of
preferences and is extensible, to allow others to be defined. Support
for the Prefer header is entirely optional and at the discretion of API
designers, but as an existing Internet Standard, is recommended over
defining proprietary "X-" headers for processing directives.</p>
</div>
<div class="paragraph">
<p>The <code>Prefer</code> header can defined like this in an API definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">  Prefer:
    name: Prefer
    description: |
      The RFC7240 Prefer header indicates that particular server
      behaviors are preferred by the client but are not required
      for successful completion of the request.

      # (indicate the preferences supported by the API)

    in: header
    type: string
    required: false</code></pre>
</div>
</div>
<div class="paragraph">
<p>Supporting APIs may return the <code>Preference-Applied</code> header also defined
in <a href="https://tools.ietf.org/html/rfc7240">RFC7240</a> to indicate whether the
preference was applied.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.may-consider-using-etag-together-with-if-none-match-header"><a class="link" href="#book.may-consider-using-etag-together-with-if-none-match-header">13.5. <span style="color:#006000"><strong>MAY</strong></span> Consider using ETag together with If-(None-)Match header</a></h3>
<div class="paragraph">
<p>When creating or updating resources it may be necessary to expose
conflicts and to prevent the lost update problem. This can be best
accomplished by using the
<a href="https://tools.ietf.org/html/rfc7232#section-2.3"><code>ETag</code></a> header together
with the <a href="https://tools.ietf.org/html/rfc7232#section-3.1"><code>If-Match</code></a> and
<a href="https://tools.ietf.org/html/rfc7232#section-3.2"><code>If-None-Match</code></a>. The
contents of an <code>ETag: &lt;entity-tag&gt;</code> header is either (a) a hash of the
response body, (b) a hash of the last modified field of the entity, or
(c) a version number or identifier of the entity version.</p>
</div>
<div class="paragraph">
<p>To expose conflicts between concurrent update operations via PUT, POST,
or PATCH, the <code>If-Match: &lt;entity-tag&gt;</code> header can be used to force the
server to check whether the version of the updated entity is conforming
to the requested <code>&lt;entity-tag&gt;</code>. If no matching entity is found, the
operation is supposed a to respond with status code 412 - precondition
failed.</p>
</div>
<div class="paragraph">
<p>Beside other use cases, the <code>If-None-Match:</code> header with parameter <code>*</code>
can be used in a similar way to expose conflicts in resource creation.
If any matching entity is found, the operation is supposed a to respond
with status code 412 - precondition failed.</p>
</div>
<div class="paragraph">
<p>The <code>ETag</code>, <code>If-Match</code>, and <code>If-None-Match</code> headers can be defined as
follows in the API definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">  Etag:
    name: Etag
    description: |
      The RFC7232 ETag header field in a response provides the current entity-tag for the
      selected resource. An entity-tag is an opaque identifier for different versions of
      a resource over time, regardless whether multiple versions are valid at the same time.
      An entity-tag consists of an opaque quoted string, possibly prefixed by a weakness
      indicator.

    in: header
    type: string
    required: false
    example: W/"xy", "5", "7da7a728-f910-11e6-942a-68f728c1ba70"

  IfMatch:
    name: If-Match
    description: |
      The RFC7232 If-Match header field in a request requires the server to only operate
      on the resource that matches at least one of the provided entity-tags. This allows
      clients express a precondition that prevent the method from being applied, if there
      have been any changes to the resource.

    in: header
    type: string
    required: false
    example:  "5", "7da7a728-f910-11e6-942a-68f728c1ba70"

  IfNoneMatch:
    name: If-None-Match
    description: |
      The RFC7232 If-None-Match header field in a request requires the server to only
      operate on the resource if it does not match any of the provided entity-tags. If
      the provided entity-tag is `*`, it is required that the resource does not exist
      at all.

    in: header
    type: string
    required: false
    example: "7da7a728-f910-11e6-942a-68f728c1ba70", *</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="proprietary-headers"><a class="link" href="#proprietary-headers">14. Proprietary Headers</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section shares definitions of proprietary headers that should be
named consistently because they address overarching service-related
concerns. Whether services support these concerns or not is optional;
therefore, the OpenAPI API specification is the right place to make this
explicitly visible. Use the parameter definitions of the resource HTTP
methods.</p>
</div>
<div class="sect2">
<h3 id="book.must-use-only-the-specified-proprietary-zalando-headers"><a class="link" href="#book.must-use-only-the-specified-proprietary-zalando-headers">14.1. <span style="color:#bf0000"><strong>MUST</strong></span> Use Only the Specified Proprietary Zalando Headers</a></h3>
<div class="paragraph">
<p>As a general rule, proprietary HTTP headers should be avoided. Still
they can be useful in cases where context needs to be passed through
multiple services in an end-to-end fashion. As such, a valid use-case
for a proprietary header is providing context information, which is not
a part of the actual API, but is needed by subsequent communication.</p>
</div>
<div class="paragraph">
<p>From a conceptual point of view, the semantics and intent of an
operation should always be expressed by URLs path and query parameters,
the method, and the content. Headers are more often used to implement
functions close to the protocol considerations, such as flow control,
content negotiation, and authentication. Thus, headers are reserved for
general context information
(<a href="https://tools.ietf.org/html/rfc7231#section-5">RFC-7231</a>).</p>
</div>
<div class="paragraph">
<p><code>X-</code> headers were initially reserved for unstandardized parameters, but
the usage of <code>X-</code> headers is deprecated
(<a href="https://tools.ietf.org/html/rfc6648">RFC-6648</a>). This complicates the
contract definition between consumer and producer of an API following
these guidelines, since there is no aligned way of using those headers.
Because of this, the guidelines restrict which <code>X-</code> headers can be used
and how they are used.</p>
</div>
<div class="paragraph">
<p>The Internet Engineering Task Force&#8217;s states in
<a href="https://tools.ietf.org/html/rfc6648">RFC-6648</a> that company specific
header' names should incorporate the organization&#8217;s name. We aim for
backward compatibility, and therefore keep the <code>X-</code> prefix.</p>
</div>
<div class="paragraph">
<p>The following proprietary headers have been specified by this guideline
for usage so far. Remember that HTTP header field names are not
case-sensitive.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 21%;">
<col style="width: 9%;">
<col style="width: 39%;">
<col style="width: 31%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header field name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Header field value example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">X-Flow-ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The flow id of the request, which is written into
the logs and passed to called services. Helpful for operational
troubleshooting and log analysis. It supports traceability of requests
and identifying request flows through system of many services. It should
be a string consisting of just printable ASCII characters (i.e. without
whitespace). Verify in a received request that it fits to a specific
format, has a sensible maximum length and possibly throw out or escape
characters/bytes which could crash your log parsing (line breaks, tabs,
spaces, NULL). If a legacy subsystem can only work with flow IDs of a
specific format, it needs to define this in its API, or make its own
ones.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GKY7oDhpSiKY_gAAAABZ_A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">X-UID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generic user id of OpenId account that owns the passed
(OAuth2) access token. E.g. additionally provided by OpenIG proxy after
access token validation&#8201;&#8212;&#8201;may save additional token validation round
trips.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">w435-dker-jdh357</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">X-Tenant-ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The tenant id for future platform multitenancy
support. <em>Should not be used unless new platform multitenancy is truly
supported. But should be used by New Platform Prototyping services.</em>
Must be validated for external retailer, supplier, etc. tenant users via
OAuth2; details in clarification. Currently only used by New Platform
Prototyping services.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9f8b3ca3-4be5-436c-a847-9cd55460c495</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">X-Sales-Channel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sales channels are owned by retailers and
represent a specific consumer segment being addressed with a specific
product assortment that is offered via CFA retailer catalogs to
consumers (see
<a href="https://pages.github.bus.zalan.do/core-platform/docs/glossary/glossary.html">platform
glossary [internal link</a>])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">X-Frontend-Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Consumer facing applications (CFAs) provide
business experience to their customers via different frontend
application types, for instance, mobile app or browser. Info should be
passed-through as generic aspect&#8201;&#8212;&#8201;there are diverse concerns, e.g.
pushing mobiles with specific coupons, that make use of it. Current
range is mobile-app, browser, facebook-app, chat-app</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mobile-app</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">X-Device-Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">There are also use cases for steering customer
experience (incl. features and content) depending on device type. Via
this header info should be passed-through as generic aspect. Current
range is smartphone, tablet, desktop, other</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tablet</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">X-Device-OS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">On top of device type above, we even want to
differ between device platform, e.g. smartphone Android vs. iOS. Via
this header info should be passed-through as generic aspect. Current
range is iOS, Android, Windows, Linux, MacOS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Android</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">X-App-Domain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The app domain (i.e. shop channel context) of
the request. Note, app-domain is a legacy concept that will be replaced
in new platform by combinations of main CFA concerns like retailer,
sales channel, country</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Exception:</strong> The only exception to this guideline are the conventional
hop-by-hop <code>X-RateLimit-</code> headers which can be used as defined in
<a href="../http/Http.md#must-use-429-with-headers-for-rate-limits">HTTP/Must-Use-429-with-Headers-For-Rate-Limits</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-propagate-proprietary-headers"><a class="link" href="#book.must-propagate-proprietary-headers">14.2. <span style="color:#bf0000"><strong>MUST</strong></span> Propagate Proprietary Headers</a></h3>
<div class="paragraph">
<p>All Zalando&#8217;s proprietary headers are end-to-end headers.</p>
</div>
<div class="paragraph">
<p>All headers specified above must be propagated to the services down the
call chain. The header names and values must remain unchanged.</p>
</div>
<div class="paragraph">
<p>For example, the values of the custom headers like <code>X-Device-Type</code> can
affect the results of queries by using device type information to
influence recommendation results. Besides, the values of the custom
headers can influence the results of the queries (e.g. the device type
information influences the recommendation results).</p>
</div>
<div class="paragraph">
<p>Sometimes the value of a proprietary header will be used as part of the
entity in a subsequent request. In such cases, the proprietary headers
must still be propagated as headers with the subsequent request, despite
the duplication of information.</p>
</div>
<div class="paragraph">
<p><em>Footnote:</em></p>
</div>
<div class="paragraph">
<p>HTTP/1.1 standard
(<a href="https://tools.ietf.org/html/rfc7230#section-6.1">RFC-7230</a>) defines two
types of headers: end-to-end and hop-by-hop headers. End-to-end headers
must be transmitted to the ultimate recipient of a request or response.
Hop-by-hop headers, on the contrary, are meaningful for a single
connection only.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deprecation"><a class="link" href="#deprecation">15. Deprecation</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes it is necessary to phase out an API endpoint (or version).
I.e. this may be necessary if a field is no longer supported in the
result or a whole business functionality behind an endpoint has to be
shut down. There are many other reasons as well.</p>
</div>
<div class="sect2">
<h3 id="book.must-obtain-approval-of-clients"><a class="link" href="#book.must-obtain-approval-of-clients">15.1. <span style="color:#bf0000"><strong>MUST</strong></span> Obtain Approval of Clients</a></h3>
<div class="paragraph">
<p>Before shutting down an API (or version of an API) the producer must
make sure, that all clients have given their consent to shut down the
endpoint. Producers should help consumers to migrate to a potential new
endpoint (i.e. by providing a migration manual). After all clients are
migrated, the producer may shut down the deprecated API.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-external-partners-must-agree-on-deprecation-timespan"><a class="link" href="#book.must-external-partners-must-agree-on-deprecation-timespan">15.2. <span style="color:#bf0000"><strong>MUST</strong></span> External Partners Must Agree on Deprecation Timespan</a></h3>
<div class="paragraph">
<p>If the API is consumed by any external partner, the producer must define
a reasonable timespan that the API will be maintained after the producer
has announced deprecation. The external partner (client) must agree to
this minimum after-deprecation-lifespan before he starts using the API.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-reflect-deprecation-in-api-definition"><a class="link" href="#book.must-reflect-deprecation-in-api-definition">15.3. <span style="color:#bf0000"><strong>MUST</strong></span> Reflect Deprecation in API Definition</a></h3>
<div class="paragraph">
<p>API deprecation must be part of the OpenAPI definition. If a method on a
path, a whole path or even a whole API endpoint (multiple paths) should
be deprecated, the producers must set <code>deprecated=true</code> on each method /
path element that will be deprecated (OpenAPI 2.0 only allows you to
define deprecation on this level). If deprecation should happen on a
more fine grained level (i.e. query parameter, payload etc.), the
producer should set <code>deprecated=true</code> on the affected method / path
element and add further explanation to the <code>description</code> section.</p>
</div>
<div class="paragraph">
<p>If <code>deprecated</code> is set to <code>true</code>, the producer must describe what
clients should use instead and when the API will be shut down in the
<code>description</code> section of the API definition.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-monitor-usage-of-deprecated-apis"><a class="link" href="#book.must-monitor-usage-of-deprecated-apis">15.4. <span style="color:#bf0000"><strong>MUST</strong></span> Monitor Usage of Deprecated APIs</a></h3>
<div class="paragraph">
<p>Owners of APIs used in production must monitor usage of deprecated APIs
until the API can be shut down in order to align deprecation and avoid
uncontrolled breaking effects. See also the
<a href="../api-operation/ApiOperation.md">general rule on API usage
monitoring</a></p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-add-a-warning-header-to-responses"><a class="link" href="#book.should-add-a-warning-header-to-responses">15.5. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Add a Warning Header to Responses</a></h3>
<div class="paragraph">
<p>During deprecation phase, the producer should add a <code>Warning</code> header
(see <a href="https://tools.ietf.org/html/rfc7234#section-5.5">RFC 7234 - Warning
header</a>) field. When adding the <code>Warning</code> header, the <code>warn-code</code> must
be <code>299</code> and the <code>warn-text</code> should be in form of <em>"The
path/operation/parameter/&#8230;&#8203; {name} is deprecated and will be removed
by {date}. Please see {link} for details."</em> with a link to a
documentation describing why the API is no longer supported in the
current form and what clients should do about it. Adding the <code>Warning</code>
header is not sufficient to gain client consent to shut down an API.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-add-monitoring-for-warning-header"><a class="link" href="#book.should-add-monitoring-for-warning-header">15.6. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Add Monitoring for Warning Header</a></h3>
<div class="paragraph">
<p>Clients should monitor the <code>Warning</code> header in HTTP responses to see if
an API will be deprecated in future.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-not-start-using-deprecated-apis"><a class="link" href="#book.must-not-start-using-deprecated-apis">15.7. <span style="color:#bf0000"><strong>MUST</strong></span> Not Start Using Deprecated APIs</a></h3>
<div class="paragraph">
<p>Clients must not start using deprecated parts of an API.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api-operation"><a class="link" href="#api-operation">16. API Operation</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="book.must-provide-online-access-to-openapi-reference-definition"><a class="link" href="#book.must-provide-online-access-to-openapi-reference-definition">16.1. <span style="color:#bf0000"><strong>MUST</strong></span> Provide Online Access to OpenAPI Reference Definition</a></h3>
<div class="paragraph">
<p>All service applications must support access to the OpenAPI Reference
Definitions of their external APIs  it is optional for internal APIs 
via the following two API endpoints:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>endpoint(s) for GET access on its OpenAPI definition(s), for instance
<code><a href="https://example.com/swagger.json" class="bare">https://example.com/swagger.json</a></code> or
<code><a href="https://example.com/swagger.yaml" class="bare">https://example.com/swagger.yaml</a></code>.</p>
</li>
<li>
<p>API Discovery endpoint
<code><a href="https://example.com/.well-known/schema-discovery" class="bare">https://example.com/.well-known/schema-discovery</a></code> that delivers a JSON
discovery document of the following form (adapt the <code>schema_url</code> to
point to the endpoint mentioned above):</p>
<div class="literalblock">
<div class="content">
<pre>{
    "schema_url": "/swagger.json",
    "schema_type": "swagger-2.0",
    "ui_url": "/ui/"
}</pre>
</div>
</div>
</li>
<li>
<p>whether these endpoints have to be secured by OAuth depends on context
of your API and product management</p>
</li>
<li>
<p>if you secure these endpoint, only use <code>uid</code> scope</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Hint: Though discovery endpoints have to be supported, they should not
be specified in the OpenAPI definition as they are generic and provide
no API specific information.</p>
</div>
<div class="paragraph">
<p>We distinguish between internal and external APIs of an application
which is owned by a specific team and often implemented via small set of
services. An external API is used by clients outside the team - usually
another application owned by a different team or even an external
business partner user of our platform. An internal API is only used
within the application and only by the owning team, for instance, for
operational or implementation internal purposes.</p>
</div>
<div class="paragraph">
<p>Background: In our dynamic and complex service infrastructure, it is
important to provide API client developers a central place with online
access to the OpenAPI reference definitions of all running applications.
As a part of the Zalando infrastructure, the
<code>.well-known/schema-discovery</code> endpoint is used by the API Discovery to
detect all API definitions. It checks all running applications via the
endpoint above and stores the discovered API definitions. API Discovery
itself provides a RESTful API as well as an API Viewer (Swagger-UI) for
central access to all discovered API definitions.</p>
</div>
<div class="paragraph">
<p>Editorial: For the time being, this document is an appropriate place to
mention this rule, even though it is not a RESTful API definition rule
but related to service implementation obligations to support client
developer API discovery.</p>
</div>
<div class="paragraph">
<p>Further reading:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/zalando-stups/twintip-spring-web">Library to make
your Spring Boot service crawlable via API Discovery</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="book.should-monitor-api-usage"><a class="link" href="#book.should-monitor-api-usage">16.2. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Monitor API Usage</a></h3>
<div class="paragraph">
<p>Owners of APIs used in production should monitor API service to get
information about its using clients. This information, for instance, is
useful to identify potential review partner for API changes.</p>
</div>
<div class="paragraph">
<p>Hint: A preferred way of client detection implementation is by logging
of the client-id retrieved from the OAuth token.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="events"><a class="link" href="#events">17. Events</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Zalandos architecture centers around decoupled microservices and in
that context we favour asynchronous event driven approaches. The
guidelines in this section focus on how to design and publish events
intended to be shared for others to consume.</p>
</div>
<div class="paragraph">
<p><strong>Events, Event Types and Categories.</strong></p>
</div>
<div class="paragraph">
<p>Events are defined using an item called an <em>Event Type</em>. The Event Type
allows events to have their structure declared with a schema by
producers and understood by consumers. An Event Type declares standard
information, such as a name, an owning application (and by implication,
an owning team), a schema defining the event&#8217;s custom data, and a
compatibility mode declaring how the schema will be evolved. Event Types
also allow the declaration of validation and enrichment strategies for
events, along with supplemental information such as how events can be
partitioned in an event stream.</p>
</div>
<div class="paragraph">
<p>Event Types belong to a well known <em>Event Category</em> (such as a data
change category), which provides extra information that is common to
that kind of event.</p>
</div>
<div class="paragraph">
<p>Event Types can be published and made available as API resources for
teams to use, typically in an <em>Event Type Registry</em>. Each event
published can then be validated against the overall structure of its
event type and the schema for its custom data.</p>
</div>
<div class="paragraph">
<p>The basic model described above was originally developed in the
<a href="https://github.com/zalando/nakadi">Nakadi project</a>, which acts as a
reference implementation of the event type registry, and as a validating
publish/subscribe broker for event producers and consumers.</p>
</div>
<div class="sect2">
<h3 id="book.must-treat-events-as-part-of-the-service-interface"><a class="link" href="#book.must-treat-events-as-part-of-the-service-interface">17.1. <span style="color:#bf0000"><strong>MUST</strong></span> Treat Events as part of the service interface</a></h3>
<div class="paragraph">
<p>Events are part of a services interface to the outside world equivalent
in standing to a services REST API. Services publishing data for
integration must treat their events as a first class design concern,
just as they would an API. For example this means approaching events
with the "API first" principle in mind <a href="../Introduction.md">as
described in the Introduction</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-make-events-available-for-review"><a class="link" href="#book.must-make-events-available-for-review">17.2. <span style="color:#bf0000"><strong>MUST</strong></span> Make Events available for review</a></h3>
<div class="paragraph">
<p>Services publishing event data for use by others must make the event
schema available for review.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-ensure-event-type-schemas-conform-to-open-apis-schema-object"><a class="link" href="#book.must-ensure-event-type-schemas-conform-to-open-apis-schema-object">17.3. <span style="color:#bf0000"><strong>MUST</strong></span> Ensure Event Type schemas conform to Open API&#8217;s Schema Object</a></h3>
<div class="paragraph">
<p>Event type schema are defined in accordance with the Open API Schema
Object specification, which uses a subset of
<a href="http://json-schema.org/">JSON Schema Draft 4</a>, and also adds other
features. This allows events to properly align with API resource
representations (it&#8217;s particulary useful for events that represent data
changes about resources). The guideline exists since declaring event
type schema using JSON-Schema syntax is common practice (because Open
API doesn&#8217;t yet allow standalone object definitions).</p>
</div>
<div class="paragraph">
<p>In the rest of this section we&#8217;ll call out some of the more notable
differences between Open API and JSON-Schema. Please note this is not a
complete list - in general it&#8217;s recommended to familiarise yourself with
Open API&#8217;s Schema Object (the details are available from the
<a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md#schemaObject">"Schema
Object" section of that specification</a>).</p>
</div>
<div class="paragraph">
<p>Open API <em>removes</em> some JSON-Schema keywords. These must not be used in
event type schemas. The list of Open API object keywords can be seen
<a href="https://github.com/OAI/OpenAPI-Specification/blob/master/schemas/v2.0/schema.json#L935-L1063">here</a>,
but for convenience the list of non-available keywords relative to
JSON-Schema are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>additionalItems</code></p>
</li>
<li>
<p><code>contains</code></p>
</li>
<li>
<p><code>patternProperties</code></p>
</li>
<li>
<p><code>dependencies</code></p>
</li>
<li>
<p><code>propertyNames</code></p>
</li>
<li>
<p><code>const</code></p>
</li>
<li>
<p><code>not</code></p>
</li>
<li>
<p><code>oneOf</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Open API <em>redefines</em> some keywords:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>additionalProperties</code>: For event types that declare compatibility
guarantees, there are recommended constraints around the use of this
field. See the guideline "Avoid <code>additionalProperties</code> in event type
definitions" for details.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Open API <em>extends</em> JSON-Schema with some keywords:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>readOnly</code>: events are logically immutable, so <code>readOnly</code> can be
considered redundant, but harmless.</p>
</li>
<li>
<p><code>discriminator</code>: discriminators exist to support polymorphism and act
as an alternative to <code>oneOf</code>.</p>
</li>
<li>
<p><code>^x-</code>: patterned objects in the form of
<a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md#vendorExtensions">vendor
extensions</a> can be used in event type schema, but it might be the case
that general purpose validators do not understand them to enforce a
validation check, and fall back to must-ignore processing. A future
version of the guidelines may define well known vendor extensions for
events.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="book.must-ensure-that-events-are-registered-as-event-types"><a class="link" href="#book.must-ensure-that-events-are-registered-as-event-types">17.4. <span style="color:#bf0000"><strong>MUST</strong></span> Ensure that Events are registered as Event Types</a></h3>
<div class="paragraph">
<p>In Zalando&#8217;s architecture, events are registered using a structure
called an <em>Event Type</em>. The Event Type declares standard information as
follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A well known event category, such as a general or data change
category.</p>
</li>
<li>
<p>The name of the event type.</p>
</li>
<li>
<p>An owning application, and by implication, an owning team.</p>
</li>
<li>
<p>A schema defining the event payload.</p>
</li>
<li>
<p>The compatibility mode for the type.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Event Types allow easier discovery of event information and ensure that
information is well-structured, consistent, and can be validated.</p>
</div>
<div class="paragraph">
<p>Event type owners must pay attention to the choice of compatibility
mode. The mode provides a means to evolve thee schema. The range of
modes are designed to be flexible enough so that producers can evolve
schemas while not inadvertently breaking existing consumers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>none</code>: Any schema modification is accepted, even if it might break
existing producers or consumers. When validating events, undefined
properties are accepted unless declared in the schema.</p>
</li>
<li>
<p><code>forward</code>: A schema <code>S1</code> is forward compatible if the previously
registered schema, <code>S0</code> can read events defined by <code>S1</code> - that is,
consumers can read events tagged with the latest schema version using
the previous version as long as consumers follow the robustness
principle described in the guideline&#8217;s <a href="../DesignPrinciples.md">API
Design Principles</a>.</p>
</li>
<li>
<p><code>compatible</code>: This means changes are fully compatible. A new schema,
<code>S1</code>, is fully compatible when every event published since the first
schema version will validate against the latest schema. In compatible
mode, only the addition of new optional properties and definitions to an
existing schema is allowed. Other changes are forbidden.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The compatibility mode interact with revision numbers in the schema
<code>version</code> field, which follows semantic versioning (MAJOR.MINOR.PATCH):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Changing an event type with compatibility mode <code>compatible</code> can lead
to a PATCH or MINOR version revision. MAJOR breaking changes are not
allowed.</p>
</li>
<li>
<p>Changing an event type with compatibility mode <code>forward</code> can lead to a
PATCH or MINOR version revision. MAJOR breaking changes are not allowed.</p>
</li>
<li>
<p>Changing an event type with compatibility mode <code>none</code> can lead to
PATCH, MINOR or MAJOR level changes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following examples illustrate this relations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Changes to the event type&#8217;s <code>title</code> or <code>description</code> are considered
PATCH level.</p>
</li>
<li>
<p>Adding new optional fields to an event type&#8217;s schema is considered a
MINOR level change.</p>
</li>
<li>
<p>All other changes are considered MAJOR level, such as renaming or
removing fields, or adding new required fields.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The core Event Type structure is shown below as an Open API object
definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">EventType:
    description: |
      An event type defines the schema and its runtime properties. The required
      fields are the minimum set the creator of an event type is expected to
      supply.
    required:
      - name
      - category
      - owning_application
      - schema
    properties:
      name:
        description: |
          Name of this EventType.  Note: the name can encode the
          owner/responsible for this EventType and ideally should follow a
          naming pattern that makes it easy to read and understand.
        type: string
        pattern: '[a-zA-Z][-0-9a-zA-Z_]*(\.[a-zA-Z][-0-9a-zA-Z_]*)*'
        example: order.order_cancelled, business_partner.contract
      owning_application:
        description: |
          Name of the application (eg, as would be used in infrastructure
          application or service registry) owning this `EventType`.
        type: string
        example: price-service
      category:
        description: Defines the category of this EventType.
        type: string
        x-extensible-enum:
          - data
          - general
      compatibility_mode:
        description: |
          The compatibility mode to evolve the schema.
        type: string
        x-extensible-enum:
          - compatible
          - forward
          - none
        default: forward
      schema:
        description: The most recent payload schema for this EventType.
        type: object
        properties:
          version:
            description: Values are based on semantic versioning (eg "1.2.1").
            type: string
            default: '1.0.0'
          created_at:
            description: Creation timestamp of the schema.
            type: string
            readOnly: true
            format: date-time
            example: '1996-12-19T16:39:57-08:00'
          type:
            description: |
               The schema language of schema definition. Currently only
               json_schema (JSON Schema v04) syntax is defined, but in the
               future there could be others.
            type: string
            x-extensible-enum:
              - json_schema
          schema:
            description: |
                The schema as string in the syntax defined in the field type.
            type: string
        required:
          - type
          - schema
      created_at:
        description: When this event type was created.
        type: string
        pattern: date-time
      updated_at:
        description: When this event type was last updated.
        type: string
        pattern: date-time</code></pre>
</div>
</div>
<div class="paragraph">
<p>APIs such as registries supporting event types, may extend the model,
including the set of supported categories and schema formats. For
example the Nakadi API&#8217;s event category registration also allows the
declaration of validation and enrichment strategies for events, along
with supplemental information, such as how events are partitioned in the
stream.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-ensure-events-conform-to-a-well-known-event-category"><a class="link" href="#book.must-ensure-events-conform-to-a-well-known-event-category">17.5. <span style="color:#bf0000"><strong>MUST</strong></span> Ensure Events conform to a well-known Event Category</a></h3>
<div class="paragraph">
<p>An <em>event category</em> describes a generic class of event types. The
guidelines define two such categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>General Event: a general purpose category.</p>
</li>
<li>
<p>Data Change Event: a category used for describing changes to data
entities used for data replication based data integration.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The set of categories is expected to evolve in the future.</p>
</div>
<div class="paragraph">
<p>A category describes a predefined structure that event publishers must
conform to along with standard information about that kind of event
(such as the operation for a data change event).</p>
</div>
<div class="paragraph">
<p><strong>The General Event Category.</strong></p>
</div>
<div class="paragraph">
<p>The structure of the <em>General Event Category</em> is shown below as an Open
API Schema Object definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">  GeneralEvent:
    description: |
      A general kind of event. Event kinds based on this event define their
      custom schema payload as the top level of the document, with the
      "metadata" field being required and reserved for standard metadata. An
      instance of an event based on the event type thus conforms to both the
      EventMetadata definition and the custom schema definition. Previously this
      category was called the Business Category
    required:
      - metadata
    properties:
      metadata:
          $ref: '#/definitions/EventMetadata'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Event types based on the General Event Category define their custom
schema payload at the top-level of the document, with the <code>metadata</code>
field being reserved for standard information (the contents of
<code>metadata</code> are described further down in this section).</p>
</div>
<div class="paragraph">
<p>In the example fragment below, the reserved <code>metadata</code> field is shown
with fields "a" and "b" being defined as part of the custom schema:</p>
</div>
<div class="paragraph">
<p>Note:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The General Event in a previous version of the guidelines was called a
<em>Business Event</em>. Implementation experience has shown that the
category&#8217;s structure gets used for other kinds of events, hence the name
has been generalized to reflect how teams are using it.</p>
</li>
<li>
<p>The General Event is still useful and recommended for the purpose of
defining events that drive a business process.</p>
</li>
<li>
<p>The Nakadi broker still refers to the General Category as the Business
Category and uses the keyword "business" for event type registration.
Other than that, the JSON structures are identical.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See
<a href="../events/event.md#must-use-the-general-event-category-to-signal-steps-and-arrival-points-in-business-processes">"Use
Business Events to signal steps and arrival points in business
processes"</a> for more guidance on how to use the category.</p>
</div>
<div class="paragraph">
<p><strong>The Data Change Event Category.</strong></p>
</div>
<div class="paragraph">
<p>The <em>Data Change Event Category</em> structure is shown below as an Open API
Schema Object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">  DataChangeEvent:
     description: |
        Represents a change to an entity. The required fields are those expected
        to be sent by the producer, other fields may be added by intermediaries
        such as a publish/subscribe broker. An instance of an event based on the
        event type conforms to both the DataChangeEvent's definition and the
        custom schema definition.
    required:
      - metadata
      - data_op
      - data_type
      - data
    properties:
      metadata:
        description: The metadata for this event.
        $ref: '#/definitions/EventMetadata'
      data:
        description: |
          Contains custom payload for the event type. The payload must conform
          to a schema associated with the event type declared in the metadata
          object's `event_type` field.
        type: object
      data_type:
        description: name of the (business) data entity that has been mutated
        type: string
        example: 'sales_order.order'
      data_op:
        type: string
        enum: ['C', 'U', 'D', 'S']
        description: |
          The type of operation executed on the entity:

          - C: Creation of an entity
          - U: An update to an entity.
          - D: Deletion of an entity.
          - S: A snapshot of an entity at a point in time.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Data Change Event Category is structurally different to the General
Event Category. It defines a field called <code>data</code> for placing the custom
payload information, as well as specific information related to data
changes in the <code>data_type</code>. In the example fragment below, the fields
<code>a</code> and <code>b</code> are part of the custom payload housed inside the <code>data</code>
field:</p>
</div>
<div class="paragraph">
<p>See the following guidelines for more guidance on how to use the Data
Change Event Category:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../events/event.md#should-ensure-that-data-change-events-match-api-representations">"Ensure
that Data Change Events match API representations."</a></p>
</li>
<li>
<p><a href="../events/event.md#must-use-data-change-events-to-signal-mutations">"Use
Data Change Events to signal mutations."</a>)</p>
</li>
<li>
<p><a href="../events/event.md#should-use-the-hash-partition-strategy-for-data-change-events">"Use
the hash partition strategy for Data Change Events."</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Event Metadata.</strong></p>
</div>
<div class="paragraph">
<p>The General and Data Change event categories share a common structure
for <em>metadata</em>. The metadata structure is shown below as an Open API
Schema Object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">  EventMetadata:
    type: object
    description: |
      Carries metadata for an Event along with common fields. The required
      fields are those expected to be sent by the producer, other fields may be
      added by intermediaries such as publish/subscribe broker.
    required:
      - eid
      - occurred_at
    properties:
      eid:
        description: Identifier of this event.
        type: string
        format: uuid
        example: '105a76d8-db49-4144-ace7-e683e8f4ba46'
      event_type:
        description: The name of the EventType of this Event.
        type: string
        example: 'example.important-business-event'
      occurred_at:
        description: When the event was created according to the producer.
        type: string
        format: date-time
        example: '1996-12-19T16:39:57-08:00'
      received_at:
        description: |
          When the event was seen by an intermediary such as a broker.
        type: string
        readOnly: true
        format: date-time
        example: '1996-12-19T16:39:57-08:00'
      version:
        description: |
          Version of the schema used for validating this event. This may be
          enriched upon reception by intermediaries. This string uses semantic
          versioning.
        type: string
        readOnly: true
      parent_eids:
        description: |
          Event identifiers of the Event that caused the generation of
          this Event. Set by the producer.
        type: array
        items:
          type: string
          format: uuid
        example: '105a76d8-db49-4144-ace7-e683e8f4ba46'
      flow_id:
        description: |
          A flow-id for this event (corresponds to the X-Flow-Id HTTP header).
        type: string
        example: 'JAh6xH4OQhCJ9PutIV_RYw'
      partition:
        description: |
          Indicates the partition assigned to this Event. Used for systems where
          an event type's events can be sub-divided into partitions.
        type: string
        example: '0'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note than intermediaries acting between the producer of an event
and its ultimate consumers, may perform operations like validation of
events and enrichment of an event&#8217;s <code>metadata</code>. For example brokers such
as Nakadi, can validate and enrich events with arbitrary additional
fields that are not specified here and may set default or other values,
if some of the specified fields are not supplied. How such systems work
is outside the scope of these guidelines but producers and consumers
working with such systems should be look into their documentation for
additional information.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-ensure-that-events-define-useful-business-resources"><a class="link" href="#book.must-ensure-that-events-define-useful-business-resources">17.6. <span style="color:#bf0000"><strong>MUST</strong></span> Ensure that Events define useful business resources</a></h3>
<div class="paragraph">
<p>Events are intended to be used by other services including business
process/data analytics and monitoring. They should be based around the
resources and business processes you have defined for your service
domain and adhere to its natural lifecycle (see also "Should: Define
useful resources" in the
<a href="../general-guidelines/GeneralGuidelines.md">General Guidelines</a>).</p>
</div>
<div class="paragraph">
<p>As there is a cost in creating an explosion of event types and topics,
prefer to define event types that are abstract/generic enough to be
valuable for multiple use cases, and avoid publishing event types
without a clear need.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-events-must-not-provide-sensitive-customer-personal-data."><a class="link" href="#book.must-events-must-not-provide-sensitive-customer-personal-data.">17.7. <span style="color:#bf0000"><strong>MUST</strong></span> Events must not provide sensitive customer personal data.</a></h3>
<div class="paragraph">
<p>Similar to API permission scopes, there will be Event Type permissions
passed via an OAuth token supported in near future. In the meantime,
teams are asked to note the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Sensitive data, such as (e-mail addresses, phone numbers, etc) are
subject to strict access and data protection controls.</p>
</li>
<li>
<p>Event type owners <strong>must not</strong> publish sensitive information unless it&#8217;s
mandatory or necessary to do so. For example, events sometimes need to
provide personal data, such as delivery addresses in shipment orders (as
do other APIs), and this is fine.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="book.must-use-the-general-event-category-to-signal-steps-and-arrival-points-in-business-processes"><a class="link" href="#book.must-use-the-general-event-category-to-signal-steps-and-arrival-points-in-business-processes">17.8. <span style="color:#bf0000"><strong>MUST</strong></span> Use the General Event Category to signal steps and</a></h3>
<div class="paragraph">
<p>arrival points in business processes</p>
</div>
<div class="paragraph">
<p>When publishing events that represent steps in a business process, event
types must be based on the General Event category.</p>
</div>
<div class="paragraph">
<p>All your events of a single business process will conform to the
following rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Business events must contain a specific identifier field (a business
process id or "bp-id") similar to flow-id to allow for efficient
aggregation of all events in a business process execution.</p>
</li>
<li>
<p>Business events must contain a means to correctly order events in a
business process execution. In distributed settings where monotonically
increasing values (such as a high precision timestamp that is assured to
move forwards) cannot be obtained, the <code>parent_eids</code> data structure
allows causal relationships to be declared between events.</p>
</li>
<li>
<p>Business events should only contain information that is new to the
business process execution at the specific step/arrival point.</p>
</li>
<li>
<p>Each business process sequence should be started by a business event
containing all relevant context information.</p>
</li>
<li>
<p>Business events must be published reliably by the service.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>At the moment we cannot state whether it&#8217;s best practice to publish all
the events for a business process using a single event type and
represent the specific steps with a state field, or whether to use
multiple event types to represent each step. For now we suggest
assessing each option and sticking to one for a given business process.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-use-data-change-events-to-signal-mutations"><a class="link" href="#book.must-use-data-change-events-to-signal-mutations">17.9. <span style="color:#bf0000"><strong>MUST</strong></span> Use Data Change Events to signal mutations</a></h3>
<div class="paragraph">
<p>When publishing events that represents created, updated, or deleted
data, change event types must be based on the Data Change Event
category.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Change events must identify the changed entity to allow aggregation of
all related events for the entity.</p>
</li>
<li>
<p>Change events should
<a href="#should-provide-a-means-of-event-ordering">contain a means of
ordering</a> events for a given entity.</p>
</li>
<li>
<p>Change events must be published reliably by the service.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="book.should-provide-a-means-for-explicit-event-ordering"><a class="link" href="#book.should-provide-a-means-for-explicit-event-ordering">17.10. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Provide a means for explicit event ordering</a></h3>
<div class="paragraph">
<p>Some common error cases may require event consumers to reconstruct event
streams or replay events from a position within the stream. Events
<em>should</em> therefore contain a way to restore their partial order of
occurrence.</p>
</div>
<div class="paragraph">
<p>This can be done - among other ways - by adding - a strictly
monotonically increasing entity version (e.g. as created by a database)
to allow for partial ordering of all events for an entity - a strictly
monotonically increasing message counter</p>
</div>
<div class="paragraph">
<p>System timestamps are not necessarily a good choice, since exact
synchronization of clocks in distributed systems is difficult, two
events may occur in the same microsecond and system clocks may jump
backward or forward to compensate drifts or leap-seconds. If you use
system timestamps to indicate event ordering, you must carefully ensure
that your designated event order is not messed up by these effects.</p>
</div>
<div class="paragraph">
<p><strong>Note</strong> that basing events on data structures that can be converged upon
in a distributed setting (such as
<a href="https://en.wikipedia.org/wiki/Conflict-free_replicated_data_type">CRDTs</a>,
<a href="https://en.wikipedia.org/wiki/Logical_clock">logical clocks</a> and
<a href="https://en.wikipedia.org/wiki/Vector_clock">vector clocks</a>) is outside
the scope of this guidance.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-use-the-hash-partition-strategy-for-data-change-events"><a class="link" href="#book.should-use-the-hash-partition-strategy-for-data-change-events">17.11. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Use the hash partition strategy for Data Change Events</a></h3>
<div class="paragraph">
<p>The <code>hash</code> partition strategy allows a producer to define which fields
in an event are used as input to compute a logical partition the event
should be added to. Partitions are useful as they allow supporting
systems to scale their throughput while provide local ordering for event
entities.</p>
</div>
<div class="paragraph">
<p>The <code>hash</code> option is particulary useful for data changes as it allows
all related events for an entity to be consistently assigned to a
partition, providing a relative ordered stream of events for that
entity. This is because while each partition has a total ordering,
ordering across partitions is not assured by a supporting system, thus
it is possible for events sent across partitions to appear in a
different order to consumers that the order they arrived at the server.</p>
</div>
<div class="paragraph">
<p>When using the <code>hash</code> strategy the partition key in almost all cases
should represent the entity being changed and not a per event or change
identifier such as the <code>eid</code> field or a timestamp. This ensures data
changes arrive at the same partition for a given entity and can be
consumed effectively by clients.</p>
</div>
<div class="paragraph">
<p>There may be exceptional cases where data change events could have their
partition strategy set to be the producer defined or random options, but
generally <code>hash</code> is the right option - that is while the guidelines here
are a "should", they can be read as "must, unless you have a very good
reason".</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-ensure-that-data-change-events-match-api-representations"><a class="link" href="#book.should-ensure-that-data-change-events-match-api-representations">17.12. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Ensure that Data Change Events match API representations</a></h3>
<div class="paragraph">
<p>A data change event&#8217;s representation of an entity should correspond to
the REST API representation.</p>
</div>
<div class="paragraph">
<p>There&#8217;s value in having the fewest number of published structures for a
service. Consumers of the service will be working with fewer
representations, and the service owners will have less API surface to
maintain. In particular, you should only publish events that are
interesting in the domain and abstract away from implementation or local
details - there&#8217;s no need to reflect every change that happens within
your system.</p>
</div>
<div class="paragraph">
<p>There are cases where it could make sense to define data change events
that don&#8217;t directly correspond to your API resource representations.
Some examples are -</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Where the API resource representations are very different from the
datastore representation, but the physical data are easier to reliably
process for data integration.</p>
</li>
<li>
<p>Publishing aggregated data. For example a data change to an individual
entity might cause an event to be published that contains a coarser
representation than that defined for an API</p>
</li>
<li>
<p>Events that are the result of a computation, such as a matching
algorithm, or the generation of enriched data, and which might not be
stored as entity by the service.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="book.must-permissions-on-events-must-correspond-to-api-permissions"><a class="link" href="#book.must-permissions-on-events-must-correspond-to-api-permissions">17.13. <span style="color:#bf0000"><strong>MUST</strong></span> Permissions on events must correspond to API permissions</a></h3>
<div class="paragraph">
<p>If a resource can be read synchronously via a REST API and read
asynchronously via an event, the same read-permission must apply: We
want to protect access to data, not the way data is accessed.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-indicate-ownership-of-event-types"><a class="link" href="#book.must-indicate-ownership-of-event-types">17.14. <span style="color:#bf0000"><strong>MUST</strong></span> Indicate ownership of Event Types</a></h3>
<div class="paragraph">
<p>Event definitions must have clear ownership - this can be indicated via
the <code>owning_application</code> field of the EventType.</p>
</div>
<div class="paragraph">
<p>Typically there is one producer application, which owns the EventType
and is responsible for its definition, akin to how RESTful API
definitions are managed. However, the owner may also be a particular
service from a set of multiple services that are producing the same kind
of event.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-define-event-payloads-in-accordance-with-the-overall-guidelines"><a class="link" href="#book.must-define-event-payloads-in-accordance-with-the-overall-guidelines">17.15. <span style="color:#bf0000"><strong>MUST</strong></span> Define Event Payloads in accordance with the overall Guidelines</a></h3>
<div class="paragraph">
<p>Events must be consistent with other API data and the API Guidelines in
general.</p>
</div>
<div class="paragraph">
<p>Everything expressed in the <a href="../Introduction.md">Introduction to
these Guidelines</a> is applicable to event data interchange between
services. This is because our events, just like our APIs, represent a
commitment to express what our systems do and designing high-quality,
useful events allows us to develop new and interesting products and
services.</p>
</div>
<div class="paragraph">
<p>What distinguishes events from other kinds of data is the delivery style
used, asynchronous publish-subscribe messaging. But there is no reason
why they could not be made available using a REST API, for example via a
search request or as a paginated feed, and it will be common to base
events on the models created for the services REST API.</p>
</div>
<div class="paragraph">
<p>The following existing guideline sections are applicable to events -</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../general-guidelines/GeneralGuidelines.md">General Guidelines</a></p>
</li>
<li>
<p><a href="../naming/Naming.md">Naming</a></p>
</li>
<li>
<p><a href="../data-formats/DataFormats.md">Data Formats</a></p>
</li>
<li>
<p><a href="../common-data-types/CommonDataTypes.md">Common Data Objects</a></p>
</li>
<li>
<p><a href="../hyper-media/Hypermedia.md">Hypermedia</a> -</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="book.must-maintain-backwards-compatibility-for-events"><a class="link" href="#book.must-maintain-backwards-compatibility-for-events">17.16. <span style="color:#bf0000"><strong>MUST</strong></span> Maintain backwards compatibility for Events</a></h3>
<div class="paragraph">
<p>Changes to events must be based around making additive and backward
compatible changes. This follows the guideline, "Must: Dont Break
Backward Compatibility" from the
<a href="../compatibility/Compatibility.md">Compatibility guidelines</a>.</p>
</div>
<div class="paragraph">
<p>In the context of events, compatibility issues are complicated by the
fact that producers and consumers of events are highly asynchronous and
cant use content-negotiation techniques that are available to REST
style clients and servers. This places a higher bar on producers to
maintain compatibility as they will not be in a position to serve
versioned media types on demand.</p>
</div>
<div class="paragraph">
<p>For event schema, these are considered backward compatible changes, as
seen by consumers -</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adding new optional fields to JSON objects.</p>
</li>
<li>
<p>Changing the order of fields (field order in objects is arbitrary).</p>
</li>
<li>
<p>Changing the order of values with same type in an array.</p>
</li>
<li>
<p>Removing optional fields.</p>
</li>
<li>
<p>Removing an individual value from an enumeration.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These are considered backwards-incompatible changes, as seen by
consumers -</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Removing required fields from JSON objects.</p>
</li>
<li>
<p>Changing the default value of a field.</p>
</li>
<li>
<p>Changing the type of a field, object, enum or array.</p>
</li>
<li>
<p>Changing the order of values with different type in an array (also
known as a tuple).</p>
</li>
<li>
<p>Adding a new optional field to redefine the meaning of an existing
field (also known as a co-occurrence constraint).</p>
</li>
<li>
<p>Adding a value to an enumeration (note that
<a href="../compatibility/Compatibility.md#should-used-openended-list-of-values-xextensibleenum-instead-of-enumerations"><code>x-extensible-enum</code></a>
is not available in JSON Schema).</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="book.should-avoid-additionalproperties-in-event-type-definitions"><a class="link" href="#book.should-avoid-additionalproperties-in-event-type-definitions">17.17. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Avoid <code>additionalProperties</code> in event type definitions</a></h3>
<div class="paragraph">
<p>Event type schema should avoid using <code>additionalProperties</code>
declarations, in order to support schema evolution.</p>
</div>
<div class="paragraph">
<p>Events are often intermediated by publish/subscribe systems and are
commonly captured in logs or long term storage to be read later. In
particular, the schemas used by publishers and consumers can<br>
drift over time. As a result, compatibility and extensibility issues
that happen less frequently with client-server style APIs become
important and regular considerations for event design. The guidelines
recommend the following to enable event schema evolution:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Publishers who intend to provide compatibility and allow their schemas
to evolve safely over time <strong>must not</strong> declare an <code>additionalProperties</code>
field with a value of <code>true</code> (i.e., a wildcard extension point). Instead
they must define new optional fields and update their schemas in advance
of publishing those fields.</p>
</li>
<li>
<p>Consumers <strong>must</strong> ignore fields they cannot process and not raise
errors. This can happen if they are processing events with an older copy
of the event schema than the one containing the new definitions
specified by the publishers.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The above constraint does not mean fields can never be added in future
revisions of an event type schema - additive compatible changes are
allowed, only that the new schema for an event type must define the
field first before it is published within an event. By the same turn the
consumer must ignore fields it does not know about from its copy of the
schema, just as they would as an API client - that is, they cannot treat
the absence of an <code>additionalProperties</code> field as though the event type
schema was closed for extension.</p>
</div>
<div class="paragraph">
<p>Requiring event publishers to define their fields ahead of publishing
avoids the problem of <em>field redefinition</em>. This is when a publisher
defines a field to be of a different type that was already being
emitted, or, is changing the type of an undefined field. Both of these
are prevented by not using <code>additionalProperties</code>.</p>
</div>
<div class="paragraph">
<p>See also "Treat Open API Definitions As Open For Extension By Default"<br>
in the
<a href="../compatibility/Compatibility.md#must-treat-open-api-definitions-as-open-for-extension-by-default">Compatibility</a>
section for further guidelines on the use of <code>additionalProperties</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-use-unique-event-identifiers"><a class="link" href="#book.must-use-unique-event-identifiers">17.18. <span style="color:#bf0000"><strong>MUST</strong></span> Use unique Event identifiers</a></h3>
<div class="paragraph">
<p>The <code>eid</code> (event identifier) value of an event must be unique.</p>
</div>
<div class="paragraph">
<p>The <code>eid</code> property is part of the standard metadata for an event and
gives the event an identifier. Producing clients must generate this
value when sending an event and it must be guaranteed to be unique from
the perspective of the owning application. In particular events within a
given event type&#8217;s stream must have unique identifiers. This allows
consumers to process the <code>eid</code> to assert the event is unique and use it
as an idempotency check.</p>
</div>
<div class="paragraph">
<p>Note that uniqueness checking of the <code>eid</code> might be not enforced by
systems consuming events and it is the responsibility of the producer to
ensure event identifiers do in fact distinctly identify events. A
straightforward way to create a unique identifier for an event is to
generate a UUID value.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.should-design-for-idempotent-out-of-order-processing"><a class="link" href="#book.should-design-for-idempotent-out-of-order-processing">17.19. <span style="color:#bfbf00"><strong>SHOULD</strong></span> Design for idempotent out-of-order processing</a></h3>
<div class="paragraph">
<p>Events that are designed for
<a href="#must-use-unique-event-identifiers">idempotent</a> out-of-order
processing allow for extremely resilient systems: If processing an event
fails, consumers and producers can skip/delay/retry it without stopping
the world or corrupting the processing result.</p>
</div>
<div class="paragraph">
<p>To enable this freedom of processing, you must explicitly design for
idempotent out-of-order processing: Either your events must contain
enough information to infer their original order during consumption or
your domain must be designed in a way that order becomes irrelevant.</p>
</div>
<div class="paragraph">
<p>As common example similar to data change events, idempotent out-of-order
processing can be supported by sending the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the process/resource/entity identifier,</p>
</li>
<li>
<p>a <a href="#should-provide-a-means-of-event-ordering">monotonically
increasing ordering key</a> and</p>
</li>
<li>
<p>the process/resource state after the change.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A receiver that is interested in the current state can then ignore
events that are older than the last processed event of each resource. A
receiver interested in the history of a resource can use the ordering
key to recreate a (partially) ordered sequence of events.</p>
</div>
</div>
<div class="sect2">
<h3 id="book.must-follow-conventions-for-event-type-names"><a class="link" href="#book.must-follow-conventions-for-event-type-names">17.20. <span style="color:#bf0000"><strong>MUST</strong></span> Follow conventions for Event Type names</a></h3>
<div class="paragraph">
<p>Event types can follow these naming conventions (each convention has its
own should, must or could conformance level) -</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Event type names must be url-safe. This is because the event type
names may appear in URLs published by other systems and APIs.</p>
</li>
<li>
<p>Event type names should be lowercase words and numbers, using hyphens,
underscores or periods as separators.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="book.must-prepare-for-duplicate-events"><a class="link" href="#book.must-prepare-for-duplicate-events">17.21. <span style="color:#bf0000"><strong>MUST</strong></span> Prepare for duplicate Events</a></h3>
<div class="paragraph">
<p>Event consumers must be able to process duplicate events.</p>
</div>
<div class="paragraph">
<p>Most message brokers and data streaming systems offer at-least-once
delivery. That is, one particular event is delivered to the consumers
one or more times. Other circumstances can also cause duplicate events.</p>
</div>
<div class="paragraph">
<p>For example, these situations occur if the publisher sends an event and
doesn&#8217;t receive the acknowledgment (e.g. due to a network issue). In
this case, the publisher will try to send the same event again. This
leads to two identical events in the event bus which have to be
processed by the consumers. Similar conditions can appear on consumer
side: an event has been processed successfully, but the consumer fails
to confirm the processing.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="references"><a class="link" href="#references">18. Appendix: References</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section collects links to documents to which we refer, and base our guidelines on.</p>
</div>
<div class="sect2">
<h3 id="references-open-api-specification"><a class="link" href="#references-open-api-specification">18.1. OpenAPI Specification</a></h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/OAI/OpenAPI-Specification/">OpenAPI Specification</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="references-publications-specifications-and-standards"><a class="link" href="#references-publications-specifications-and-standards">18.2. Publications, specifications and standards</a></h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://tools.ietf.org/html/rfc3339">RFC 3339: Date and Time on the Internet: Timestamps</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc5988">RFC 5988: Web Linking</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc7159">RFC 7159: The JavaScript Object Notation (JSON) Data Interchange Format</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc7230">RFC 7230: Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc7231">RFC 7231: Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc7807">RFC 7807: Problem Details for HTTP APIs</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601: Date and time format</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">ISO 3166-1 alpha-2: Two letter country codes</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes">ISO 639-1: Two letter language codes</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/ISO_4217">ISO 4217: Currency codes</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/bcp47">BCP 47: Tags for Identifying Languages</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="references-dissertations"><a class="link" href="#references-dissertations">18.3. Dissertations</a></h3>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm">Roy Thomas Fielding - Architectural Styles and the Design of Network-Based Software Architectures</a>. This is the text which defines what REST is.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="references-books"><a class="link" href="#references-books">18.4. Books</a></h3>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.amazon.de/REST-Practice-Hypermedia-Systems-Architecture/dp/0596805829">REST in Practice: Hypermedia and Systems Architecture</a></p>
</li>
<li>
<p><a href="https://leanpub.com/build-apis-you-wont-hate">Build APIs You Won&#8217;t Hate</a></p>
</li>
<li>
<p><a href="http://www.infoq.com/minibooks/emag-web-api">InfoQ eBook - Web APIs: From Start to Finish</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="references-blogs"><a class="link" href="#references-blogs">18.5. Blogs</a></h3>
<div class="ulist">
<ul>
<li>
<p><a href="http://restful-api-design.readthedocs.org/en/latest/">Lessons-learned blog: Thoughts on RESTful API Design</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="appendix-tooling"><a class="link" href="#appendix-tooling">19. Appendix: Tooling</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is not a part of the actual guidelines, but might be helpful for following them.
Using a tool mentioned here doesn&#8217;t automatically ensure you follow the guidelines.</p>
</div>
<div class="sect2">
<h3 id="api-first-integrations"><a class="link" href="#api-first-integrations">19.1. API First Integrations</a></h3>
<div class="paragraph">
<p>The following frameworks were specifically designed to support the API First workflow with OpenAPI YAML files (sorted alphabetically):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/zalando/connexion">Connexion: OpenAPI First framework for Python on top of Flask</a></p>
</li>
<li>
<p><a href="https://github.com/zalando-stups/friboo">Friboo: utility library to write microservices in Clojure with support for Swagger and OAuth</a></p>
</li>
<li>
<p><a href="https://github.com/zalando/api-first-hand">Api-First-Hand: API-First Play Bootstrapping Tool for Swagger/OpenAPI specs</a></p>
</li>
<li>
<p><a href="https://github.com/swagger-api/swagger-codegen">Swagger Codegen: template-driven engine to generate client code in different languages by parsing Swagger Resource Declaration</a></p>
</li>
<li>
<p><a href="https://github.com/zalando-stups/swagger-codegen-tooling">Swagger Codegen Tooling: plugin for Maven that generates pieces of code from
OpenAPI specification</a></p>
</li>
<li>
<p><a href="https://github.com/zalando/intellij-swagger">Swagger Plugin for IntelliJ IDEA: plugin to help you easily edit Swagger specification
files inside IntelliJ IDEA</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Swagger/OpenAPI homepage lists more
<a href="http://swagger.io/open-source-integrations/">Community-Driven Language Integrations</a>, but most of them do not fit our API First approach.</p>
</div>
</div>
<div class="sect2">
<h3 id="support-libraries"><a class="link" href="#support-libraries">19.2. Support Libraries</a></h3>
<div class="paragraph">
<p>These utility libraries support you in implementing various parts of our RESTful API guidelines (sorted alphabetically):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/zalando/problem">Problem: Java library that implements application/problem+json</a></p>
</li>
<li>
<p><a href="https://github.com/zalando/problem-spring-web">Problems for Spring Web MVC: library for handling Problems in Spring Web MVC</a></p>
</li>
<li>
<p><a href="https://github.com/zalando/jackson-datatype-money">Jackson Datatype Money: extension module to properly support datatypes of javax.money</a></p>
</li>
<li>
<p><a href="https://github.com/zalando-incubator/json-fields">JSON fields: framework for limiting fields of JSON objects exposed by Rest APIs</a></p>
</li>
<li>
<p><a href="https://github.com/zalando/tracer">Tracer: call tracing and log correlation in distributed systems</a></p>
</li>
<li>
<p><a href="https://github.com/zalando-stups/twintip-crawler">TWINTIP: API definition crawler for the STUPS ecosystem</a></p>
</li>
<li>
<p><a href="https://github.com/zalando/twintip-spring-web">TWINTIP Spring Integration: API discovery endpoint for Spring Web MVC</a>
= Appendix: Changelog</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This change log only contains major changes made after October 2016.</p>
</div>
<div class="paragraph">
<p>Non-major changes are editorial-only changes or minor changes of existing guidelines, e.g. adding new error code.
Major changes are changes that come with additional obligations, or even change an existing guideline obligation.
The latter changes are additionally labeled with "Rule Change" here.</p>
</div>
<div class="paragraph">
<p>To see a list of all changes, please have a look at the <a href="https://github.com/zalando/restful-api-guidelines/commits/master">commit list in Github</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="rule-changes"><a class="link" href="#rule-changes">19.3. Rule Changes</a></h3>
<div class="ulist">
<ul>
<li>
<p><code>2017-07-20:</code> Be more precise on client vs. server obligations for compatible API extensions.</p>
</li>
<li>
<p><code>2017-06-06:</code> Made money object guideline clearer.</p>
</li>
<li>
<p><code>2017-05-17:</code> Added guideline on query parameter collection format.</p>
</li>
<li>
<p><code>2017-05-10:</code> Added the convention of using RFC2119 to describe guideline levels, and replaced <code>book.could</code> with <code>book.may</code>.</p>
</li>
<li>
<p><code>2017-03-30:</code> Added rule that permissions on resources in events must correspond to permissions on API resources</p>
</li>
<li>
<p><code>2017-03-30:</code> Added rule that APIs should be modelled around business processes</p>
</li>
<li>
<p><code>2017-02-28:</code> Extended information about how to reference sub-resources and the usage of composite identifiers in the <a href="../resources/Resources.md#-bookmust&#8212;&#8203;identify-resources-and-sub-resources-via-path-segments">Resources</a>
part.</p>
</li>
<li>
<p><code>2017-02-22:</code> Added guidance for conditional requests with If-Match/If-None-Match</p>
</li>
<li>
<p><code>2017-02-02:</code> Added guideline for batch and bulk request</p>
</li>
<li>
<p><code>2017-02-01:</code> Discouraged use of <a href="../headers/CommonHeaders.md#could-use-contentlocation-header">Content-Location</a>
header by requiring to use <a href="../headers/CommonHeaders.md#should-use-location-header-instead-of-contentlocation-header">Location
header</a>.</p>
</li>
<li>
<p><code>2017-01-18:</code> Removed "Avoid Javascript Keywords" rule</p>
</li>
<li>
<p><code>2017-01-05:</code> Clarification on the usage of the term "REST/RESTful"</p>
</li>
<li>
<p><code>2016-12-07:</code> Introduced "API as a Product" principle</p>
</li>
<li>
<p><code>2016-12-06:</code> New guideline: "Should Only Use UUIDs If Necessary"</p>
</li>
<li>
<p><code>2016-12-04:</code> Changed OAuth flow example from implicit to password in <a href="../security/Security.md">Security section</a>.</p>
</li>
<li>
<p><code>2016-10-13:</code> <a href="../data-formats/DataFormats.md#should-prefer-standard-media-type-name-applicationjson">Officially deprecated using custom media types instead of application/json</a>.</p>
</li>
<li>
<p><code>2016-10-10:</code> Introduced the changelog. From now on all rule changes on API guidelines will be recorded here.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-08-16 12:03:19 CEST
</div>
</div>
</body>
</html>