<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.22">
<meta name="keywords" content="Zalando, Guidelines, RESTful, API, Events, Schema">
<meta name="copyright" content="CC-BY-SA 4.0">
<title>Zalando RESTful API and Event Guidelines</title>
<style>
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.stretch { width: 100%; }

p.lead { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: #6f6f6f; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #2ba6cb; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #2795b6; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: bold; font-style: normal; color: #222222; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #6f6f6f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; color: #7f0a0c; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }

blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

body { -moz-osx-font-smoothing: grayscale; -webkit-font-smoothing: antialiased; tab-size: 4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

:not(pre):not([class^=L]) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 0; line-height: inherit; word-wrap: break-word; }

:not(pre) > code.nobreak { word-wrap: normal; }
:not(pre) > code.nowrap { white-space: nowrap; }

pre, pre > code { line-height: 1.4; color: black; font-family: monospace, serif; font-weight: normal; }

em em { font-style: normal; }

strong strong { font-weight: normal; }

.keyseq { color: #555555; }

kbd { font-family: Consolas, "Liberation Mono", Courier, monospace; display: inline-block; color: #222222; font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menuref { color: #000; }

.menuseq b:not(.caret), .menuref { font-weight: inherit; }

.menuseq { word-spacing: -0.02em; }
.menuseq b.caret { font-size: 1.25em; line-height: 0.8; }
.menuseq i.caret { font-weight: bold; text-align: center; width: 0.45em; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: black; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #dddddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #dddddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #dddddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #555555; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #6f6f6f; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #6f6f6f; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: black; border-bottom: 1px solid #dddddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 1px solid #dddddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #6f6f6f; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #f2f2f2; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }

#footer-text { color: #dddddd; line-height: 1.44; }

#content { margin-bottom: 0.625em; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { #content { margin-bottom: 1.25em; }
  .sect1 { padding-bottom: 1.25em; } }
.sect1:last-child { padding-bottom: 0; }

.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #222222; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #151515; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock.fit-content > caption.title { white-space: nowrap; width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > [class="paragraph"]:first-of-type p { font-size: 1.21875em; line-height: 1.6; color: black; }

table.tableblock #preamble > .sectionbody > [class="paragraph"]:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #555555; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #6f6f6f; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #eeeeee; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border: 1px solid #cccccc; -webkit-border-radius: 0; border-radius: 0; word-wrap: break-word; overflow-x: auto; padding: 0.8em 0.8em 0.65em 0.8em; font-size: 0.8125em; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }
.literalblock pre.nowrap, .literalblock pre.nowrap pre, .listingblock pre.nowrap, .listingblock pre.nowrap pre { white-space: pre; word-wrap: normal; }

.literalblock.output pre { color: #eeeeee; background-color: black; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 0.8em 0.8em 0.65em 0.8em; -webkit-border-radius: 0; border-radius: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

pre.prettyprint .linenums { color: #999; line-height: 1.4; margin-left: 2em; }

pre.prettyprint .linenums li { background: none; list-style-type: inherit; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; line-height: 1.4; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock p { color: #6f6f6f; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #6f6f6f; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.75em; margin-right: 0.5ex; text-align: right; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #6f6f6f; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: #555555; }

.quoteblock.abstract blockquote:before, .quoteblock.excerpt blockquote:before, .quoteblock .quoteblock blockquote:before { display: none; }
.quoteblock.abstract blockquote, .quoteblock.abstract p, .quoteblock.excerpt blockquote, .quoteblock.excerpt p, .quoteblock .quoteblock blockquote, .quoteblock .quoteblock p { line-height: 1.6; word-spacing: 0; }
.quoteblock.abstract { margin: 0 1em 1.25em 1em; display: block; }
.quoteblock.abstract > .title { margin: 0 0 0.375em 0; font-size: 1.15em; text-align: center; }
.quoteblock.excerpt, .quoteblock .quoteblock { margin: 0 0 1.25em 0; padding: 0 0 0.25em 1em; border-left: 0.25em solid #dddddd; }
.quoteblock.excerpt blockquote, .quoteblock.excerpt p, .quoteblock .quoteblock blockquote, .quoteblock .quoteblock p { color: inherit; font-size: 1.0625rem; }
.quoteblock.excerpt .attribution, .quoteblock .quoteblock .attribution { color: inherit; text-align: left; margin-right: 0; }

table.tableblock { max-width: 100%; border-collapse: separate; }

p.tableblock:last-child { margin-bottom: 0; }

td.tableblock > .content { margin-bottom: -1.25em; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dddddd; }

table.grid-all > thead > tr > .tableblock, table.grid-all > tbody > tr > .tableblock { border-width: 0 1px 1px 0; }

table.grid-all > tfoot > tr > .tableblock { border-width: 1px 1px 0 0; }

table.grid-cols > * > tr > .tableblock { border-width: 0 1px 0 0; }

table.grid-rows > thead > tr > .tableblock, table.grid-rows > tbody > tr > .tableblock { border-width: 0 0 1px 0; }

table.grid-rows > tfoot > tr > .tableblock { border-width: 1px 0 0 0; }

table.grid-all > * > tr > .tableblock:last-child, table.grid-cols > * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-all > tbody > tr:last-child > .tableblock, table.grid-all > thead:last-child > tr > .tableblock, table.grid-rows > tbody > tr:last-child > .tableblock, table.grid-rows > thead:last-child > tr > .tableblock { border-bottom-width: 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot, table.frame-ends { border-width: 1px 0; }

table.stripes-all tr, table.stripes-odd tr:nth-of-type(odd) { background: #f9f9f9; }

table.stripes-none tr, table.stripes-odd tr:nth-of-type(even) { background: none; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.4; background: whitesmoke; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222222; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.checklist, ul.none, ol.none, ul.no-bullet, ol.no-bullet, ol.unnumbered, ul.unstyled, ol.unstyled { list-style-type: none; }

ul.no-bullet, ol.no-bullet, ol.unnumbered { margin-left: 0.625em; }

ul.unstyled, ol.unstyled { margin-left: 0; }

ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1.25em; font-size: 0.8em; position: relative; bottom: 0.125em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.inline { display: -ms-flexbox; display: -webkit-box; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; list-style: none; margin: 0 0 0.625em -1.25em; }

ul.inline > li { margin-left: 1.25em; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 1.25em; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist td:not([class]):first-child { padding: 0.4em 0.75em 0 0.75em; line-height: 1; vertical-align: top; }
.colist td:not([class]):first-child img { max-width: none; }
.colist td:not([class]):last-child { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; margin-left: -1.05em; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }
a span.icon > .fa { cursor: inherit; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #207c98; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

.literalblock pre, .listingblock pre { background: #eeeeee; }

@media screen and (max-width: 768px) { #toc.toc2 { display: none; } }
object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.stretch { width: 100%; }

p.lead { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: #6f6f6f; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #2ba6cb; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #2795b6; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: bold; font-style: normal; color: #404040; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #6f6f6f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; color: #7f0a0c; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }

blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

body { -moz-osx-font-smoothing: grayscale; -webkit-font-smoothing: antialiased; tab-size: 4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

:not(pre):not([class^=L]) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 0; line-height: inherit; word-wrap: break-word; }

:not(pre) > code.nobreak { word-wrap: normal; }
:not(pre) > code.nowrap { white-space: nowrap; }

pre, pre > code { line-height: 1.4; color: black; font-family: monospace, serif; font-weight: normal; }

em em { font-style: normal; }

strong strong { font-weight: normal; }

.keyseq { color: #555555; }

kbd { font-family: Consolas, "Liberation Mono", Courier, monospace; display: inline-block; color: #222222; font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menuref { color: #000; }

.menuseq b:not(.caret), .menuref { font-weight: inherit; }

.menuseq { word-spacing: -0.02em; }
.menuseq b.caret { font-size: 1.25em; line-height: 0.8; }
.menuseq i.caret { font-weight: bold; text-align: center; width: 0.45em; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: black; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #dddddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #dddddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #dddddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #555555; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #6f6f6f; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #6f6f6f; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: black; border-bottom: 1px solid #dddddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 1px solid #dddddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #6f6f6f; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #f2f2f2; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }

#footer-text { color: #dddddd; line-height: 1.44; }

#content { margin-bottom: 0.625em; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { #content { margin-bottom: 1.25em; }
  .sect1 { padding-bottom: 1.25em; } }
.sect1:last-child { padding-bottom: 0; }

.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #404040; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #333333; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock.fit-content > caption.title { white-space: nowrap; width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > [class="paragraph"]:first-of-type p { font-size: 1.21875em; line-height: 1.6; color: black; }

table.tableblock #preamble > .sectionbody > [class="paragraph"]:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #555555; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #6f6f6f; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #eeeeee; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border: 1px solid #cccccc; -webkit-border-radius: 0; border-radius: 0; word-wrap: break-word; overflow-x: auto; padding: 0.8em 0.8em 0.65em 0.8em; font-size: 0.8125em; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }
.literalblock pre.nowrap, .literalblock pre.nowrap pre, .listingblock pre.nowrap, .listingblock pre.nowrap pre { white-space: pre; word-wrap: normal; }

.literalblock.output pre { color: #eeeeee; background-color: black; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 0.8em 0.8em 0.65em 0.8em; -webkit-border-radius: 0; border-radius: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

pre.prettyprint .linenums { color: #999; line-height: 1.4; margin-left: 2em; }

pre.prettyprint .linenums li { background: none; list-style-type: inherit; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; line-height: 1.4; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock p { color: #6f6f6f; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #6f6f6f; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.75em; margin-right: 0.5ex; text-align: right; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #6f6f6f; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: #555555; }

.quoteblock.abstract blockquote:before, .quoteblock.excerpt blockquote:before, .quoteblock .quoteblock blockquote:before { display: none; }
.quoteblock.abstract blockquote, .quoteblock.abstract p, .quoteblock.excerpt blockquote, .quoteblock.excerpt p, .quoteblock .quoteblock blockquote, .quoteblock .quoteblock p { line-height: 1.6; word-spacing: 0; }
.quoteblock.abstract { margin: 0 1em 1.25em 1em; display: block; }
.quoteblock.abstract > .title { margin: 0 0 0.375em 0; font-size: 1.15em; text-align: center; }
.quoteblock.excerpt, .quoteblock .quoteblock { margin: 0 0 1.25em 0; padding: 0 0 0.25em 1em; border-left: 0.25em solid #dddddd; }
.quoteblock.excerpt blockquote, .quoteblock.excerpt p, .quoteblock .quoteblock blockquote, .quoteblock .quoteblock p { color: inherit; font-size: 1.0625rem; }
.quoteblock.excerpt .attribution, .quoteblock .quoteblock .attribution { color: inherit; text-align: left; margin-right: 0; }

table.tableblock { max-width: 100%; border-collapse: separate; }

p.tableblock:last-child { margin-bottom: 0; }

td.tableblock > .content { margin-bottom: -1.25em; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dddddd; }

table.grid-all > thead > tr > .tableblock, table.grid-all > tbody > tr > .tableblock { border-width: 0 1px 1px 0; }

table.grid-all > tfoot > tr > .tableblock { border-width: 1px 1px 0 0; }

table.grid-cols > * > tr > .tableblock { border-width: 0 1px 0 0; }

table.grid-rows > thead > tr > .tableblock, table.grid-rows > tbody > tr > .tableblock { border-width: 0 0 1px 0; }

table.grid-rows > tfoot > tr > .tableblock { border-width: 1px 0 0 0; }

table.grid-all > * > tr > .tableblock:last-child, table.grid-cols > * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-all > tbody > tr:last-child > .tableblock, table.grid-all > thead:last-child > tr > .tableblock, table.grid-rows > tbody > tr:last-child > .tableblock, table.grid-rows > thead:last-child > tr > .tableblock { border-bottom-width: 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot, table.frame-ends { border-width: 1px 0; }

table.stripes-all tr, table.stripes-odd tr:nth-of-type(odd) { background: #f9f9f9; }

table.stripes-none tr, table.stripes-odd tr:nth-of-type(even) { background: none; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.4; background: whitesmoke; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222222; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.checklist, ul.none, ol.none, ul.no-bullet, ol.no-bullet, ol.unnumbered, ul.unstyled, ol.unstyled { list-style-type: none; }

ul.no-bullet, ol.no-bullet, ol.unnumbered { margin-left: 0.625em; }

ul.unstyled, ol.unstyled { margin-left: 0; }

ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1.25em; font-size: 0.8em; position: relative; bottom: 0.125em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.inline { display: -ms-flexbox; display: -webkit-box; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; list-style: none; margin: 0 0 0.625em -1.25em; }

ul.inline > li { margin-left: 1.25em; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 1.25em; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist td:not([class]):first-child { padding: 0.4em 0.75em 0 0.75em; line-height: 1; vertical-align: top; }
.colist td:not([class]):first-child img { max-width: none; }
.colist td:not([class]):last-child { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; margin-left: -1.05em; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }
a span.icon > .fa { cursor: inherit; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #207c98; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

.must-keyword { color: red; }

.should-keyword { color: darkgoldenrod; }

.may-keyword { color: green; }

.status-code, .status-code:link, .status-code:visited, .status-code:hover, .status-code:active { color: black; font-weight: bold; }

/* HTTP Status Codes custom text span syntax / roles / highlight */
.status-code-hint { border-radius: 4px; border-width: 2px; border-style: solid; padding: 4px 2px 0px 2px; font-size: 0.8em; }

.status-code-hint.mustnot { color: white; background-color: red; border-color: red; }

.status-code-hint.should { color: white; background-color: #32c032; border-color: #32c032; }

.status-code-hint.shouldnot { color: #595959; background-color: #e5e82d; border-color: #e5e82d; }

.status-code-hint.may { color: white; background-color: #6969f5; border-color: #6969f5; }

.status-code-methods { border-radius: 4px; border-width: 2px; border-style: solid; padding: 4px 2px 0px 2px; font-size: 0.8em; }

.do-not-use { color: gray; }

.do-not-use h5 > a { color: gray; }

.indent { padding-left: 4rem; }

.sect1 { max-width: 45em; }

#content #toc { max-width: 45em; }

code { font-size: .85em !important; }

p > code { background-color: #f0f0f0; padding: .1em .4em .1em .4em !important; font-size: .9em !important; color: inherit; }

a > code { background-color: #f0f0f0; padding: .1em .4em .1em .4em !important; font-size: .9em !important; color: black; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { padding: .5em !important; }

#toc a { color: #364149; }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/*! Stylesheet for CodeRay to loosely match GitHub themes | MIT License */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid;opacity:.35;padding:0 .5em 0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff!important;background:navy!important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:navy}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:teal}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:teal}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:teal}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword{color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:teal}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="_zalando_restful_api_and_event_guidelines"><a class="link" href="#_zalando_restful_api_and_event_guidelines">Zalando RESTful API and Event Guidelines</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://github.com/zalando/restful-api-guidelines">GitHub Repository</a> as part of
<a href="https://opensource.zalando.com/">Zalando SE Opensource</a></p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/api-zalando-small.jpg" alt="API Guild Logo">
</div>
</div>
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_zalando_restful_api_and_event_guidelines">Zalando RESTful API and Event Guidelines</a></li>
<li><a href="#introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#conventions-used-in-these-guidelines">Conventions used in these guidelines</a></li>
<li><a href="#zalando-specific-information">Zalando specific information</a></li>
</ul>
</li>
<li><a href="#principles">2. Principles</a>
<ul class="sectlevel2">
<li><a href="#api-design-principles">API design principles</a></li>
<li><a href="#api-as-a-product">API as a product</a></li>
<li><a href="#api-first">API first</a></li>
</ul>
</li>
<li><a href="#general-guidelines">3. General guidelines</a>
<ul class="sectlevel2">
<li><a href="#100"><span class="must-keyword"><strong>MUST</strong></span> follow API first principle</a></li>
<li><a href="#101"><span class="must-keyword"><strong>MUST</strong></span> provide API specification using OpenAPI</a></li>
<li><a href="#102"><span class="should-keyword"><strong>SHOULD</strong></span> provide API user manual</a></li>
<li><a href="#103"><span class="must-keyword"><strong>MUST</strong></span> write APIs using U.S. English</a></li>
<li><a href="#234"><span class="must-keyword"><strong>MUST</strong></span> only use durable and immutable remote references</a></li>
</ul>
</li>
<li><a href="#meta-information">4. REST Basics - Meta information</a>
<ul class="sectlevel2">
<li><a href="#218"><span class="must-keyword"><strong>MUST</strong></span> contain API meta information</a></li>
<li><a href="#116"><span class="must-keyword"><strong>MUST</strong></span> use semantic versioning</a></li>
<li><a href="#215"><span class="must-keyword"><strong>MUST</strong></span> provide API identifiers</a></li>
<li><a href="#219"><span class="must-keyword"><strong>MUST</strong></span> provide API audience</a></li>
<li><a href="#223"><span class="must-keyword"><strong>MUST</strong></span>/<span class="should-keyword"><strong>SHOULD</strong></span>/<span class="may-keyword"><strong>MAY</strong></span> use functional naming schema</a></li>
<li><a href="#224"><span class="must-keyword"><strong>MUST</strong></span> follow naming convention for hostnames</a></li>
</ul>
</li>
<li><a href="#security">5. REST Basics - Security</a>
<ul class="sectlevel2">
<li><a href="#104"><span class="must-keyword"><strong>MUST</strong></span> secure endpoints</a></li>
<li><a href="#105"><span class="must-keyword"><strong>MUST</strong></span> define and assign permissions (scopes)</a></li>
<li><a href="#225"><span class="must-keyword"><strong>MUST</strong></span> follow the naming convention for permissions (scopes)</a></li>
</ul>
</li>
<li><a href="#data-formats">6. REST Basics - Data formats</a>
<ul class="sectlevel2">
<li><a href="#238"><span class="must-keyword"><strong>MUST</strong></span> use standard data formats</a></li>
<li><a href="#171"><span class="must-keyword"><strong>MUST</strong></span> define a format for number and integer types</a></li>
<li><a href="#169"><span class="must-keyword"><strong>MUST</strong></span> use standard formats for date and time properties</a></li>
<li><a href="#127"><span class="should-keyword"><strong>SHOULD</strong></span> use standard formats for time duration and interval properties</a></li>
<li><a href="#170"><span class="must-keyword"><strong>MUST</strong></span> use standard formats for country, language and currency properties</a></li>
<li><a href="#244"><span class="should-keyword"><strong>SHOULD</strong></span> use content negotiation, if clients may choose from different resource representations</a></li>
<li><a href="#144"><span class="should-keyword"><strong>SHOULD</strong></span> only use UUIDs if necessary</a></li>
</ul>
</li>
<li><a href="#urls">7. REST Basics - URLs</a>
<ul class="sectlevel2">
<li><a href="#135"><span class="should-keyword"><strong>SHOULD</strong></span> not use /api as base path</a></li>
<li><a href="#134"><span class="must-keyword"><strong>MUST</strong></span> pluralize resource names</a></li>
<li><a href="#228"><span class="must-keyword"><strong>MUST</strong></span> use URL-friendly resource identifiers</a></li>
<li><a href="#129"><span class="must-keyword"><strong>MUST</strong></span> use kebab-case for path segments</a></li>
<li><a href="#136"><span class="must-keyword"><strong>MUST</strong></span> use normalized paths without empty path segments and trailing slashes</a></li>
<li><a href="#141"><span class="must-keyword"><strong>MUST</strong></span> keep URLs verb-free</a></li>
<li><a href="#138"><span class="must-keyword"><strong>MUST</strong></span> avoid actions — think about resources</a></li>
<li><a href="#140"><span class="should-keyword"><strong>SHOULD</strong></span> define <em>useful</em> resources</a></li>
<li><a href="#142"><span class="must-keyword"><strong>MUST</strong></span> use domain-specific resource names</a></li>
<li><a href="#139"><span class="should-keyword"><strong>SHOULD</strong></span> model complete business processes</a></li>
<li><a href="#143"><span class="must-keyword"><strong>MUST</strong></span> identify resources and sub-resources via path segments</a></li>
<li><a href="#241"><span class="may-keyword"><strong>MAY</strong></span> expose compound keys as resource identifiers</a></li>
<li><a href="#145"><span class="may-keyword"><strong>MAY</strong></span> consider using (non-) nested URLs</a></li>
<li><a href="#146"><span class="should-keyword"><strong>SHOULD</strong></span> limit number of resource types</a></li>
<li><a href="#147"><span class="should-keyword"><strong>SHOULD</strong></span> limit number of sub-resource levels</a></li>
<li><a href="#130"><span class="must-keyword"><strong>MUST</strong></span> use snake_case (never camelCase) for query parameters</a></li>
<li><a href="#137"><span class="must-keyword"><strong>MUST</strong></span> stick to conventional query parameters</a></li>
</ul>
</li>
<li><a href="#json-guidelines">8. REST Basics - JSON payload</a>
<ul class="sectlevel2">
<li><a href="#167"><span class="must-keyword"><strong>MUST</strong></span> use JSON as payload data interchange format</a></li>
<li><a href="#252"><span class="should-keyword"><strong>SHOULD</strong></span> design single resource schema for reading and writing</a></li>
<li><a href="#250"><span class="should-keyword"><strong>SHOULD</strong></span> be aware of services not fully supporting JSON/unicode</a></li>
<li><a href="#168"><span class="may-keyword"><strong>MAY</strong></span> pass non-JSON media types using data specific standard formats</a></li>
<li><a href="#172"><span class="should-keyword"><strong>SHOULD</strong></span> use standard media types</a></li>
<li><a href="#120"><span class="should-keyword"><strong>SHOULD</strong></span> pluralize array names</a></li>
<li><a href="#118"><span class="must-keyword"><strong>MUST</strong></span> property names must be snake_case (and never camelCase)</a></li>
<li><a href="#240"><span class="should-keyword"><strong>SHOULD</strong></span> declare enum values using UPPER_SNAKE_CASE string</a></li>
<li><a href="#235"><span class="should-keyword"><strong>SHOULD</strong></span> name date/time properties with <code>_at</code> suffix</a></li>
<li><a href="#216"><span class="should-keyword"><strong>SHOULD</strong></span> define maps using <code>additionalProperties</code></a></li>
<li><a href="#123"><span class="must-keyword"><strong>MUST</strong></span> use same semantics for <code>null</code> and absent properties</a></li>
<li><a href="#122"><span class="must-keyword"><strong>MUST</strong></span> not use <code>null</code> for boolean properties</a></li>
<li><a href="#124"><span class="should-keyword"><strong>SHOULD</strong></span> not use <code>null</code> for empty arrays</a></li>
<li><a href="#174"><span class="must-keyword"><strong>MUST</strong></span> use common field names and semantics</a></li>
<li><a href="#249"><span class="must-keyword"><strong>MUST</strong></span> use the common address fields</a></li>
<li><a href="#173"><span class="must-keyword"><strong>MUST</strong></span> use the common money object</a></li>
</ul>
</li>
<li><a href="#http-requests">9. REST Basics - HTTP requests</a>
<ul class="sectlevel2">
<li><a href="#148"><span class="must-keyword"><strong>MUST</strong></span> use HTTP methods correctly</a></li>
<li><a href="#149"><span class="must-keyword"><strong>MUST</strong></span> fulfill common method properties</a></li>
<li><a href="#229"><span class="should-keyword"><strong>SHOULD</strong></span> consider to design <code>POST</code> and <code>PATCH</code> idempotent</a></li>
<li><a href="#231"><span class="should-keyword"><strong>SHOULD</strong></span> use secondary key for idempotent <code>POST</code> design</a></li>
<li><a href="#253"><span class="may-keyword"><strong>MAY</strong></span> support asynchronous request processing</a></li>
<li><a href="#154"><span class="must-keyword"><strong>MUST</strong></span> define collection format of header and query parameters</a></li>
<li><a href="#236"><span class="should-keyword"><strong>SHOULD</strong></span> design simple query languages using query parameters</a></li>
<li><a href="#237"><span class="should-keyword"><strong>SHOULD</strong></span> design complex query languages using JSON</a></li>
<li><a href="#226"><span class="must-keyword"><strong>MUST</strong></span> document implicit response filtering</a></li>
</ul>
</li>
<li><a href="#http-status-codes-and-errors">10. REST Basics - HTTP status codes</a>
<ul class="sectlevel2">
<li><a href="#243"><span class="must-keyword"><strong>MUST</strong></span> use official HTTP status codes</a></li>
<li><a href="#151"><span class="must-keyword"><strong>MUST</strong></span> specify success and error responses</a></li>
<li><a href="#150"><span class="should-keyword"><strong>SHOULD</strong></span> only use most common HTTP status codes</a></li>
<li><a href="#220"><span class="must-keyword"><strong>MUST</strong></span> use most specific HTTP status codes</a></li>
<li><a href="#152"><span class="must-keyword"><strong>MUST</strong></span> use code 207 for batch or bulk requests</a></li>
<li><a href="#153"><span class="must-keyword"><strong>MUST</strong></span> use code 429 with headers for rate limits</a></li>
<li><a href="#176"><span class="must-keyword"><strong>MUST</strong></span> support problem JSON</a></li>
<li><a href="#177"><span class="must-keyword"><strong>MUST</strong></span> not expose stack traces</a></li>
<li><a href="#251"><span class="should-keyword"><strong>SHOULD</strong></span> not use redirection codes</a></li>
</ul>
</li>
<li><a href="#headers">11. REST Basics - HTTP headers</a>
<ul class="sectlevel2">
<li><a href="#using-headers">Using Standard Header definitions</a></li>
<li><a href="#133"><span class="may-keyword"><strong>MAY</strong></span> use standard headers</a></li>
<li><a href="#132"><span class="should-keyword"><strong>SHOULD</strong></span> use kebab-case with uppercase separate words for HTTP headers</a></li>
<li><a href="#178"><span class="must-keyword"><strong>MUST</strong></span> use <code>Content-*</code> headers correctly</a></li>
<li><a href="#180"><span class="should-keyword"><strong>SHOULD</strong></span> use <code>Location</code> header instead of <code>Content-Location</code> header</a></li>
<li><a href="#179"><span class="may-keyword"><strong>MAY</strong></span> use <code>Content-Location</code> header</a></li>
<li><a href="#181"><span class="may-keyword"><strong>MAY</strong></span> consider to support <code>Prefer</code> header to handle processing preferences</a></li>
<li><a href="#182"><span class="may-keyword"><strong>MAY</strong></span> consider to support <code>ETag</code> together with <code>If-Match</code>/<code>If-None-Match</code> header</a></li>
<li><a href="#230"><span class="may-keyword"><strong>MAY</strong></span> consider to support <code>Idempotency-Key</code> header</a></li>
<li><a href="#183"><span class="should-keyword"><strong>SHOULD</strong></span> use only the specified proprietary Zalando headers</a></li>
<li><a href="#184"><span class="must-keyword"><strong>MUST</strong></span> propagate proprietary headers</a></li>
<li><a href="#233"><span class="must-keyword"><strong>MUST</strong></span> support <code>X-Flow-ID</code></a></li>
</ul>
</li>
<li><a href="#hypermedia">12. REST Design - Hypermedia</a>
<ul class="sectlevel2">
<li><a href="#162"><span class="must-keyword"><strong>MUST</strong></span> use REST maturity level 2</a></li>
<li><a href="#163"><span class="may-keyword"><strong>MAY</strong></span> use REST maturity level 3 - HATEOAS</a></li>
<li><a href="#164"><span class="must-keyword"><strong>MUST</strong></span> use common hypertext controls</a></li>
<li><a href="#165"><span class="should-keyword"><strong>SHOULD</strong></span> use simple hypertext controls for pagination and self-references</a></li>
<li><a href="#217"><span class="must-keyword"><strong>MUST</strong></span> use full, absolute URI for resource identification</a></li>
<li><a href="#166"><span class="must-keyword"><strong>MUST</strong></span> not use link headers with JSON entities</a></li>
</ul>
</li>
<li><a href="#performance">13. REST Design - Performance</a>
<ul class="sectlevel2">
<li><a href="#155"><span class="should-keyword"><strong>SHOULD</strong></span> reduce bandwidth needs and improve responsiveness</a></li>
<li><a href="#156"><span class="should-keyword"><strong>SHOULD</strong></span> use <code>gzip</code> compression</a></li>
<li><a href="#157"><span class="should-keyword"><strong>SHOULD</strong></span> support partial responses via filtering</a></li>
<li><a href="#158"><span class="should-keyword"><strong>SHOULD</strong></span> allow optional embedding of sub-resources</a></li>
<li><a href="#227"><span class="must-keyword"><strong>MUST</strong></span> document cacheable <code>GET</code>, <code>HEAD</code>, and <code>POST</code> endpoints</a></li>
</ul>
</li>
<li><a href="#pagination">14. REST Design - Pagination</a>
<ul class="sectlevel2">
<li><a href="#159"><span class="must-keyword"><strong>MUST</strong></span> support pagination</a></li>
<li><a href="#160"><span class="should-keyword"><strong>SHOULD</strong></span> prefer cursor-based pagination, avoid offset-based pagination</a></li>
<li><a href="#248"><span class="should-keyword"><strong>SHOULD</strong></span> use pagination response page object</a></li>
<li><a href="#161"><span class="should-keyword"><strong>SHOULD</strong></span> use pagination links</a></li>
<li><a href="#254"><span class="should-keyword"><strong>SHOULD</strong></span> avoid a total result count</a></li>
</ul>
</li>
<li><a href="#compatibility">15. REST Design - Compatibility</a>
<ul class="sectlevel2">
<li><a href="#106"><span class="must-keyword"><strong>MUST</strong></span> not break backward compatibility</a></li>
<li><a href="#107"><span class="should-keyword"><strong>SHOULD</strong></span> prefer compatible extensions</a></li>
<li><a href="#109"><span class="should-keyword"><strong>SHOULD</strong></span> design APIs conservatively</a></li>
<li><a href="#108"><span class="must-keyword"><strong>MUST</strong></span> prepare clients to accept compatible API extensions</a></li>
<li><a href="#111"><span class="must-keyword"><strong>MUST</strong></span> treat OpenAPI specification as open for extension by default</a></li>
<li><a href="#113"><span class="should-keyword"><strong>SHOULD</strong></span> avoid versioning</a></li>
<li><a href="#114"><span class="must-keyword"><strong>MUST</strong></span> use media type versioning</a></li>
<li><a href="#115"><span class="must-keyword"><strong>MUST</strong></span> not use URL versioning</a></li>
<li><a href="#110"><span class="must-keyword"><strong>MUST</strong></span> always return JSON objects as top-level data structures</a></li>
<li><a href="#112"><span class="should-keyword"><strong>SHOULD</strong></span> used open-ended list of values (<code>x-extensible-enum</code>) for enumerations</a></li>
</ul>
</li>
<li><a href="#deprecation">16. REST Design - Deprecation</a>
<ul class="sectlevel2">
<li><a href="#187"><span class="must-keyword"><strong>MUST</strong></span> reflect deprecation in API specifications</a></li>
<li><a href="#185"><span class="must-keyword"><strong>MUST</strong></span> obtain approval of clients before API shut down</a></li>
<li><a href="#186"><span class="must-keyword"><strong>MUST</strong></span> collect external partner consent on deprecation time span</a></li>
<li><a href="#188"><span class="must-keyword"><strong>MUST</strong></span> monitor usage of deprecated API scheduled for sunset</a></li>
<li><a href="#189"><span class="should-keyword"><strong>SHOULD</strong></span> add <code>Deprecation</code> and <code>Sunset</code> header to responses</a></li>
<li><a href="#190"><span class="should-keyword"><strong>SHOULD</strong></span> add monitoring for <code>Deprecation</code> and <code>Sunset</code> header</a></li>
<li><a href="#191"><span class="must-keyword"><strong>MUST</strong></span> not start using deprecated APIs</a></li>
</ul>
</li>
<li><a href="#api-operation">17. REST Operation</a>
<ul class="sectlevel2">
<li><a href="#192"><span class="must-keyword"><strong>MUST</strong></span> publish OpenAPI specification</a></li>
<li><a href="#193"><span class="should-keyword"><strong>SHOULD</strong></span> monitor API usage</a></li>
</ul>
</li>
<li><a href="#events">18. EVENT Basics - Event Types</a>
<ul class="sectlevel2">
<li><a href="#208"><span class="must-keyword"><strong>MUST</strong></span> define events compliant with overall API guidelines</a></li>
<li><a href="#194"><span class="must-keyword"><strong>MUST</strong></span> treat events as part of the service interface</a></li>
<li><a href="#195"><span class="must-keyword"><strong>MUST</strong></span> make event schema available for review</a></li>
<li><a href="#197"><span class="must-keyword"><strong>MUST</strong></span> specify and register events as event types</a></li>
<li><a href="#213"><span class="must-keyword"><strong>MUST</strong></span> follow naming convention for event type names</a></li>
<li><a href="#207"><span class="must-keyword"><strong>MUST</strong></span> indicate ownership of event types</a></li>
<li><a href="#245"><span class="must-keyword"><strong>MUST</strong></span> carefully define the compatibility mode</a></li>
<li><a href="#196"><span class="must-keyword"><strong>MUST</strong></span> ensure event schema conforms to OpenAPI schema object</a></li>
<li><a href="#210"><span class="should-keyword"><strong>SHOULD</strong></span> avoid <code>additionalProperties</code> in event type schemas</a></li>
<li><a href="#246"><span class="must-keyword"><strong>MUST</strong></span> use semantic versioning of event type schemas</a></li>
</ul>
</li>
<li><a href="#event-categories">19. EVENT Basics - Event Categories</a>
<ul class="sectlevel2">
<li><a href="#198"><span class="must-keyword"><strong>MUST</strong></span> ensure that events conform to an event category</a></li>
<li><a href="#247"><span class="must-keyword"><strong>MUST</strong></span> provide mandatory event metadata</a></li>
<li><a href="#211"><span class="must-keyword"><strong>MUST</strong></span> provide unique event identifiers</a></li>
<li><a href="#201"><span class="must-keyword"><strong>MUST</strong></span> use general events to signal steps in business processes</a></li>
<li><a href="#203"><span class="should-keyword"><strong>SHOULD</strong></span> provide explicit event ordering for general events</a></li>
<li><a href="#202"><span class="must-keyword"><strong>MUST</strong></span> use data change events to signal mutations</a></li>
<li><a href="#242"><span class="must-keyword"><strong>MUST</strong></span> provide explicit event ordering for data change events</a></li>
<li><a href="#204"><span class="should-keyword"><strong>SHOULD</strong></span> use the hash partition strategy for data change events</a></li>
</ul>
</li>
<li><a href="#events-design">20. EVENT Design</a>
<ul class="sectlevel2">
<li><a href="#200"><span class="should-keyword"><strong>SHOULD</strong></span> avoid writing sensitive data to events</a></li>
<li><a href="#214"><span class="must-keyword"><strong>MUST</strong></span> be robust against duplicates when consuming events</a></li>
<li><a href="#212"><span class="should-keyword"><strong>SHOULD</strong></span> design for idempotent out-of-order processing</a></li>
<li><a href="#199"><span class="must-keyword"><strong>MUST</strong></span> ensure that events define useful business resources</a></li>
<li><a href="#205"><span class="should-keyword"><strong>SHOULD</strong></span> ensure that data change events match the APIs resources</a></li>
<li><a href="#209"><span class="must-keyword"><strong>MUST</strong></span> maintain backwards compatibility for events</a></li>
</ul>
</li>
<li><a href="#appendix-references">Appendix A: References</a>
<ul class="sectlevel2">
<li><a href="#openapi-specification">OpenAPI specification</a></li>
<li><a href="#publications-specifications-and-standards">Publications, specifications and standards</a></li>
<li><a href="#dissertations">Dissertations</a></li>
<li><a href="#books">Books</a></li>
<li><a href="#blogs">Blogs</a></li>
</ul>
</li>
<li><a href="#appendix-tooling">Appendix B: Tooling</a>
<ul class="sectlevel2">
<li><a href="#api-first-integrations">API first integrations</a></li>
<li><a href="#support-libraries">Support libraries</a></li>
</ul>
</li>
<li><a href="#appendix-best-practices">Appendix C: Best practices</a>
<ul class="sectlevel2">
<li><a href="#cursor-based-pagination">Cursor-based pagination in RESTful APIs</a></li>
<li><a href="#optimistic-locking">Optimistic locking in RESTful APIs</a></li>
<li><a href="#handling-compatible-extensions">Handling compatible API extensions</a></li>
</ul>
</li>
<li><a href="#appendix-changelog">Appendix D: Changelog</a>
<ul class="sectlevel2">
<li><a href="#rule-changes">Rule Changes</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="link" href="#introduction">1. Introduction</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Zalando’s software architecture centers around decoupled microservices
that provide functionality via RESTful APIs with a JSON payload. Small
engineering teams own, deploy and operate these microservices in their
AWS (team) accounts. Our APIs express most purely what our systems do,
and are therefore highly valuable business assets. Designing
high-quality, long-lasting APIs has become even more critical for us
since we started developing our new open platform strategy, which
transforms Zalando from an online shop into an expansive fashion
platform. Our strategy emphasizes developing lots of public APIs for our
external business partners to use via third-party applications.</p>
</div>
<div class="paragraph">
<p>With this in mind, we’ve adopted "API First" as one of our key
engineering principles. Microservices development begins with API
definition outside the code and ideally involves ample peer-review
feedback to achieve high-quality APIs. API First encompasses a set of
quality-related standards and fosters a peer review culture including a
lightweight review procedure. We encourage our teams to follow them to
ensure that our APIs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>are easy to understand and learn</p>
</li>
<li>
<p>are general and abstracted from specific implementation and use cases</p>
</li>
<li>
<p>are robust and easy to use</p>
</li>
<li>
<p>have a common look and feel</p>
</li>
<li>
<p>follow a consistent RESTful style and syntax</p>
</li>
<li>
<p>are consistent with other teams’ APIs and our global architecture</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Ideally, all Zalando APIs will look like the same author created them.</p>
</div>
<div class="sect2">
<h3 id="conventions-used-in-these-guidelines"><a class="link" href="#conventions-used-in-these-guidelines">Conventions used in these guidelines</a></h3>
<div class="paragraph">
<p>The requirement level keywords "MUST", "MUST NOT", "REQUIRED", "SHALL",
"SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
"OPTIONAL" used in this document (case insensitive) are to be
interpreted as described in <a href="https://www.ietf.org/rfc/rfc2119.txt">RFC
2119</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="zalando-specific-information"><a class="link" href="#zalando-specific-information">Zalando specific information</a></h3>
<div class="paragraph">
<p>The purpose of our "RESTful API guidelines" is to define standards to
successfully establish "consistent API look and feel" quality. The
<a href="https://api.docs.zalando.net/">API Guild (internal_link)</a>
drafted and owns this document. Teams are responsible to fulfill
these guidelines during API development and are encouraged to contribute
to guideline evolution via pull requests.</p>
</div>
<div class="paragraph">
<p>These guidelines will, to some extent, remain work in progress as our
work evolves, but teams can confidently follow and trust them.</p>
</div>
<div class="paragraph">
<p>In case guidelines are changing, following rules apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>existing APIs don&#8217;t have to be changed, but we recommend it</p>
</li>
<li>
<p>clients of existing APIs have to cope with these APIs based on
outdated rules</p>
</li>
<li>
<p>new APIs have to respect the current guidelines</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Furthermore you should keep in mind that once an API becomes public
externally available, it has to be re-reviewed and changed according to
current guidelines - for sake of overall consistency.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="principles"><a class="link" href="#principles">2. Principles</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="api-design-principles"><a class="link" href="#api-design-principles">API design principles</a></h3>
<div class="paragraph">
<p>Comparing SOA web service interfacing style of SOAP vs. REST, the former
tend to be centered around operations that are usually use-case specific
and specialized. In contrast, REST is centered around business (data)
entities exposed as resources that are identified via URIs and can be
manipulated via standardized CRUD-like methods using different
representations, and hypermedia. RESTful APIs
tend to be less use-case specific and come with less rigid client /
server coupling and are more suitable for an ecosystem of (core) services
providing a platform of APIs to build diverse new business services.
We apply the RESTful web service principles to all kind of application
(micro-) service components, independently from whether they provide
functionality via the internet or intranet.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We prefer REST-based APIs with JSON payloads</p>
</li>
<li>
<p>We prefer systems to be truly RESTful
<sup class="footnote" id="_footnote_fielding-restful">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An important principle for API design and usage is Postel&#8217;s
Law, aka <a href="http://en.wikipedia.org/wiki/Robustness_principle">The
Robustness Principle</a> (see also <a href="https://tools.ietf.org/html/rfc1122">RFC 1122</a>):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Be liberal in what you accept, be conservative in what you send</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Readings:</em> Some interesting reads on the RESTful API design style and service architecture:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Article:
<a href="https://www.thoughtworks.com/insights/blog/rest-api-design-resource-modeling">REST API Design - Resource Modeling</a></p>
</li>
<li>
<p>Article:
<a href="https://martinfowler.com/articles/richardsonMaturityModel.html">Richardson Maturity Model&#8201;&#8212;&#8201;Steps toward the glory of REST</a></p>
</li>
<li>
<p>Book:
<a href="https://www.amazon.de/Irresistible-APIs-Designing-that-developers/dp/1617292559">Irresistible
APIs: Designing web APIs that developers will love</a></p>
</li>
<li>
<p>Book:
<a href="http://www.amazon.de/REST-Practice-Hypermedia-Systems-Architecture/dp/0596805829">REST
in Practice: Hypermedia and Systems Architecture</a></p>
</li>
<li>
<p>Book: <a href="https://leanpub.com/build-apis-you-wont-hate">Build APIs You
Won&#8217;t Hate</a></p>
</li>
<li>
<p>Fielding Dissertation:
<a href="http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm">Architectural
Styles and the Design of Network-Based Software Architectures</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="api-as-a-product"><a class="link" href="#api-as-a-product">API as a product</a></h3>
<div class="paragraph">
<p>As mentioned above, Zalando is transforming from an online shop into an
expansive fashion platform comprising a rich set of products following a
Software as a Platform (SaaP) model for our business partners. As a
company we want to deliver products to our (internal and external)
customers which can be consumed like a service.</p>
</div>
<div class="paragraph">
<p>Platform products provide their functionality via (public) APIs; hence,
the design of our APIs should be based on the API as a Product
principle:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Treat your API as product and act like a product owner</p>
</li>
<li>
<p>Put yourself into the place of your customers; be an advocate for
their needs</p>
</li>
<li>
<p>Emphasize simplicity, comprehensibility, and usability of APIs to
make them irresistible for client engineers</p>
</li>
<li>
<p>Actively improve and maintain API consistency over the long term</p>
</li>
<li>
<p>Make use of customer feedback and provide service level support</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Embracing 'API as a Product' facilitates a service ecosystem, which can
be evolved more easily and used to experiment quickly with new business
ideas by recombining core capabilities.
It makes the difference between agile, innovative product service
business built on a platform of APIs and ordinary enterprise integration business
where APIs are provided as "appendix" of existing products to support system integration
and optimised for local server-side realization.</p>
</div>
<div class="paragraph">
<p>Understand the concrete use cases of your customers and carefully check
the trade-offs of your API design variants with a product mindset. Avoid short-term
implementation optimizations at the expense of unnecessary client side
obligations, and have a high attention on API quality and client
developer experience.</p>
</div>
<div class="paragraph">
<p>API as a Product is closely related to our <a href="#100">API First principle</a>
(see next chapter) which is more focused on how we engineer high quality APIs.</p>
</div>
</div>
<div class="sect2">
<h3 id="api-first"><a class="link" href="#api-first">API first</a></h3>
<div class="paragraph">
<p>API First is one of our
<a href="https://github.com/zalando/engineering-principles">engineering
and architecture principles</a>. In a nutshell API First requires two
aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>define APIs first, before coding its implementation, using a standard specification
language</p>
</li>
<li>
<p>get early review feedback from peers and client developers</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By defining APIs outside the code, we want to facilitate early review
feedback and also a development discipline that focus service interface
design on&#8230;&#8203;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>profound understanding of the domain and required functionality</p>
</li>
<li>
<p>generalized business entities / resources, i.e. avoidance of use case
specific APIs</p>
</li>
<li>
<p>clear separation of WHAT vs. HOW concerns, i.e. abstraction from
implementation aspects — APIs should be stable even if we replace
complete service implementation including its underlying technology
stack</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Moreover, API definitions with standardized specification format also
facilitate&#8230;&#8203;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>single source of truth for the API specification; it is a crucial part
of a contract between service provider and client users</p>
</li>
<li>
<p>infrastructure tooling for API discovery, API GUIs, API documents,
automated quality checks</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Elements of API First are also this API Guidelines and a standardized
API review process as to get early review feedback from
peers and client developers. Peer review is important for us to get high
quality APIs, to enable architectural and design alignment and to
supported development of client applications decoupled from service
provider engineering life cycle.</p>
</div>
<div class="paragraph">
<p>It is important to learn, that API First is <strong>not in conflict with the
agile development principles</strong> that we love. Service applications should
evolve incrementally — and so its APIs. Of course, our API specification
will and should evolve iteratively in different cycles; however, each
starting with draft status and <em>early</em> team and peer review feedback.
API may change and profit from implementation concerns and automated
testing feedback. API evolution during development life cycle may
include breaking changes for not yet productive features and as long as
we have aligned the changes with the clients. Hence, API First does
<em>not</em> mean that you must have 100% domain and requirement understanding
and can never produce code before you have defined the complete API and
get it confirmed by peer review.</p>
</div>
<div class="paragraph">
<p>On the other hand, API First obviously is in conflict with the bad
practice of publishing API definition and asking for peer review after
the service integration or even the service productive operation has
started. It is crucial to request and get early feedback — as early as
possible, but not before the API changes are comprehensive with focus
to the next evolution step and have a certain quality (including API
Guideline compliance), already confirmed via team internal reviews.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="general-guidelines"><a class="link" href="#general-guidelines">3. General guidelines</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The titles are marked with the corresponding labels: <span class="must-keyword"><strong>MUST</strong></span>,
<span class="should-keyword"><strong>SHOULD</strong></span>, <span class="may-keyword"><strong>MAY</strong></span>.</p>
</div>
<div class="sect2">
<h3 id="100"><a class="link" href="#100"><span class="must-keyword"><strong>MUST</strong></span> follow API first principle</a></h3>
<div class="paragraph">
<p>You must follow the <a href="#api-first">API First Principle</a>, more specifically:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You must define APIs first, before coding its implementation, <a href="#101">using
OpenAPI as specification language</a></p>
</li>
<li>
<p>You must design your APIs consistently with these guidelines; use our
<a href="https://zally.zalando.net/">API Linter Service (internal_link)</a>
for automated rule checks.</p>
</li>
<li>
<p>You must call for early review feedback from peers and client developers, and apply
<a href="https://api.docs.zalando.net/howto/request-review/">our lightweight API review process (internal_link)</a>
for all component external APIs, i.e. all apis
with <code>x-api-audience =/= component-internal</code> (see <a href="#219"><span class="must-keyword"><strong>MUST</strong></span> provide API audience</a>).</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="101"><a class="link" href="#101"><span class="must-keyword"><strong>MUST</strong></span> provide API specification using OpenAPI</a></h3>
<div class="paragraph">
<p>We use the <a href="http://swagger.io/specification/">OpenAPI specification</a> as standard
to define API specification files. API designers are required to provide the API
specification using a single <strong>self-contained YAML</strong> file to improve readability.
We encourage to use <strong>OpenAPI 3.0</strong> version, but still support <strong>OpenAPI 2.0</strong>
(a.k.a. Swagger 2).</p>
</div>
<div class="paragraph">
<p>The API specification files should be subject to version control using a source
code management system - best together with the implementing sources.</p>
</div>
<div class="paragraph">
<p>You <a href="#192">must / should publish</a> the component <a href="#219">external / internal</a>
API specification with the deployment of the implementing service, and, hence,
make it discoverable for the group via our <a href="https://apis.zalando.net/">API Portal (internal_link)</a>.</p>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> A good way to explore <strong>OpenAPI 3.0/2.0</strong> is to navigate through the
<a href="https://openapi-map.apihandyman.io/">OpenAPI specification mind map</a> and use
our <a href="https://plugins.jetbrains.com/search?search=swagger+Monte">Swagger Plugin
for IntelliJ IDEA</a> to create your first API. To explore and validate/evaluate
existing APIs the <a href="https://editor.swagger.io/">Swagger Editor</a> or our
<a href="https://apis.zalando.net">API Portal</a> may be a good starting point.</p>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> We do not yet provide guidelines for <a href="https://graphql.org/">GraphQL</a>
and focus on resource oriented HTTP/REST API style (and related tooling
and infrastructure support).
Following our <a href="https://techradar.zalando.net/languages/graphql.html">Zalando Tech Radar (internal_link)</a>, we think
that GraphQL has no major benefits, but a couple of downsides compared to REST
as API technology for general purpose peer-to-peer microservice communication.
However, GraphQL can provide a lot of value for specific target domain problems,
especially backends for frontends (BFF) and mobile clients, where typically
many (domain object) resources from different services are queried and
multiple roundtrip overhead should be avoided due to (mobile or public)
network constraints. Therefore we list both technologies on ADOPT, though
GraphQL only supplements REST for the BFF-specific problem domain.</p>
</div>
</div>
<div class="sect2">
<h3 id="102"><a class="link" href="#102"><span class="should-keyword"><strong>SHOULD</strong></span> provide API user manual</a></h3>
<div class="paragraph">
<p>In addition to the API Specification, it is good practice to provide an API
user manual to improve client developer experience, especially of engineers
that are less experienced in using this API. A helpful API user manual
typically describes the following API aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>API scope, purpose, and use cases</p>
</li>
<li>
<p>concrete examples of API usage</p>
</li>
<li>
<p>edge cases, error situation details, and repair hints</p>
</li>
<li>
<p>architecture context and major dependencies - including figures and
sequence flows</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The user manual must be published online, e.g. via our documentation hosting
platform service, GHE pages, or specific team web servers. Please do not forget
to include a link to the API user manual into the API specification using the
<code>#/externalDocs/url</code> property.</p>
</div>
</div>
<div class="sect2">
<h3 id="103"><a class="link" href="#103"><span class="must-keyword"><strong>MUST</strong></span> write APIs using U.S. English</a></h3>

</div>
<div class="sect2">
<h3 id="234"><a class="link" href="#234"><span class="must-keyword"><strong>MUST</strong></span> only use durable and immutable remote references</a></h3>
<div class="paragraph">
<p>Normally, API specification files must be <strong>self-contained</strong>, i.e. files
should not contain references to local or remote content, e.g. <code>../fragment.yaml#/element</code> or
<code>$ref: 'https://github.com/zalando/zally/blob/master/server/src/main/resources/api/zally-api.yaml#/schemas/LintingRequest'</code>.
The reason is, that the content referred to is <em>in general</em> <strong>not durable</strong> and
<strong>not immutable</strong>. As a consequence, the semantic of an API may change in
unexpected ways. (For example, the second link is already outdated due to code restructuring.)</p>
</div>
<div class="paragraph">
<p>However, you may use remote references to resources accessible by the following
service URLs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="https://infrastructure-api-repository.zalandoapis.com/" class="bare">https://infrastructure-api-repository.zalandoapis.com/</a> (internal_link)</code> <b>–</b> used
to refer to user-defined, immutable API specification revisions published via the
internal API repository.</p>
</li>
<li>
<p><code><a href="https://opensource.zalando.com/restful-api-guidelines/{model.yaml}" class="bare">https://opensource.zalando.com/restful-api-guidelines/{model.yaml}</a></code> <b>–</b> used
to refer to guideline-defined re-usable API fragments (see <code>{model.yaml}</code> files in
<a href="https://github.com/zalando/restful-api-guidelines/tree/main/models">restful-api-guidelines/models</a>
for details).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> The formerly used remote references to the <code>Problem</code> API fragment
(aliases <code><a href="https://opensource.zalando.com/problem/" class="bare">https://opensource.zalando.com/problem/</a></code> and
<code><a href="https://zalando.github.io/problem/" class="bare">https://zalando.github.io/problem/</a></code>) are deprecated, but still supported for
compatibility (<a href="#176"><span class="must-keyword"><strong>MUST</strong></span> support problem JSON</a> on how to replace).</p>
</div>
<div class="paragraph">
<p>As we control these URLs, we ensure that their content is <strong>durable</strong> and
<strong>immutable</strong>. This allows to define API specifications by using fragments
published via these sources, as suggested in <a href="#151"><span class="must-keyword"><strong>MUST</strong></span> specify success and error responses</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="meta-information"><a class="link" href="#meta-information">4. REST Basics - Meta information</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="218"><a class="link" href="#218"><span class="must-keyword"><strong>MUST</strong></span> contain API meta information</a></h3>
<div class="paragraph">
<p>API specifications must contain the following OpenAPI meta information
to allow for API management:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>#/info/title</code> as (unique) identifying, functional descriptive name of the API</p>
</li>
<li>
<p><code>#/info/version</code> to distinguish API specifications versions following
<a href="#116">semantic rules</a></p>
</li>
<li>
<p><code>#/info/description</code> containing a proper description of the API</p>
</li>
<li>
<p><code>#/info/contact/{name,url,email}</code> containing the responsible team</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Following OpenAPI extension properties <strong>must</strong> be provided in addition:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>#/info/x-api-id</code> unique identifier of the API (<a href="#215">see rule 215</a>)</p>
</li>
<li>
<p><code>#/info/x-audience</code> intended target audience of the API (<a href="#219">see rule 219</a>)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="116"><a class="link" href="#116"><span class="must-keyword"><strong>MUST</strong></span> use semantic versioning</a></h3>
<div class="paragraph">
<p>OpenAPI allows to specify the API specification version in
<code>#/info/version</code>. To share a common semantic of version information we
expect API designers to comply to <a href="http://semver.org/spec/v2.0.0.html">
Semantic Versioning 2.0</a> rules <code>1</code> to <code>8</code> and <code>11</code> restricted to the format
&lt;MAJOR&gt;.&lt;MINOR&gt;.&lt;PATCH&gt; for versions as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Increment the <strong>MAJOR</strong> version when you make incompatible API changes
after having aligned the changes with consumers,</p>
</li>
<li>
<p>Increment the <strong>MINOR</strong> version when you add new functionality in a
backwards-compatible manner, and</p>
</li>
<li>
<p>Optionally increment the <strong>PATCH</strong> version when you make
backwards-compatible bug fixes or editorial changes not affecting the
functionality.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Additional Notes:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Pre-release</strong> versions (<a href="http://semver.org#spec-item-9">rule 9</a>) and
<strong>build metadata</strong> (<a href="http://semver.org#spec-item-10">rule 10</a>) must not
be used in API version information.</p>
</li>
<li>
<p>While patch versions are useful for fixing typos etc, API designers
are free to decide whether they increment it or not.</p>
</li>
<li>
<p>API designers should consider to use API version <code>0.y.z</code>
(<a href="http://semver.org/#spec-item-4">rule 4</a>) for initial API design.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">openapi</span>: <span class="string"><span class="content">3.0.1</span></span>
<span class="key">info</span>:
  <span class="key">title</span>: <span class="string"><span class="content">Parcel Service API</span></span>
  <span class="key">description</span>: <span class="string"><span class="content">API for &lt;...&gt;</span></span>
  <span class="key">version</span>: <span class="string"><span class="content">1.3.7</span></span>
  <span class="error">&lt;...&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="215"><a class="link" href="#215"><span class="must-keyword"><strong>MUST</strong></span> provide API identifiers</a></h3>
<div class="paragraph">
<p>Each API specification must be provisioned with a globally unique and
immutable API identifier. The API identifier is defined in the <code>info</code>-block
of the OpenAPI specification and must conform to the following definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">/info/x-api-id</span>:
  <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
  <span class="key">format</span>: <span class="string"><span class="content">urn</span></span>
  <span class="key">pattern</span>: <span class="string"><span class="content">^[a-z0-9][a-z0-9-:.]{6,62}[a-z0-9]$</span></span>
  <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
    Mandatory globally unique and immutable API identifier. The API
    id allows to track the evolution and history of an API specification
    as a sequence of versions.</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>API specifications will evolve and any aspect of an OpenAPI specification
may change. We require API identifiers because we want  to support API clients
and providers with API lifecycle management features, like change trackability
and history or automated backward compatibility checks. The immutable API
identifier allows the identification of all API specification versions of an
API evolution. By using  <a href="#116">API semantic version information</a> or <a href="#192">API publishing date</a> as order criteria you get the <strong>version</strong> or
<strong>publication history</strong> as a sequence of API specifications.</p>
</div>
<div class="paragraph">
<p><strong>Note</strong>: While it is nice to use human readable API identifiers based on
self-managed URNs, it is recommend to stick to a UUID (freshly generated when
first creating the API) to relief API designers from any urge of changing
the API identifier while evolving the API. <strong>Do not copy an API unless you
immediately change the API identifier in it!</strong></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">openapi</span>: <span class="string"><span class="content">3.0.1</span></span>
<span class="key">info</span>:
  <span class="key">x-api-id</span>: <span class="string"><span class="content">d0184f38-b98d-11e7-9c56-68f728c1ba70</span></span>
  <span class="key">title</span>: <span class="string"><span class="content">Parcel Service API</span></span>
  <span class="key">description</span>: <span class="string"><span class="content">API for &lt;...&gt;</span></span>
  <span class="key">version</span>: <span class="string"><span class="content">1.5.8</span></span>
  <span class="error">&lt;...&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="219"><a class="link" href="#219"><span class="must-keyword"><strong>MUST</strong></span> provide API audience</a></h3>
<div class="paragraph">
<p>Each API must be classified with respect to the intended target <strong>audience</strong>
supposed to consume the API, to facilitate differentiated standards on APIs
for discoverability, changeability, quality of design and documentation, as
well as permission granting. We differentiate the following API audience
groups with clear organisational and legal boundaries:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>component-internal</strong></dt>
<dd>
<p>This is often referred to as a <em>team internal API</em> or a <em>product internal API</em>.
The API consumers with this audience are restricted to applications of the
same <strong>functional component</strong> which typically represents a specific <strong>product</strong>
with clear functional scope and ownership.
All services of a functional component / product are owned by a specific dedicated owner
and engineering team(s). Typical examples of component-internal APIs are APIs
being used by internal helper and worker services or that support service operation.</p>
</dd>
<dt class="hdlist1"><strong>business-unit-internal</strong></dt>
<dd>
<p>The API consumers with this audience are restricted to applications of a
specific product portfolio owned by the same business unit.</p>
</dd>
<dt class="hdlist1"><strong>company-internal</strong></dt>
<dd>
<p>The API consumers with this audience are restricted to applications owned
by the business units of the same the company (e.g. Zalando company with
Zalando SE, Zalando Payments SE &amp; Co. KG. etc.)</p>
</dd>
<dt class="hdlist1"><strong>external-partner</strong></dt>
<dd>
<p>The API consumers with this audience are restricted to applications of
business partners of the company owning the API and the company itself.</p>
</dd>
<dt class="hdlist1"><strong>external-public</strong></dt>
<dd>
<p>APIs with this audience can be accessed by anyone with Internet access.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Note:</strong> a smaller audience group is intentionally included in the wider group
and thus does not need to be declared additionally.</p>
</div>
<div class="paragraph">
<p>The API audience is provided as API meta information in the <code>info</code>-block of
the OpenAPI specification and must conform to the following specification:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">/info/x-audience</span>:
  <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
  <span class="key">x-extensible-enum</span>:
    - <span class="string"><span class="content">component-internal</span></span>
    - <span class="string"><span class="content">business-unit-internal</span></span>
    - <span class="string"><span class="content">company-internal</span></span>
    - <span class="string"><span class="content">external-partner</span></span>
    - <span class="string"><span class="content">external-public</span></span>
  <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
    Intended target audience of the API. Relevant for standards around
    quality of design and documentation, reviews, discoverability,
    changeability, and permission granting.</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> Exactly <strong>one audience</strong> per API specification is allowed. For this
reason a smaller audience group is intentionally included in the wider group
and thus does not need to be declared additionally. If parts of your API have
a different target audience, we recommend to split API specifications along
the target audience — even if this creates redundancies
(<a href="https://apis.zalando.net/redirect/85ee93a3-7a78-4461-8bf1-08ffdaebcd18">rationale (internal_link)</a>).</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">openapi</span>: <span class="string"><span class="content">3.0.1</span></span>
<span class="key">info</span>:
  <span class="key">x-audience</span>: <span class="string"><span class="content">company-internal</span></span>
  <span class="key">title</span>: <span class="string"><span class="content">Parcel Helper Service API</span></span>
  <span class="key">description</span>: <span class="string"><span class="content">API for &lt;...&gt;</span></span>
  <span class="key">version</span>: <span class="string"><span class="content">1.2.4</span></span>
  <span class="error">&lt;...&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For details and more information on audience groups see the
<a href="https://apis.zalando.net/redirect/85ee93a3-7a78-4461-8bf1-08ffdaebcd18">API Audience narrative (internal_link)</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="223"><a class="link" href="#223"><span class="must-keyword"><strong>MUST</strong></span>/<span class="should-keyword"><strong>SHOULD</strong></span>/<span class="may-keyword"><strong>MAY</strong></span> use functional naming schema</a></h3>
<div class="paragraph">
<p>Functional naming is a powerful, yet easy way to align global resources as
<em>host</em>, <em>permission</em>, and <em>event names</em> within an application landscape. It
helps to preserve uniqueness of names while giving readers meaningful context
information about the addressed component. Besides, the most important aspect
is, that it allows to keep APIs stable in the case of technical and
organizational changes (Zalando for example maintains an internal naming convention).</p>
</div>
<div class="paragraph">
<p>A unique <code>functional-name</code> is assigned to each functional component serving an API.
It is built of the domain name of the functional group the component is belonging
to and a unique a short identifier for the functional component itself:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bnf">&lt;functional-name&gt;      ::= &lt;functional-domain&gt;-&lt;functional-component&gt;
&lt;functional-domain&gt;    ::= [a-z][a-z0-9-]* -- managed functional group of components
&lt;functional-component&gt; ::= [a-z][a-z0-9-]* -- name of API owning functional component</code></pre>
</div>
</div>
<div class="paragraph">
<p>Depending on the <a href="#219">API audience</a>, you <strong>must/should/may</strong> follow the functional
naming schema for <a href="#224">hostnames</a> and <a href="#213">event names</a>
(and also <a href="#225">permission names</a>, in future) as follows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Functional Naming</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Audience</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>must</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">external-public, external-partner</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>should</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">company-internal, business-unit-internal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>may</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">component-internal</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Please see the following rules for detailed functional naming patterns:
* <a href="#224"><span class="must-keyword"><strong>MUST</strong></span> follow naming convention for hostnames</a>
* <a href="#213"><span class="must-keyword"><strong>MUST</strong></span> follow naming convention for event type names</a></p>
</div>
<div class="paragraph">
<p><strong>Internal Guideance</strong>:  You <em>must</em> use the simple
<a href="https://github.bus.zalan.do/team-architecture/functional-component-registry">functional name registry (internal_link)</a>
to register your functional name before using
it. The registry is a centralized infrastructure service to ensure uniqueness
of your functional names (and available domains&#8201;&#8212;&#8201;including subdomains) and
to support hostname DNS resolution.<br>
<em>Hint:</em> Due to lexicalic restrictions of DNS names there is no specific separator
to split a functional name into (sub) domain and component; this knowledge is only
managed in the registry.</p>
</div>
</div>
<div class="sect2">
<h3 id="224"><a class="link" href="#224"><span class="must-keyword"><strong>MUST</strong></span> follow naming convention for hostnames</a></h3>
<div class="paragraph">
<p>Hostnames in APIs must, respectively should conform to the functional naming
depending on the <a href="#219">audience</a> as follows (see <a href="#223"><span class="must-keyword"><strong>MUST</strong></span>/<span class="should-keyword"><strong>SHOULD</strong></span>/<span class="may-keyword"><strong>MAY</strong></span> use functional naming schema</a> for details and
<code>&lt;functional-name&gt;</code> definition):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bnf">&lt;hostname&gt;             ::= &lt;functional-hostname&gt; | &lt;application-hostname&gt;

&lt;functional-hostname&gt;  ::= &lt;functional-name&gt;.zalandoapis.com</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> The following convention (e.g. used by legacy STUPS infrastructure) is deprecated
and <strong>only</strong> allowed for hostnames of <a href="#219">component-internal</a> APIs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bnf">&lt;application-hostname&gt; ::= &lt;application-id&gt;.&lt;organization-unit&gt;.zalan.do
&lt;application-id&gt;       ::= [a-z][a-z0-9-]*  -- application identifier
&lt;organization-id&gt;      ::= [a-z][a-z0-9-]*  -- organization unit identifier, e.g. team identifier</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Exception:</strong> There are legacy hostnames used for APIs with <code>external-partner</code> audience
which may not follow this rule due to backward compatibility constraints.
The API Linter maintains an allow-list for these exceptions (including e.g.
<code>api.merchants.zalando.com</code> and <code>api-sandbox.merchants.zalando.com</code>).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="security"><a class="link" href="#security">5. REST Basics - Security</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="104"><a class="link" href="#104"><span class="must-keyword"><strong>MUST</strong></span> secure endpoints</a></h3>
<div class="paragraph">
<p>Every API endpoint must be protected and armed with authentication and authorization.
As part of the API definition you must specify how you protect your API using
either the <code>http</code> typed <code>bearer</code> or <code>oauth2</code> typed security schemes defined in the
<a href="https://swagger.io/docs/specification/authentication/">OpenAPI Authentication Specification</a>.</p>
</div>
<div class="paragraph">
<p>The majority of our APIs (especially the company internal APIs) are protected
using JWT tokens provided by the platform IAM token service. In these situations
you should use the <code>http</code> typed
<a href="https://swagger.io/docs/specification/authentication/bearer-authentication/">Bearer Authentication</a>
security scheme&#8201;&#8212;&#8201;it is based on OAuth2.0 <a href="https://tools.ietf.org/html/rfc6750">RFC 6750</a> defining the standard header
<code>Auhorization: Bearer &lt;token&gt;</code>.
The following code snippet shows how to define the bearer security scheme.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">components</span>:
  <span class="key">securitySchemes</span>:
    <span class="key">BearerAuth</span>:
      <span class="key">type</span>: <span class="string"><span class="content">http</span></span>
      <span class="key">scheme</span>: <span class="string"><span class="content">bearer</span></span>
      <span class="key">bearerFormat</span>: <span class="string"><span class="content">JWT</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The bearer security schema can then be applied to all API endpoints, e.g. requiring
the token to have <code>api-repository.read</code> scope for permission as follows (see
also <a href="#105"><span class="must-keyword"><strong>MUST</strong></span> define and assign permissions (scopes)</a>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">security</span>:
  - <span class="string"><span class="content">BearerAuth: [ api-repository.read ]</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In other, more specific situations e.g. with customer and partner facing APIs you
may use other OAuth 2.0 authorization flows as defined by <a href="https://tools.ietf.org/html/rfc6749">RFC 6749</a>.
Please consult the
<a href="https://swagger.io/docs/specification/authentication/oauth2/">OpenAPI OAuth 2.0 Authentication</a>
section for details on how to define <code>oauth2</code> typed security schemes correctly.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> Do not use OpenAPI <code>oauth2</code> typed security scheme flows (e.g. <code>implicit</code>)
if your service does not fully support it and implements a simple bearer token scheme,
because it exposes authentication server address details and may make use of redirection.</p>
</div>
</div>
<div class="sect2">
<h3 id="105"><a class="link" href="#105"><span class="must-keyword"><strong>MUST</strong></span> define and assign permissions (scopes)</a></h3>
<div class="paragraph">
<p>Endpoints must be equipped with permissions, if they require client authorization for protection
since e.g. data is exposed that is classified as <code>orange</code> or <code>red</code> according to Zalando&#8217;s
<a href="https://drive.google.com/file/d/1UPB0UbZP7IvcB52DVWQX41pmB7ugJdAX/view">Data Classification Group Policy (internal link)</a>.
Please refer to <a href="#225"><span class="must-keyword"><strong>MUST</strong></span> follow the naming convention for permissions (scopes)</a> for designing permission names.
Some API endpoints may not require specific permissions for authorization e.g.
in case of (i) authorization is <em>not</em> needed for the endpoint since all
exposed data is classified as <code>green</code> or <code>yellow</code>,
or in case of (ii) the specific authorization is provided differently on
the individual object level. In these situations, however, you must make
it explicit by assigning the <code>uid</code> pseudo permission, which is always
available as OAuth2 default scope for all clients in Zalando.</p>
</div>
<div class="paragraph">
<p>The defined permissions are assigned to each API endpoint based on the
security schema (see example in <a href="#104">previous section</a>) by specifying the
<a href="https://github.com/OAI/OpenAPI-Specification/blob/main/versions/2.0.md#securityRequirementObject">security requirement</a>
as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">paths</span>:
 <span class="error">/business-partners/{partner-id}</span>:
    <span class="key">get</span>:
      <span class="key">summary</span>: <span class="string"><span class="content">Retrieves information about a business partner</span></span>
      <span class="key">security</span>:
        - <span class="string"><span class="content">BearerAuth: [ business-partner-service.read ]</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> Following a minimal API specification approach, the
<code>Authorization</code>-header does not need to be defined on each API endpoint, since
it is required and so to say implicitly defined via the security section.</p>
</div>
</div>
<div class="sect2">
<h3 id="225"><a class="link" href="#225"><span class="must-keyword"><strong>MUST</strong></span> follow the naming convention for permissions (scopes)</a></h3>
<div class="paragraph">
<p>As long as the <a href="#223">functional naming</a> is not yet supported by our permission registry,
permission names in APIs must conform to the following naming pattern:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bnf">&lt;permission&gt; ::= &lt;standard-permission&gt; |  -- should be sufficient for majority of use cases
                 &lt;resource-permission&gt; |  -- for special security access differentiation use cases
                 &lt;pseudo-permission&gt;      -- used to explicitly indicate that access is not restricted

&lt;standard-permission&gt; ::= &lt;application-id&gt;.&lt;access-mode&gt;
&lt;resource-permission&gt; ::= &lt;application-id&gt;.&lt;resource-name&gt;.&lt;access-mode&gt;
&lt;pseudo-permission&gt;   ::= uid

&lt;application-id&gt;      ::= [a-z][a-z0-9-]*  -- application identifier
&lt;resource-name&gt;       ::= [a-z][a-z0-9-]*  -- free resource identifier
&lt;access-mode&gt;         ::= read | write    -- might be extended in future</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> This naming convention only applies to scopes for service-to-service
communication using the Platform IAM tokens. For IAM systems with other naming
rules (e.g. Zalando Partner IAM), the naming should be consistent with the
existing conventions of those systems.</p>
</div>
<div class="paragraph">
<p>The permission naming schema corresponds to the naming schema for <a href="#224">hostnames</a> and <a href="#213">event type names</a>, and typical examples are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 20%;">
<col style="width: 15%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Application ID</th>
<th class="tableblock halign-left valign-top">Resource ID</th>
<th class="tableblock halign-left valign-top">Access Type</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>order-management</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sales-order</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>read</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>order-management.sales-order.read</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>order-management</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>shipment-order</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>read</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>order-management.shipment-order.read</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fulfillment-order</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>write</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fulfillment-order.write</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>business-partner-service</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>read</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>business-partner-service.read</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Note:</strong> APIs should stick to component specific permissions without resource
extension to avoid the complexity of too many fine grained permissions. For the
majority of use cases, restricting access for specific API endpoints using read
or write is sufficient.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="data-formats"><a class="link" href="#data-formats">6. REST Basics - Data formats</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="238"><a class="link" href="#238"><span class="must-keyword"><strong>MUST</strong></span> use standard data formats</a></h3>
<div class="paragraph">
<p><a href="https://github.com/OAI/OpenAPI-Specification/blob/main/versions/3.1.0.md#data-types">Open API</a>
(based on <a href="https://tools.ietf.org/html/draft-bhutton-json-schema-validation-00#section-7.3">JSON Schema Validation vocabulary</a>)
defines formats from ISO and IETF standards for date/time, integers/numbers and binary data.
You <strong>must</strong> use these formats, whenever applicable:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>OpenAPI type</code></th>
<th class="tableblock halign-left valign-top"><code>OpenAPI format</code></th>
<th class="tableblock halign-left valign-top">Specification</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>integer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int32</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 byte signed integer between -2<sup>31</sup> and 2<sup>31</sup>-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>7721071004</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>integer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int64</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8 byte signed integer between -2<sup>63</sup> and 2<sup>63</sup>-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>772107100456824</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>integer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bigint</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">arbitrarily large signed integer number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>77210710045682438959</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>float</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>binary32</code> single precision decimal number&#8201;&#8212;&#8201;see <a href="https://en.wikipedia.org/wiki/IEEE_754">IEEE 754-2008/ISO 60559:2011</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3.1415927</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>double</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>binary64</code> double precision decimal number&#8201;&#8212;&#8201;see <a href="https://en.wikipedia.org/wiki/IEEE_754">IEEE 754-2008/ISO 60559:2011</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3.141592653589793</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>decimal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">arbitrarily precise signed decimal number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3.141592653589793238462643383279</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>byte</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>base64url</code> encoded byte following <a href="https://tools.ietf.org/html/rfc7493#section-4.4">RFC 7493 Section 4.4</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"VA=="</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>binary</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>base64url</code> encoded byte sequence following <a href="https://tools.ietf.org/html/rfc7493#section-4.4">RFC 7493 Section 4.4</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"VGVzdA=="</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc3339">RFC 3339</a> internet profile&#8201;&#8212;&#8201;subset of <a href="https://tools.ietf.org/html/rfc3339#ref-ISO8601">ISO 8601</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"2019-07-30"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date-time</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc3339">RFC 3339</a> internet profile&#8201;&#8212;&#8201;subset of <a href="https://tools.ietf.org/html/rfc3339#ref-ISO8601">ISO 8601</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"2019-07-30T06:43:40.252Z"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>time</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc3339">RFC 3339</a> internet profile&#8201;&#8212;&#8201;subset of <a href="https://tools.ietf.org/html/rfc3339#ref-ISO8601">ISO 8601</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"06:43:40.252Z"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>duration</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc3339">RFC 3339</a> internet profile&#8201;&#8212;&#8201;subset of <a href="https://tools.ietf.org/html/rfc3339#ref-ISO8601">ISO 8601</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"P1DT30H4S"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>period</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc3339">RFC 3339</a> internet profile&#8201;&#8212;&#8201;subset of <a href="https://tools.ietf.org/html/rfc3339#ref-ISO8601">ISO 8601</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"2019-07-30T06:43:40.252Z/PT3H"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>password</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"secret"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>email</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc5322">RFC 5322</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"<a href="mailto:example@zalando.de">example@zalando.de</a>"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>idn-email</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc6531">RFC 6531</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"hello@bücher.example"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hostname</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc1034">RFC 1034</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"www.zalando.de"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>idn-hostname</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc5890">RFC 5890</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"bücher.example"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ipv4</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc2673">RFC 2673</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"104.75.173.179"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ipv6</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc4291">RFC 4291</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"2600:1401:2::8a"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>uri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc3986">RFC 3986</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"https://www.zalando.de/"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>uri-reference</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc3986">RFC 3986</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"/clothing/"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>uri-template</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc6570">RFC 6570</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"/users/{id}"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>iri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc3987">RFC 3987</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"https://bücher.example/"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>iri-reference</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc3987">RFC 3987</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"/damenbekleidung-jacken-mäntel/"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#144"><code>uuid</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc4122">RFC 4122</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"e2ab873e-b295-11e9-9c02-&#8230;&#8203;"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>json-pointer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc6901">RFC 6901</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"/items/0/id"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>relative-json-pointer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/draft-handrews-relative-json-pointer">Relative JSON pointers</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"1/id"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>regex</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">regular expressions as defined in <a href="http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf">ECMA 262</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"^[a-z0-9]+$"</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Note:</strong> Formats <code>bigint</code> and <code>decimal</code> have been added to the OpenAPI defined formats&#8201;&#8212;&#8201;see also <a href="#171"><span class="must-keyword"><strong>MUST</strong></span> define a format for number and integer types</a> and <a href="#169"><span class="must-keyword"><strong>MUST</strong></span> use standard formats for date and time properties</a> below.</p>
</div>
<div class="paragraph">
<p>We add further OpenAPI formats that are useful especially in an e-commerce environment
e.g. <code>language code</code>, <code>country code</code>, and <code>currency</code> based other ISO and IETF standards.
You <strong>must</strong> use these formats, whenever applicable:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>OpenAPI type</code></th>
<th class="tableblock halign-left valign-top"><code>format</code></th>
<th class="tableblock halign-left valign-top">Specification</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>iso-639-1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">two letter language code&#8201;&#8212;&#8201;see <a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes">ISO 639-1</a>. Hint: In the past we used <code>iso-639</code> as format.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"en"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bcp47</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">multi letter language tag&#8201;&#8212;&#8201;see <a href="https://tools.ietf.org/html/bcp47">BCP 47</a>. It is a compatible extension of <a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes">ISO 639-1</a> optionally with additional information for language usage, like region, variant, script.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"en-DE"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>iso-3166-alpha-2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">two letter country code&#8201;&#8212;&#8201;see <a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">ISO 3166-1 alpha-2</a>. Hint: In the past we used <code>iso-3166</code> as format.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"GB"</code>  <strong>Hint:</strong> It is <code>"GB"</code>, not <code>"UK"</code>, even though <code>"UK"</code> has seen some use at Zalando.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>iso-4217</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">three letter currency code&#8201;&#8212;&#8201;see <a href="https://en.wikipedia.org/wiki/ISO_4217">ISO 4217</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"EUR"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gtin-13</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Global Trade Item Number&#8201;&#8212;&#8201;see <a href="https://en.wikipedia.org/wiki/Global_Trade_Item_Number">GTIN</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"5710798389878"</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Remark:</strong> Please note that this list of standard data formats is not exhaustive
and everyone is encouraged to propose additions.</p>
</div>
</div>
<div class="sect2">
<h3 id="171"><a class="link" href="#171"><span class="must-keyword"><strong>MUST</strong></span> define a format for number and integer types</a></h3>
<div class="paragraph">
<p>In <a href="#238"><span class="must-keyword"><strong>MUST</strong></span> use standard data formats</a> we added <code>bigint</code> and <code>decimal</code> to the OpenAPI defined formats.
As an implication, you must always provide one of the formats <code>int32</code>, <code>int64</code>, <code>bigint</code>
or <code>float</code>, <code>double</code>, <code>decimal</code> when you define an API property of
JSON type <code>number</code> or <code>integer</code>.</p>
</div>
<div class="paragraph">
<p>By this we prevent clients from guessing the precision incorrectly, and thereby
changing the value unintentionally. The precision must be translated by clients
and servers into the most specific language types; in Java, for instance, the <code>number</code>
type with <code>decimal</code> format will translate into <code>BigDecimal</code> and <code>integer</code> type with
<code>int32</code> format will translate to <code>int</code> or <code>Integer</code> Java types.</p>
</div>
<div class="sect3">
<h4 id="239"><a class="link" href="#239"><span class="must-keyword"><strong>MUST</strong></span> encode binary data in <code>base64url</code></a></h4>
<div class="paragraph">
<p>You may expose binary data. You must use a standard media type and data format,
if applicable&#8201;&#8212;&#8201;see <a href="#168">Rule 168</a>. If no standard is available, you must define
the binary data as <code>string</code> typed property with <code>binary</code> format using <code>base64url</code>
encoding&#8201;&#8212;&#8201;as also described in <a href="#238"><span class="must-keyword"><strong>MUST</strong></span> use standard data formats</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="169"><a class="link" href="#169"><span class="must-keyword"><strong>MUST</strong></span> use standard formats for date and time properties</a></h3>
<div class="paragraph">
<p>As a specific case of <a href="#238"><span class="must-keyword"><strong>MUST</strong></span> use standard data formats</a>, you must use the <code>string</code> typed formats
<code>date</code>, <code>date-time</code>, <code>time</code>, <code>duration</code>, or <code>period</code> for the definition of date and time properties.
The formats are based on the standard <a href="https://tools.ietf.org/html/rfc3339">RFC 3339</a> internet profile -- a
subset of <a href="https://tools.ietf.org/html/rfc3339#ref-ISO8601">ISO 8601</a></p>
</div>
<div class="paragraph">
<p>APIs <span class="must-keyword"><strong>MUST</strong></span> use the upper-case <code>T</code> as a separator between date and time and
upper-case <code>Z</code> at the end when generating dates as opposed to lower-case <code>t</code>,
<code>z</code>, space, or any other character. This is stricter than the
<a href="https://datatracker.ietf.org/doc/html/rfc3339#section-5.6">date/time format
as defined in RFC 3339</a>, which leaves it up to the specification.</p>
</div>
<div class="paragraph">
<p><strong>Exception:</strong> For passing date/time information via standard protocol headers,
HTTP <a href="https://tools.ietf.org/html/rfc7231#section-7.1.1.1">RFC 7231</a> requires to
follow the date and time specification used by the Internet Message Format
<a href="https://tools.ietf.org/html/rfc5322">RFC 5322</a>.</p>
</div>
<div class="paragraph">
<p>As defined by the standard, time zone offset may be used, however, we recommend
to only use times based on UTC without local offsets. For example <code>2015-05-28T14:07:17Z</code>
rather than <code>2015-05-28T14:07:17+00:00</code>. From experience we have learned that zone
offsets are not easy to understand and often not correctly handled. Note also that
zone offsets are different from local times which may include daylight saving time.
When it comes to storage, all dates should be consistently stored in UTC without
a zone offset. Localization should be done locally by the services that provide
user interfaces, if required.</p>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> We discourage using numerical timestamps. It typically creates
issues with precision, e.g. whether to represent a timestamp as 1460062925,
1460062925000 or 1460062925.000. Date strings, though more verbose and requiring
more effort to parse, avoid this ambiguity.</p>
</div>
</div>
<div class="sect2">
<h3 id="127"><a class="link" href="#127"><span class="should-keyword"><strong>SHOULD</strong></span> use standard formats for time duration and interval properties</a></h3>
<div class="paragraph">
<p>Properties and that are by design durations and time intervals should be
represented as strings formatted as defined by <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a>
(<a href="https://tools.ietf.org/html/rfc3339#appendix-A">RFC 3339 Appendix A contains a grammar</a> for <code>durations</code>
and <code>periods</code> - the latter called time intervals in <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a>). ISO
8601:1-2019 defines an  extension (<code>..</code>) to express open ended time intervals
that are very convenient in searches and are included in the below
<a href="https://tools.ietf.org/html/rfc2234">ABNF</a> grammar:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="abnf">   dur-second        = 1*DIGIT &quot;S&quot;
   dur-minute        = 1*DIGIT &quot;M&quot; [dur-second]
   dur-hour          = 1*DIGIT &quot;H&quot; [dur-minute]
   dur-time          = &quot;T&quot; (dur-hour / dur-minute / dur-second)
   dur-day           = 1*DIGIT &quot;D&quot;
   dur-week          = 1*DIGIT &quot;W&quot;
   dur-month         = 1*DIGIT &quot;M&quot; [dur-day]
   dur-year          = 1*DIGIT &quot;Y&quot; [dur-month]
   dur-date          = (dur-day / dur-month / dur-year) [dur-time]
   duration          = &quot;P&quot; (dur-date / dur-time / dur-week)

   period-explicit   = iso-date-time &quot;/&quot; iso-date-time
   period-start      = iso-date-time &quot;/&quot; (duration / &quot;..&quot;)
   period-end        = (duration / &quot;..&quot;) &quot;/&quot; iso-date-time
   period            = period-explicit / period-start / period-end</code></pre>
</div>
</div>
<div class="paragraph">
<p>A time interval query parameters should use <code>&lt;time-property&gt;_between</code> instead
of the parameter tuple <code>&lt;time-property&gt;_before</code>/<code>&lt;time-property&gt;_after</code>, while
properties providing a time interval should be named <code>&lt;time-property&gt;_interval</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="170"><a class="link" href="#170"><span class="must-keyword"><strong>MUST</strong></span> use standard formats for country, language and currency properties</a></h3>
<div class="paragraph">
<p>As a specific case of <a href="#238"><span class="must-keyword"><strong>MUST</strong></span> use standard data formats</a> you must use the following standard formats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Country codes: <a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">ISO 3166-1-alpha-2</a> two letter country
codes indicated via format <code>iso-3166-alpha-2</code> in the OpenAPI specification.</p>
</li>
<li>
<p>Language codes: <a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes">ISO 639-1</a> two letter language codes indicated
via format <code>iso-639-1</code> in the OpenAPI specification.</p>
</li>
<li>
<p>Language variant tags: <a href="https://tools.ietf.org/html/bcp47">BCP 47</a> multi letter language tag indicated
via format <code>bcp47</code> in the OpenAPI specification. (It is a compatible extension
of <a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes">ISO 639-1</a> with additional optional information for language
usage, like region, variant, script)</p>
</li>
<li>
<p>Currency codes:  <a href="https://en.wikipedia.org/wiki/ISO_4217">ISO 4217</a> three letter currency codes indicated
via format <code>iso-4217</code> in the OpenAPI specification.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="244"><a class="link" href="#244"><span class="should-keyword"><strong>SHOULD</strong></span> use content negotiation, if clients may choose from different resource representations</a></h3>
<div class="paragraph">
<p>In some situations the API supports serving different representations of a
specific resource (at the same URL), e.g. JSON, PDF, TEXT, or HTML
representations for an invoice resource. You should use
<a href="https://en.wikipedia.org/wiki/Content_negotiation">content negotiation</a> to
support clients specifying via the standard HTTP headers <a href="https://tools.ietf.org/html/rfc9110#section-12.5.1"><code>Accept</code></a>,
<a href="https://tools.ietf.org/html/rfc9110#section-12.5.4"><code>Accept-Language</code></a>, <a href="https://tools.ietf.org/html/rfc9110#section-12.5.3"><code>Accept-Encoding</code></a> which representation is best suited for
their use case, for example, which language of a document, representation /
content format, or content encoding. You <a href="#172"><span class="should-keyword"><strong>SHOULD</strong></span> use standard media types</a> like <code>application/json</code> or
<code>application/pdf</code> for defining the content format in the <a href="https://tools.ietf.org/html/rfc9110#section-12.5.1"><code>Accept</code></a> header.</p>
</div>
</div>
<div class="sect2">
<h3 id="144"><a class="link" href="#144"><span class="should-keyword"><strong>SHOULD</strong></span> only use UUIDs if necessary</a></h3>
<div class="paragraph">
<p>Generating IDs can be a scaling problem in high frequency and near real time
use cases. UUIDs solve this problem, as they can be generated without
collisions in a distributed, non-coordinated way and without additional server
round trips.</p>
</div>
<div class="paragraph">
<p>However, they also come with some disadvantages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>pure technical key without meaning; not ready for naming or name scope
conventions that might be helpful for pragmatic reasons, e.g. we learned to
use names for product attributes, instead of UUIDs</p>
</li>
<li>
<p>less usable, because&#8230;&#8203;</p>
<div class="ulist">
<ul>
<li>
<p>cannot be memorized and easily communicated by humans</p>
</li>
<li>
<p>harder to use in debugging and logging analysis</p>
</li>
<li>
<p>less convenient for consumer facing usage</p>
</li>
</ul>
</div>
</li>
<li>
<p>quite long: readable representation requires 36 characters and comes with
higher memory and bandwidth consumption</p>
</li>
<li>
<p>not ordered along their creation history and no indication of used id volume</p>
</li>
<li>
<p>may be in conflict with additional backward compatibility support of legacy ids</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>UUIDs should be avoided when not needed for large scale id generation. Instead,
for instance, server side support with id generation can be preferred (<a href="#post"><code>POST</code></a>
on id resource, followed by idempotent <a href="#put"><code>PUT</code></a> on entity resource). Usage of
UUIDs is especially discouraged as primary keys of master and configuration
data, like brand-ids or attribute-ids which have low id volume but widespread
steering functionality.</p>
</div>
<div class="paragraph">
<p>Please be aware that sequential, strictly monotonically increasing numeric
identifiers may reveal critical, confidential business information, like order
volume, to non-privileged clients.</p>
</div>
<div class="paragraph">
<p>In any case, we should always use string rather than number type for
identifiers. This gives us more flexibility to evolve the identifier naming
scheme. Accordingly, if used as identifiers, UUIDs should not be qualified
using a format property.</p>
</div>
<div class="paragraph">
<p>Hint: Usually, random UUID is used - see UUID version 4 in <a href="https://tools.ietf.org/html/rfc4122">RFC 4122</a>.
Though UUID version 1 also contains leading timestamps it is not reflected by
its lexicographic sorting. This deficit is addressed by
<a href="https://github.com/alizain/ulid">ULID</a> (Universally Unique Lexicographically
Sortable Identifier). You may favour ULID instead of UUID, for instance, for
pagination use cases ordered along creation time.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="urls"><a class="link" href="#urls">7. REST Basics - URLs</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Guidelines for naming and designing resource paths and query parameters.</p>
</div>
<div class="sect2">
<h3 id="135"><a class="link" href="#135"><span class="should-keyword"><strong>SHOULD</strong></span> not use /api as base path</a></h3>
<div class="paragraph">
<p>In most cases, all resources provided by a service are part of the
public API, and therefore should be made available under the root "/"
base path.</p>
</div>
<div class="paragraph">
<p>If the service should also support non-public, internal APIs
— for specific operational support functions, for example — we encourage
you to maintain two different API specifications and provide
<a href="#219">API audience</a>. For both APIs, you should not use <code>/api</code> as base path.</p>
</div>
<div class="paragraph">
<p>We see API&#8217;s base path as a part of deployment variant configuration.
Therefore, this information has to be declared in the
<a href="https://github.com/OAI/OpenAPI-Specification/blob/main/versions/3.0.2.md#server-object">server object</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="134"><a class="link" href="#134"><span class="must-keyword"><strong>MUST</strong></span> pluralize resource names</a></h3>
<div class="paragraph">
<p>Usually, a collection of resource instances is provided (at least the API
should be ready here). The special case of a <em>resource singleton</em> must
be modeled as a collection with cardinality 1 including definition of
<code>maxItems</code> = <code>minItems</code> = 1 for the returned <code>array</code> structure
to make the cardinality constraint explicit.</p>
</div>
<div class="paragraph">
<p><strong>Exception:</strong> the <em>pseudo identifier</em> <code>self</code> used to specify a resource endpoint
where the resource identifier is provided by authorization information (see <a href="#143"><span class="must-keyword"><strong>MUST</strong></span> identify resources and sub-resources via path segments</a>).</p>
</div>
</div>
<div class="sect2">
<h3 id="228"><a class="link" href="#228"><span class="must-keyword"><strong>MUST</strong></span> use URL-friendly resource identifiers</a></h3>
<div class="paragraph">
<p>To simplify encoding of resource IDs in URLs they must match the regex <code>[a-zA-Z0-9:._\-/]*</code>.
Resource IDs only consist of ASCII strings using letters, numbers, underscore, minus, colon,
period, and - on rare occasions - slash.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> slashes are only allowed to build and signal resource identifiers
consisting of <a href="#241">compound keys</a>.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> to prevent ambiguities of <a href="#136">unnormalized paths</a> resource
identifiers must never be empty. Consequently, support of empty strings for
path parameters is forbidden.</p>
</div>
</div>
<div class="sect2">
<h3 id="129"><a class="link" href="#129"><span class="must-keyword"><strong>MUST</strong></span> use kebab-case for path segments</a></h3>
<div class="paragraph">
<p>Path segments are restricted to ASCII kebab-case strings matching regex <code>^[a-z][a-z\-0-9]*$</code>.
The first character must be a lower case letter, and subsequent
characters can be a letter, or a dash(<code>-</code>), or a number.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">/shipment-orders/{shipment-order-id}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> kebab-case applies to concrete path segments and not necessarily the names of path parameters.</p>
</div>
</div>
<div class="sect2">
<h3 id="136"><a class="link" href="#136"><span class="must-keyword"><strong>MUST</strong></span> use normalized paths without empty path segments and trailing slashes</a></h3>
<div class="paragraph">
<p>You must not specify paths with duplicate or trailing slashes, e.g.
<code>/customers//addresses</code> or <code>/customers/</code>. As a consequence, you must also not
specify or use path variables with empty string values.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> Non standard paths have no clear semantics. As a result, behavior
for non standard paths varies between different HTTP infrastructure components
and libraries. This may leads to ambiguous and unexpected results during
request handling and monitoring.</p>
</div>
<div class="paragraph">
<p>We recommend to implement services robust against clients not following this
rule. All services <strong>should</strong> <a href="https://en.wikipedia.org/wiki/URI_normalization">normalize</a>
request paths before processing by removing duplicate and trailing slashes.
Hence, the following requests should refer to the same resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">GET /orders/{order-id}
GET /orders/{order-id}/
GET /orders//{order-id}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> path normalization is not supported by all framework out-of-the-box.
Services are required to support at least the normalized path while rejecting
all alternatives paths, if failing to deliver the same resource.</p>
</div>
</div>
<div class="sect2">
<h3 id="141"><a class="link" href="#141"><span class="must-keyword"><strong>MUST</strong></span> keep URLs verb-free</a></h3>
<div class="paragraph">
<p>The API describes resources, so the only place where actions should appear is
in the HTTP methods. In URLs, use only nouns. Instead of thinking of actions
(verbs), it&#8217;s often helpful to think about putting a message in a letter box:
e.g., instead of having the verb <em>cancel</em> in the url, think of sending a
message to cancel an order to the <em>cancellations</em> letter box on the server
side.</p>
</div>
</div>
<div class="sect2">
<h3 id="138"><a class="link" href="#138"><span class="must-keyword"><strong>MUST</strong></span> avoid actions — think about resources</a></h3>
<div class="paragraph">
<p>REST is all about your resources, so consider the domain entities that take
part in web service interaction, and aim to model your API around these using
the standard HTTP methods as operation indicators. For instance, if an
application has to lock articles explicitly so that only one user may edit
them, create an article lock with <a href="#put"><code>PUT</code></a> or <a href="#post"><code>POST</code></a> instead of using a lock
action.</p>
</div>
<div class="paragraph">
<p>Request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">PUT /article-locks/{article-id}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The added benefit is that you already have a service for browsing and filtering
article locks.</p>
</div>
</div>
<div class="sect2">
<h3 id="140"><a class="link" href="#140"><span class="should-keyword"><strong>SHOULD</strong></span> define <em>useful</em> resources</a></h3>
<div class="paragraph">
<p>As a rule of thumb resources should be defined to cover 90% of all its client&#8217;s
use cases. A <em>useful</em> resource should contain as much information as necessary,
but as little as possible. A great way to support the last 10% is to allow
clients to specify their needs for more/less information by supporting
filtering and <a href="#157">embedding</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="142"><a class="link" href="#142"><span class="must-keyword"><strong>MUST</strong></span> use domain-specific resource names</a></h3>
<div class="paragraph">
<p>API resources represent elements of the application’s domain model. Using
domain-specific nomenclature for resource names helps developers to understand
the functionality and basic semantics of your resources. It also reduces the
need for further documentation outside the API definition. For example,
"sales-order-items" is superior to "order-items" in that it clearly indicates
which business object it represents. Along these lines, "items" is too general.</p>
</div>
</div>
<div class="sect2">
<h3 id="139"><a class="link" href="#139"><span class="should-keyword"><strong>SHOULD</strong></span> model complete business processes</a></h3>
<div class="paragraph">
<p>An API should contain the complete business processes containing all resources
representing the process. This enables clients to understand the business
process, foster a consistent design of the business process, allow for
synergies from description and implementation perspective, and eliminates
implicit invisible dependencies between APIs.</p>
</div>
<div class="paragraph">
<p>In addition, it prevents services from being designed as thin wrappers around
databases, which normally tends to shift business logic to the clients.</p>
</div>
</div>
<div class="sect2">
<h3 id="143"><a class="link" href="#143"><span class="must-keyword"><strong>MUST</strong></span> identify resources and sub-resources via path segments</a></h3>
<div class="paragraph">
<p>Some API resources may contain or reference sub-resources. Embedded
sub-resources, which are not top-level resources, are parts of a higher-level
resource and cannot be used outside of its scope. Sub-resources should be
referenced by their name and identifier in the path segments as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">/resources/{resource-id}/sub-resources/{sub-resource-id}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to improve the consumer experience, you should aim for intuitively
understandable URLs, where each sub-path is a valid reference to a resource or
a set of resources. For instance, if
<code>/partners/{partner-id}/addresses/{address-id}</code> is valid, then, in principle,
also <code>/partners/{partner-id}/addresses</code>, <code>/partners/{partner-id}</code> and
<code>/partners</code> must be valid. Examples of concrete url paths:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">/shopping-carts/de:1681e6b88ec1/items/1
/shopping-carts/de:1681e6b88ec1
/content/images/9cacb4d8
/content/images</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> resource identifiers may be build of multiple other resource
identifiers (see <a href="#241"><span class="may-keyword"><strong>MAY</strong></span> expose compound keys as resource identifiers</a>).</p>
</div>
<div class="paragraph">
<p><strong>Exception:</strong> In some situations the resource identifier is not passed as a
path segment but  via the authorization information, e.g. an authorization
token or session cookie. Here, it is reasonable to use <strong><code>self</code></strong> as
<em>pseudo-identifier</em> path segment. For instance, you may define <code>/employees/self</code>
or <code>/employees/self/personal-details</code> as resource paths&#8201;&#8212;&#8201; and may additionally
define endpoints that support identifier passing in the resource path, like
define <code>/employees/{empl-id}</code> or <code>/employees/{empl-id}/personal-details</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="241"><a class="link" href="#241"><span class="may-keyword"><strong>MAY</strong></span> expose compound keys as resource identifiers</a></h3>
<div class="paragraph">
<p>If a resource is best identified by a <em>compound key</em> consisting of multiple
other resource identifiers, it is allowed to reuse the compound key in its
natural form containing slashes instead of <em>technical</em> resource identifier in
the resource path without violating the above rule <a href="#143"><span class="must-keyword"><strong>MUST</strong></span> identify resources and sub-resources via path segments</a> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">/resources/{compound-key-1}[delim-1]...[delim-n-1]{compound-key-n}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example paths:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">/shopping-carts/{country}/{session-id}
/shopping-carts/{country}/{session-id}/items/{item-id}
/api-specifications/{docker-image-id}/apis/{path}/{file-name}
/api-specifications/{repository-name}/{artifact-name}:{tag}
/article-size-advices/{sku}/{sales-channel}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note</strong>: Exposing a compound key as described above limits ability to
evolve the structure of the resource identifier as it is no longer opaque.</p>
</div>
<div class="paragraph">
<p>To compensate for this drawback, APIs must apply a compound key abstraction
consistently in all requests and responses parameters and attributes allowing
consumers to treat these as <em>technical resource identifier</em> replacement. The
use of independent compound key components must be limited to search and
creation requests, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http"># compound key components passed as independent search query parameters
GET /article-size-advices?skus=sku-1,sku-2&amp;sales_channel_id=sid-1
=&gt; { &quot;items&quot;: [{ &quot;id&quot;: &quot;id-1&quot;, ...  },{ &quot;id&quot;: &quot;id-2&quot;, ...  }] }

# opaque technical resource identifier passed as path parameter
GET /article-size-advices/id-1
=&gt; { &quot;id&quot;: &quot;id-1&quot;, &quot;sku&quot;: &quot;sku-1&quot;, &quot;sales_channel_id&quot;: &quot;sid-1&quot;, &quot;size&quot;: ... }

# compound key components passed as mandatory request fields
POST /article-size-advices { &quot;sku&quot;: &quot;sku-1&quot;, &quot;sales_channel_id&quot;: &quot;sid-1&quot;, &quot;size&quot;: ... }
=&gt; { &quot;id&quot;: &quot;id-1&quot;, &quot;sku&quot;: &quot;sku-1&quot;, &quot;sales_channel_id&quot;: &quot;sid-1&quot;, &quot;size&quot;: ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where <code>id-1</code> is representing the opaque provision of the compound key
<code>sku-1/sid-1</code> as technical resource identifier.</p>
</div>
<div class="paragraph">
<p><strong>Remark:</strong> A compound key component may itself be used as another resource
identifier providing another resource endpoint, e.g <code>/article-size-advices/{sku}</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="145"><a class="link" href="#145"><span class="may-keyword"><strong>MAY</strong></span> consider using (non-) nested URLs</a></h3>
<div class="paragraph">
<p>If a sub-resource is only accessible via its parent resource and may not exist
without parent resource, consider using a nested URL structure, for instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">/shoping-carts/de/1681e6b88ec1/cart-items/1</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, if the resource can be accessed directly via its unique id, then the
API should expose it as a top-level resource. For example, customer has a
collection for sales orders; however, sales orders have globally unique id and
some services may choose to access the orders directly, for instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">/customers/1637asikzec1
/sales-orders/5273gh3k525a</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="146"><a class="link" href="#146"><span class="should-keyword"><strong>SHOULD</strong></span> limit number of resource types</a></h3>
<div class="paragraph">
<p>To keep maintenance and service evolution manageable, we should follow
"functional segmentation" and "separation of concern" design principles and do
not mix different business functionalities in same API definition. In practice
this means that the number of resource types exposed via an API should be
limited. In this context a resource type is defined as a set of highly related
resources such as a collection, its members and any direct sub-resources.</p>
</div>
<div class="paragraph">
<p>For example, the resources below would be counted as three resource types, one
for customers, one for the addresses, and one for the customers' related
addresses:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">/customers
/customers/{id}
/customers/{id}/preferences
/customers/{id}/addresses
/customers/{id}/addresses/{addr}
/addresses
/addresses/{addr}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We consider <code>/customers/<a href="#id"><code>id</code></a>/preferences</code> part of the <code>/customers</code> resource
type because it has a one-to-one relation to the customer without an
additional identifier.</p>
</li>
<li>
<p>We consider <code>/customers</code> and <code>/customers/<a href="#id"><code>id</code></a>/addresses</code> as separate resource
types because <code>/customers/<a href="#id"><code>id</code></a>/addresses/{addr}</code> also exists with an
additional identifier for the address.</p>
</li>
<li>
<p>We consider <code>/addresses</code> and <code>/customers/<a href="#id"><code>id</code></a>/addresses</code> as separate resource
types because there&#8217;s no reliable way to be sure they are the same.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Given this definition, our experience is that well defined APIs involve no more
than 4 to 8 resource types. There may be exceptions with more complex business
domains that require more resources, but you should first check if you can
split them into separate subdomains with distinct APIs.</p>
</div>
<div class="paragraph">
<p>Nevertheless one API should hold all necessary resources to model complete
business processes helping clients to understand these flows.</p>
</div>
</div>
<div class="sect2">
<h3 id="147"><a class="link" href="#147"><span class="should-keyword"><strong>SHOULD</strong></span> limit number of sub-resource levels</a></h3>
<div class="paragraph">
<p>There are main resources (with root url paths) and sub-resources (or <em>nested</em>
resources with non-root urls paths). Use sub-resources if their life cycle is
(loosely) coupled to the main resource, i.e. the main resource works as
collection resource of the subresource entities. You should use &#8656; 3
sub-resource (nesting) levels&#8201;&#8212;&#8201;more levels increase API complexity and url
path length. (Remember, some popular web browsers do not support URLs of more
than 2000 characters.)</p>
</div>
</div>
<div class="sect2">
<h3 id="130"><a class="link" href="#130"><span class="must-keyword"><strong>MUST</strong></span> use snake_case (never camelCase) for query parameters</a></h3>
<div class="paragraph">
<p>See also <a href="#118"><span class="must-keyword"><strong>MUST</strong></span> property names must be snake_case (and never camelCase)</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="137"><a class="link" href="#137"><span class="must-keyword"><strong>MUST</strong></span> stick to conventional query parameters</a></h3>
<div class="paragraph">
<p>If you provide query support for searching, sorting, filtering, and
paginating, you must stick to the following naming conventions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="q"></a><a href="#q"><code>q</code></a>: default query parameter, e.g. used by browser tab completion;
should have an entity specific alias, e.g. sku.</p>
</li>
<li>
<p><a id="sort"></a><a href="#sort"><code>sort</code></a>: comma-separated list of fields (as defined by <a href="#154"><span class="must-keyword"><strong>MUST</strong></span> define collection format of header and query parameters</a>) to
define the sort order. To indicate sorting direction, fields may be prefixed
with <code>+</code> (ascending) or <code>-</code> (descending), e.g. /sales-orders?sort=+id.</p>
</li>
<li>
<p><a id="fields"></a><a href="#fields"><code>fields</code></a>: field name expression to retrieve only a subset of fields
of a resource. See <a href="#157"><span class="should-keyword"><strong>SHOULD</strong></span> support partial responses via filtering</a> below.</p>
</li>
<li>
<p><a id="embed"></a><a href="#embed"><code>embed</code></a>: field name expression to expand or embedded sub-entities,
e.g. inside of an article entity, expand silhouette code into the silhouette
object. Implementing <a href="#embed"><code>embed</code></a> correctly is difficult, so do it with care.
See <a href="#158"><span class="should-keyword"><strong>SHOULD</strong></span> allow optional embedding of sub-resources</a> below.</p>
</li>
<li>
<p><a id="offset"></a><a href="#offset"><code>offset</code></a>: numeric offset of the first element provided on a page
representing a collection request. See <a href="#pagination">REST Design - Pagination</a> section below.</p>
</li>
<li>
<p><a id="cursor"></a><a href="#cursor"><code>cursor</code></a>: an opaque pointer to a page, never to be inspected or
constructed by clients. It usually (encrypted) encodes the page position,
i.e. the identifier of the first or last page element, the pagination
direction, and the applied query filters to recreate the collection. See
<a href="#cursor-based-pagination">Cursor-based pagination in RESTful APIs</a> or <a href="#pagination">REST Design - Pagination</a> section below.</p>
</li>
<li>
<p><a id="limit"></a><a href="#limit"><code>limit</code></a>: client suggested limit to restrict the number of entries on
a page. See <a href="#pagination">REST Design - Pagination</a> section below.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="json-guidelines"><a class="link" href="#json-guidelines">8. REST Basics - JSON payload</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>These guidelines provides recommendations for defining JSON data at Zalando.
JSON here refers to <a href="https://tools.ietf.org/html/rfc7159">RFC 7159</a> (which updates <a href="https://tools.ietf.org/html/rfc4627">RFC 4627</a>),
the "application/json" media type and custom JSON media types defined for APIs.
The guidelines clarifies some specific cases to allow Zalando JSON data to have
an idiomatic form across teams and services.</p>
</div>
<div class="sect2">
<h3 id="167"><a class="link" href="#167"><span class="must-keyword"><strong>MUST</strong></span> use JSON as payload data interchange format</a></h3>
<div class="paragraph">
<p>Use JSON (<a href="https://tools.ietf.org/html/rfc7159">RFC 7159</a>) to represent structured (resource) data passed
with HTTP requests and responses as body payload. The JSON payload must use a
JSON object as top-level data structure (if possible) to allow for future
extension. This also applies to collection resources, where you ad-hoc would
use an array&#8201;&#8212;&#8201;see also <a href="#110"><span class="must-keyword"><strong>MUST</strong></span> always return JSON objects as top-level data structures</a>.</p>
</div>
<div class="paragraph">
<p>Additionally, the JSON payload must comply to the more restrictive Internet
JSON (<a href="https://tools.ietf.org/html/rfc7493">RFC 7493</a>), particularly</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://tools.ietf.org/html/rfc7493#section-2.1">Section 2.1</a> on encoding of characters, and</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc7493#section-2.3">Section 2.3</a> on object constraints.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As a consequence, a JSON payload must</p>
</div>
<div class="ulist">
<ul>
<li>
<p>use <a href="https://tools.ietf.org/html/rfc7493#section-2.1"><code>UTF-8</code> encoding</a></p>
</li>
<li>
<p>consist of <a href="https://tools.ietf.org/html/rfc7493#section-2.1">valid Unicode strings</a>, i.e. must not
contain non-characters or surrogates, and</p>
</li>
<li>
<p>contain only <a href="https://tools.ietf.org/html/rfc7493#section-2.3">unique member names</a> (no duplicate
names).</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="252"><a class="link" href="#252"><span class="should-keyword"><strong>SHOULD</strong></span> design single resource schema for reading and writing</a></h3>
<div class="paragraph">
<p>To simplify API specs and API maintenance, as well as the cognitive load of
developers, endpoints should utilize a common model for reading and writing
the same resource type. The differences between read and write models are best
addressed by</p>
</div>
<div class="ulist">
<ul>
<li>
<p>marking properties <code>writeOnly</code> that are only available in a request, e.g.
passwords, and</p>
</li>
<li>
<p>marking properties <code>readOnly</code> that are only available in a response, e.g.
resource identifiers.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note:</strong> A resource with property marked <code>readOnly</code> in the API according to
the <a href="https://json-schema.org/draft/2020-12/draft-bhutton-json-schema-validation-00#rfc.section.9.4">JSON schema validation</a> may be
ignored or rejected by a server. Both are in line with the idea behind <a href="#109">the compatibility guidance</a>, however, we suggest to document when rejecting
to prevent client side surprises.</p>
</div>
</div>
<div class="sect2">
<h3 id="250"><a class="link" href="#250"><span class="should-keyword"><strong>SHOULD</strong></span> be aware of services not fully supporting JSON/unicode</a></h3>
<div class="paragraph">
<p>JSON payloads passed via API requests consist of valid unicode characters
(see <a href="#167"><span class="must-keyword"><strong>MUST</strong></span> use JSON as payload data interchange format</a>). While <code>\uxxxx</code> are valid characters in a JSON strings, they can
create failures when leaving the API request processing context, e.g. by
writing the data into a database or piping it through command line tools that
are not 100% compatible with the JSON or unicode standard.</p>
</div>
<div class="paragraph">
<p>A prominent example for such a tool is the Postgres database:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Postgres cannot handle <code>\u0000</code> in <code>jsonb</code> and <code>text</code> types (see
<a href="https://www.postgresql.org/docs/current/datatype-json.html">datatype-json</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As a consequence, servers and clients that forward JSON content to other tools
should check that these tools fully support the JSON or unicode standard. If
not, they should reject or sanitize unicode characters not supported by the
tools.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> A sanitization and rejection are actions that change the API
behavior and therefore should be described by the API specification.</p>
</div>
</div>
<div class="sect2">
<h3 id="168"><a class="link" href="#168"><span class="may-keyword"><strong>MAY</strong></span> pass non-JSON media types using data specific standard formats</a></h3>
<div class="paragraph">
<p>Non-JSON media types may be supported, if you stick to a business object specific standard
format for the payload data, for instance, image data format (JPG, PNG, GIF), document
format (PDF, DOC, ODF, PPT), or archive format (TAR, ZIP).</p>
</div>
<div class="paragraph">
<p>Generic structured data interchange formats other than JSON (e.g. XML, CSV)
may be provided, but only additionally to JSON as default format using <a href="#244">content negotiation</a>,
for specific use cases where clients may not interpret the payload structure.</p>
</div>
</div>
<div class="sect2">
<h3 id="172"><a class="link" href="#172"><span class="should-keyword"><strong>SHOULD</strong></span> use standard media types</a></h3>
<div class="paragraph">
<p>You should use standard media types (defined in <a href="https://www.iana.org/assignments/media-types/media-types.xhtml">media type registry</a>
of Internet Assigned Numbers Authority (IANA)) as <code>content-type</code> (or <code>accept</code>) header
information. More specifically, for JSON payload you should use the standard media type
<code>application/json</code> (or <code>application/problem+json</code> for <a href="#176"><span class="must-keyword"><strong>MUST</strong></span> support problem JSON</a>).</p>
</div>
<div class="paragraph">
<p>You should avoid using custom media types like <code>application/x.zalando.article+json</code>.
Custom media types beginning with <code>x</code> bring no advantage compared to the
standard media type for JSON, and make automated processing more difficult.</p>
</div>
<div class="paragraph">
<p><strong>Exception:</strong> Custom media type should be only used in situations where you need to provide
<a href="#114">API endpoint versioning</a> (with content negotiation) due to incompatible changes.</p>
</div>
</div>
<div class="sect2">
<h3 id="120"><a class="link" href="#120"><span class="should-keyword"><strong>SHOULD</strong></span> pluralize array names</a></h3>
<div class="paragraph">
<p>Names of arrays should be pluralized to indicate that they contain multiple values.
This implies in turn that object names should be singular.</p>
</div>
</div>
<div class="sect2">
<h3 id="118"><a class="link" href="#118"><span class="must-keyword"><strong>MUST</strong></span> property names must be snake_case (and never camelCase)</a></h3>
<div class="paragraph">
<p>Property names are restricted to ASCII snake_case strings matching regex <code>^[a-z_][a-z_0-9]*$</code>.
The first character must be a lower case letter, or an underscore, and subsequent
characters can be a letter, an underscore, or a number.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>customer_number, sales_order_number, billing_address</code></pre>
</div>
</div>
<div class="paragraph">
<p>Rationale: No established industry standard exists, but many popular Internet
companies prefer snake_case: e.g. GitHub, Stack Exchange, Twitter.
Others, like Google and Amazon, use both - but not only camelCase. It’s
essential to establish a consistent look and feel such that JSON looks
as if it came from the same hand.</p>
</div>
</div>
<div class="sect2">
<h3 id="240"><a class="link" href="#240"><span class="should-keyword"><strong>SHOULD</strong></span> declare enum values using UPPER_SNAKE_CASE string</a></h3>
<div class="paragraph">
<p>Enumerations should be represented as <code>string</code> typed OpenAPI definitions of
request parameters or model properties.
Enum values (using <code>enum</code> or <a href="#112"><code>x-extensible-enum</code></a>) need to consistently use
the upper-snake case format, e.g. <code>VALUE</code> or <code>YET_ANOTHER_VALUE</code>.
This approach allows to clearly distinguish values from properties or other elements.</p>
</div>
<div class="paragraph">
<p><strong>Exception:</strong> This rule does not apply for case sensitive values sourced from outside
API definition scope, e.g. for language codes from <a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes">ISO 639-1</a>, or when
declaring possible values for a <a href="#137">rule 137</a> [<code>sort</code> parameter].</p>
</div>
</div>
<div class="sect2">
<h3 id="235"><a class="link" href="#235"><span class="should-keyword"><strong>SHOULD</strong></span> name date/time properties with <code>_at</code> suffix</a></h3>
<div class="paragraph">
<p>Dates and date-time properties should end with <code>_at</code> to distinguish them from
boolean properties which otherwise would have very similar or even identical
names:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#created_at"><code>created_at</code></a> rather than <a href="#created"><code>created</code></a>,</p>
</li>
<li>
<p><a href="#modified_at"><code>modified_at</code></a> rather than <a href="#modified"><code>modified</code></a>,</p>
</li>
<li>
<p><code>occurred_at</code> rather than <code>occurred</code>, and</p>
</li>
<li>
<p><code>returned_at</code> rather than <code>returned</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> Use <code>format: date-time</code> (or as <code>format: date</code>) as required in <a href="#238"><span class="must-keyword"><strong>MUST</strong></span> use standard data formats</a>.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> <a href="#created"><code>created</code></a> and <a href="#modified"><code>modified</code></a> were mentioned in an earlier version of the
guideline and are therefore still accepted for APIs that predate this rule.</p>
</div>
</div>
<div class="sect2">
<h3 id="216"><a class="link" href="#216"><span class="should-keyword"><strong>SHOULD</strong></span> define maps using <code>additionalProperties</code></a></h3>
<div class="paragraph">
<p>A "map" here is a mapping from string keys to some other type. In JSON this is
represented as an object, the key-value pairs being represented by property
names and property values. In OpenAPI schema (as well as in JSON schema) they
should be represented using additionalProperties with a schema defining the
value type. Such an object should normally have no other defined properties.</p>
</div>
<div class="paragraph">
<p>The map keys don&#8217;t count as property names in the sense of <a href="#118">rule 118</a>,
and can follow whatever format is natural for their domain. Please document
this in the description of the map object&#8217;s schema.</p>
</div>
<div class="paragraph">
<p>Here is an example for such a map definition (the <code>translations</code> property):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">components</span>:
  <span class="key">schemas</span>:
    <span class="key">Message</span>:
      <span class="key">description</span>:
        <span class="error">A message together with translations in several languages.</span>
      <span class="key">type</span>: <span class="string"><span class="content">object</span></span>
      <span class="key">properties</span>:
        <span class="key">message_key</span>:
          <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
          <span class="key">description</span>: <span class="string"><span class="content">The message key.</span></span>
        <span class="key">translations</span>:
          <span class="key">description</span>:
            <span class="error">The translations of this message into several languages.</span>
            <span class="error">The keys are [IETF BCP-47 language tags](https://tools.ietf.org/html/bcp47).</span>
          <span class="key">type</span>: <span class="string"><span class="content">object</span></span>
          <span class="key">additionalProperties</span>:
            <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
            <span class="key">description</span>:
              <span class="error">the translation of this message into the language identified by the key.</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>An actual JSON object described by this might then look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{ <span class="key"><span class="delimiter">&quot;</span><span class="content">message_key</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">color</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">translations</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">de</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Farbe</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">en-US</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">color</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">en-GB</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">colour</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">eo</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">koloro</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">nl</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">kleur</span><span class="delimiter">&quot;</span></span>
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="123"><a class="link" href="#123"><span class="must-keyword"><strong>MUST</strong></span> use same semantics for <code>null</code> and absent properties</a></h3>
<div class="paragraph">
<p>OpenAPI 3.x allows to mark properties as <code>required</code> and as <code>nullable</code> to
specify whether properties may be absent (<code>{}</code>) or <code>null</code> (<code>{"example":null}</code>).
If a property is defined to be not <code>required</code> and <code>nullable</code> (see
<a href="#required-nullable-row-2">2nd row in Table below</a>), this rule demands
that both cases must be handled in the exact same manner by specification.</p>
</div>
<div class="paragraph">
<p>The following table shows all combinations and whether the examples are
valid:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><span style="font-weight: bold; font-family: Consolas, Liberation Mono, Courier, monospace">required</span></th>
<th class="tableblock halign-left valign-top"><span style="font-weight: bold; font-family: Consolas, Liberation Mono, Courier, monospace">nullable</span></th>
<th class="tableblock halign-left valign-top"><span style="font-weight: bold; font-family: Consolas, Liberation Mono, Courier, monospace">{}</span></th>
<th class="tableblock halign-left valign-top"><span style="font-weight: bold; font-family: Consolas, Liberation Mono, Courier, monospace">{"example":null}</span></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes <a id="required-nullable-row-2"></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>While API designers and implementers may be tempted to assign different
semantics to both cases, we explicitly decide <strong>against</strong> that option, because we
think that any gain in expressiveness is far outweighed by the risk of clients
not understanding and implementing the subtle differences incorrectly.</p>
</div>
<div class="paragraph">
<p>As an example, an API that provides the ability for different users to
coordinate on a time schedule, e.g. a meeting, may have a resource for options
in which every user has to make a <code>choice</code>. The difference between <em>undecided</em>
and <em>decided against any of the options</em> could be modeled as <em>absent</em> and
<code>null</code> respectively. It would be safer to express the <code>null</code> case with a
dedicated <a href="https://en.wikipedia.org/wiki/Null_object_pattern">Null object</a>, e.g.
<code>{}</code> compared to <code>{"id":"42"}</code>.</p>
</div>
<div class="paragraph">
<p>Moreover, many major libraries have somewhere between little to no support for
a <code>null</code>/absent pattern (see
<a href="https://stackoverflow.com/questions/48465005/gson-distinguish-null-value-field-and-missing-field">Gson</a>,
<a href="https://github.com/square/moshi#borrows-from-gson">Moshi</a>,
<a href="https://github.com/FasterXML/jackson-databind/issues/578">Jackson</a>,
<a href="https://developer.ibm.com/articles/j-javaee8-json-binding-3/">JSON-B</a>). Especially
strongly-typed languages suffer from this since a new composite type is required
to express the third state. Nullable <code>Option</code>/<code>Optional</code>/<code>Maybe</code> types could be
used but having nullable references of these types completely contradicts their
purpose.</p>
</div>
<div class="paragraph">
<p>The only exception to this rule is JSON Merge Patch <a href="https://tools.ietf.org/html/rfc7396">RFC 7396</a>) which
uses <code>null</code> to explicitly indicate property deletion while absent properties are
ignored, i.e. not modified.</p>
</div>
</div>
<div class="sect2">
<h3 id="122"><a class="link" href="#122"><span class="must-keyword"><strong>MUST</strong></span> not use <code>null</code> for boolean properties</a></h3>
<div class="paragraph">
<p>Schema based JSON properties that are by design booleans must not be
presented as nulls. A boolean is essentially a closed enumeration of two
values, true and false. If the content has a meaningful null value, we
strongly prefer to replace the boolean with enumeration of named values
or statuses - for example accepted_terms_and_conditions with enumeration values
YES, NO, UNDEFINED.</p>
</div>
</div>
<div class="sect2">
<h3 id="124"><a class="link" href="#124"><span class="should-keyword"><strong>SHOULD</strong></span> not use <code>null</code> for empty arrays</a></h3>
<div class="paragraph">
<p>Empty array values can unambiguously be represented as the empty list, <code>[]</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="174"><a class="link" href="#174"><span class="must-keyword"><strong>MUST</strong></span> use common field names and semantics</a></h3>
<div id="generic-fields" class="paragraph">
<p>You must use common field names and semantics whenever applicable.
Common fields are idiomatic, create consistency across APIs and
support common understanding for API consumers.</p>
</div>
<div class="paragraph">
<p>We define the following common field names:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="id"></a><a href="#id"><code>id</code></a>: the identity of the object. If used, IDs must be opaque strings
and not numbers. IDs are unique within some documented context, are stable
and don&#8217;t change for a given object once assigned, and are never recycled
cross entities.</p>
</li>
<li>
<p><a id="xyz_id"></a><a href="#xyz_id"><code>xyz_id</code></a>: an attribute within one object holding the identifier of
another object must use a name that corresponds to the type of the referenced
object or the relationship to the referenced object followed by <code>_id</code> (e.g.
<code>partner_id</code> not <code>partner_number</code>, or <code>parent_node_id</code> for the reference to a parent
node from a child node, even if both have the type <code>Node</code>).
<strong>Exception</strong>: We use <code>customer_number</code> instead of <code>customer_id</code> for customer facing
identification of customers due to legacy reasons. (Hint: <code>customer_id</code> used to be defined
as internal only, technical integer key, see
<a href="https://apis.zalando.net/redirect/5675b6ec-8934-11ea-929e-68f728c1ba70">Naming Decision: <code>customer_number</code> vs <code>customer_id</code> [internal_link</a>]).</p>
</li>
<li>
<p><a id="etag"></a><a href="#etag"><code>etag</code></a>: the <a href="#etag"><code>etag</code></a> of an <a href="#158">embedded sub-resource</a>. It
typically is used to carry the <a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>ETag</code></a> for subsequent <a href="#put"><code>PUT</code></a>/<a href="#patch"><code>PATCH</code></a> calls
(see <a href="#182"><code>ETag</code></a> and <a href="#etag-in-result-entities"><code>ETags</code> in result entities</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Further common fields are defined in <a href="#235"><span class="should-keyword"><strong>SHOULD</strong></span> name date/time properties with <code>_at</code> suffix</a>.
The following guidelines define standard objects and fields:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#248"><span class="should-keyword"><strong>SHOULD</strong></span> use pagination response page object</a></p>
</li>
<li>
<p><a href="#249"><span class="must-keyword"><strong>MUST</strong></span> use the common address fields</a></p>
</li>
<li>
<p><a href="#173"><span class="must-keyword"><strong>MUST</strong></span> use the common money object</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example JSON schema:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">tree_node</span>:
  <span class="key">type</span>: <span class="string"><span class="content">object</span></span>
  <span class="key">properties</span>:
    <span class="key">id</span>:
      <span class="key">description</span>: <span class="string"><span class="content">the identifier of this node</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
    <span class="key">parent_node_id</span>:
      <span class="key">description</span>: <span class="string"><span class="content">the identifier of the parent node of this node</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
    <span class="key">created_at</span>:
      <span class="key">description</span>: <span class="string"><span class="content">when got this node created</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">format</span>: <span class="string"><span class="content">'date-time'</span></span>
    <span class="key">modified_at</span>:
      <span class="key">description</span>: <span class="string"><span class="content">when got this node last updated</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">format</span>: <span class="string"><span class="content">'date-time'</span></span>
  <span class="key">example</span>:
    <span class="key">id</span>: <span class="string"><span class="content">'123435'</span></span>
    <span class="key">parent_node_id</span>: <span class="string"><span class="content">'534321'</span></span>
    <span class="key">created_at</span>: <span class="string"><span class="content">'2017-04-12T23:20:50.52Z'</span></span>
    <span class="key">modified_at</span>: <span class="string"><span class="content">'2017-04-12T23:20:50.52Z'</span></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="249"><a class="link" href="#249"><span class="must-keyword"><strong>MUST</strong></span> use the common address fields</a></h3>
<div id="address-fields" class="paragraph">
<p>Address structures play a role in different business and use-case
contexts, including country variances. All attributes that relate to
address information must follow the naming and semantics defined
below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">addressee</span>:
  <span class="key">description</span>: <span class="string"><span class="content">a (natural or legal) person that gets addressed</span></span>
  <span class="key">type</span>: <span class="string"><span class="content">object</span></span>
  <span class="key">properties</span>:
    <span class="key">salutation</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        a salutation and/or title used for personal contacts to some
        addressee; not to be confused with the gender information!</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">Mr</span></span>
    <span class="key">first_name</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        given name(s) or first name(s) of a person; may also include the
        middle names.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">Hans Dieter</span></span>
    <span class="key">last_name</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        family name(s) or surname(s) of a person</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">Mustermann</span></span>
    <span class="key">business_name</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        company name of the business organization. Used when a business is
        the actual addressee; for personal shipments to office addresses, use
        `care_of` instead.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">Consulting Services GmbH</span></span>
  <span class="key">required</span>:
    - <span class="string"><span class="content">first_name</span></span>
    - <span class="string"><span class="content">last_name</span></span>

<span class="key">address</span>:
  <span class="key">description</span>:
    <span class="error">an address of a location/destination</span>
  <span class="key">type</span>: <span class="string"><span class="content">object</span></span>
  <span class="key">properties</span>:
    <span class="key">care_of</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        (aka c/o) the person that resides at the address, if different from
        addressee. E.g. used when sending a personal parcel to the
        office /someone else's home where the addressee resides temporarily</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">Consulting Services GmbH</span></span>
    <span class="key">street</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        the full street address including house number and street name</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">Schönhauser Allee 103</span></span>
    <span class="key">additional</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        further details like building name, suite, apartment number, etc.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">2. Hinterhof rechts</span></span>
    <span class="key">city</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        name of the city / locality</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">Berlin</span></span>
    <span class="key">zip</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        zip code or postal code</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">14265</span></span>
    <span class="key">country_code</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        the country code according to
        [iso-3166-1-alpha-2](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2)</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">DE</span></span>
  <span class="key">required</span>:
    - <span class="string"><span class="content">street</span></span>
    - <span class="string"><span class="content">city</span></span>
    - <span class="string"><span class="content">zip</span></span>
    - <span class="string"><span class="content">country_code</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Grouping and cardinality of fields in specific data types may vary based
on the specific use case (e.g. combining addressee and address fields
into a single type when modeling an address label vs distinct addressee
and address types when modeling users and their addresses).</p>
</div>
</div>
<div class="sect2">
<h3 id="173"><a class="link" href="#173"><span class="must-keyword"><strong>MUST</strong></span> use the common money object</a></h3>
<div class="paragraph">
<p>Use the following common money structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">Money</span>:
  <span class="key">type</span>: <span class="string"><span class="content">object</span></span>
  <span class="key">properties</span>:
    <span class="key">amount</span>:
      <span class="key">type</span>: <span class="string"><span class="content">number</span></span>
      <span class="key">description</span>: <span class="string"><span class="delimiter">&gt;</span><span class="content">
        The amount describes unit and subunit of the currency in a single value,
        where the integer part (digits before the decimal point) is for the
        major unit and fractional part (digits after the decimal point) is for
        the minor unit.</span></span>
      <span class="key">format</span>: <span class="string"><span class="content">decimal</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">99.95</span></span>
    <span class="key">currency</span>:
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">description</span>: <span class="string"><span class="content">3 letter currency code as defined by ISO-4217</span></span>
      <span class="key">format</span>: <span class="string"><span class="content">iso-4217</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">EUR</span></span>
  <span class="key">required</span>:
    - <span class="string"><span class="content">amount</span></span>
    - <span class="string"><span class="content">currency</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>APIs are encouraged to include a reference to the global schema for Money.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">SalesOrder</span>:
  <span class="key">properties</span>:
    <span class="key">grand_total</span>:
      <span class="error">$ref</span>: <span class="error">'https://opensource.zalando.com/restful-api-guidelines/models/money-1.0.0.yaml#/Money'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note that APIs have to treat Money as a closed data type, i.e. it&#8217;s not meant to be used in an inheritance hierarchy. That means the following usage is not allowed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">amount</span><span class="delimiter">&quot;</span></span>: <span class="float">19.99</span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">currency</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">EUR</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">discounted_amount</span><span class="delimiter">&quot;</span></span>: <span class="float">9.99</span>
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_cons"><a class="link" href="#_cons">Cons</a></h4>
<div class="ulist">
<ul>
<li>
<p>Violates the <a href="https://en.wikipedia.org/wiki/Liskov_substitution_principle">Liskov Substitution Principle</a></p>
</li>
<li>
<p>Breaks existing library support, e.g. <a href="https://github.com/zalando/jackson-datatype-money">Jackson Datatype Money</a></p>
</li>
<li>
<p>Less flexible since both amounts are coupled together, e.g. mixed currencies are impossible</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A better approach is to favor <a href="https://en.wikipedia.org/wiki/Composition_over_inheritance">composition over inheritance</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">price</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">amount</span><span class="delimiter">&quot;</span></span>: <span class="float">19.99</span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">currency</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">EUR</span><span class="delimiter">&quot;</span></span>
    },
    <span class="key"><span class="delimiter">&quot;</span><span class="content">discounted_price</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">amount</span><span class="delimiter">&quot;</span></span>: <span class="float">9.99</span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">currency</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">EUR</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_pros"><a class="link" href="#_pros">Pros</a></h4>
<div class="ulist">
<ul>
<li>
<p>No inheritance, hence no issue with the substitution principle</p>
</li>
<li>
<p>Makes use of existing library support</p>
</li>
<li>
<p>No coupling, i.e. mixed currencies is an option</p>
</li>
<li>
<p>Prices are now self-describing, atomic values</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_notes"><a class="link" href="#_notes">Notes</a></h4>
<div class="paragraph">
<p>Please be aware that some business cases (e.g. transactions in Bitcoin) call for a higher precision, so applications must be prepared to accept values with unlimited precision, unless explicitly stated otherwise in the API specification.</p>
</div>
<div class="paragraph">
<p>Examples for correct representations (in EUR):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>42.20</code> or <code>42.2</code> = 42 Euros, 20 Cent</p>
</li>
<li>
<p><code>0.23</code> = 23 Cent</p>
</li>
<li>
<p><code>42.0</code> or <code>42</code> = 42 Euros</p>
</li>
<li>
<p><code>1024.42</code> = 1024 Euros, 42 Cent</p>
</li>
<li>
<p><code>1024.4225</code> = 1024 Euros, 42.25 Cent</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Make sure that you don’t convert the "amount" field to <code>float</code> /
<code>double</code> types when implementing this interface in a specific language
or when doing calculations. Otherwise, you might lose precision.
Instead, use exact formats like Java’s
<a href="https://docs.oracle.com/javase/8/docs/api/java/math/BigDecimal.html"><code>BigDecimal</code></a>.
See <a href="http://stackoverflow.com/a/3730040/342852">Stack Overflow</a> for more
info.</p>
</div>
<div class="paragraph">
<p>Some JSON parsers (NodeJS’s, for example) convert numbers to floats by default.
After discussing the pros and cons we’ve decided on "decimal" as our amount
format. It is not a standard OpenAPI format, but should help us to avoid parsing
numbers as float / doubles.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="http-requests"><a class="link" href="#http-requests">9. REST Basics - HTTP requests</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="148"><a class="link" href="#148"><span class="must-keyword"><strong>MUST</strong></span> use HTTP methods correctly</a></h3>
<div class="paragraph">
<p>Be compliant with the standardized HTTP semantics (see <a href="https://tools.ietf.org/html/rfc9110">RFC-9110
"HTTP semantics"</a>) as summarized here.</p>
</div>
<div class="sect3">
<h4 id="get"><a class="link" href="#get">GET</a></h4>
<div class="paragraph">
<p><a href="#get"><code>GET</code></a> requests are used to <strong>read</strong> either a single or a collection resource.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#get"><code>GET</code></a> requests for individual resources will usually generate a <a href="#status-code-404" class="status-code">404</a> (if the
resource does not exist).</p>
</li>
<li>
<p><a href="#get"><code>GET</code></a> requests for collection resources may return either <a href="#status-code-200" class="status-code">200</a> (if the
collection is empty) or <a href="#status-code-404" class="status-code">404</a> (if the collection is missing).</p>
</li>
<li>
<p><a href="#get"><code>GET</code></a> requests must NOT have a request body payload (see <a href="#get-with-body"><code>GET with body</code></a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note:</strong> <a href="#get"><code>GET</code></a> requests on collection resources should provide sufficient
<a href="#137">filter</a> and <a href="#pagination">REST Design - Pagination</a> mechanisms.</p>
</div>
</div>
<div class="sect3">
<h4 id="get-with-body"><a class="link" href="#get-with-body">GET with body payload</a></h4>
<div class="paragraph">
<p>APIs sometimes face the problem, that they have to provide extensive structured
request information with <a href="#get"><code>GET</code></a>, that may conflict with the size limits of
clients, load-balancers, and servers. As we require APIs to be standard conform
(request body payload in <a href="#get"><code>GET</code></a> must be ignored on server side), API designers
have to check the following two options:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#get"><code>GET</code></a> with URL encoded query parameters: when it is possible to encode the
request information in query parameters, respecting the usual size limits of
clients, gateways, and servers, this should be the first choice. The request
information can either be provided via multiple query parameters or by a
single structured URL encoded string.</p>
</li>
<li>
<p><a href="#post"><code>POST</code></a> with body payload content: when a <a href="#get"><code>GET</code></a> with URL encoded query
parameters is not possible, a <a href="#post"><code>POST</code></a> request with body payload must be used,
and explicitly documented with a hint like in the following example:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">paths</span>:
  <span class="key">/products</span>:
    <span class="key">post</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">&gt;</span><span class="content">
        [GET with body payload](https://opensource.zalando.com/restful-api-guidelines/#get-with-body)
        - no resources created: Returns all products matching the query passed
        as request input payload.</span></span>
      <span class="key">requestBody</span>:
        <span class="key">required</span>: <span class="string"><span class="content">true</span></span>
        <span class="key">content</span>:
          <span class="error">...</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> It is no option to encode the lengthy structured request information
using header parameters. From a conceptual point of view, the semantic of an
operation should always be expressed by the resource names, as well as the
involved path and query parameters. In other words by everything that goes into
the URL. Request headers are reserved for general context information (see
<a href="#183"><span class="should-keyword"><strong>SHOULD</strong></span> use only the specified proprietary Zalando headers</a>). In addition, size limits on query parameters and headers are not
reliable and depend on clients, gateways, server, and actual settings. Thus,
switching to headers does not solve the original problem.</p>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> As <a href="#get-with-body"><code>GET with body</code></a> is used to transport extensive query parameters,
the <a href="#cursor"><code>cursor</code></a> cannot any longer be used to encode the query filters in case of
<a href="#160">cursor-based pagination</a>. As a consequence, it is best practice to
transport the query filters in the body payload, while using <a href="#161">pagination
links</a> containing the <a href="#cursor"><code>cursor</code></a> that is only encoding the page position and
direction. To protect the pagination sequence the <a href="#cursor"><code>cursor</code></a> may contain a hash
over all applied query filters (See also <a href="#161"><span class="should-keyword"><strong>SHOULD</strong></span> use pagination links</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="put"><a class="link" href="#put">PUT</a></h4>
<div class="paragraph">
<p><a href="#put"><code>PUT</code></a> requests are used to <strong>update</strong> (and sometimes to create) <strong>entire</strong>
resources – single or collection resources. The semantic is best described
as <em>"please put the enclosed representation at the resource mentioned by
the URL, replacing any existing resource."</em>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#put"><code>PUT</code></a> requests are usually applied to single resources, and not to collection
resources, as this would imply replacing the entire collection.</p>
</li>
<li>
<p><a href="#put"><code>PUT</code></a> requests are usually robust against non-existence of resources by
implicitly creating the resource before updating.</p>
</li>
<li>
<p>On successful <a href="#put"><code>PUT</code></a> requests, the server will <strong>replace the entire resource</strong>
addressed by the URL with the representation passed in the payload.
Subsequent reads will deliver the same payload, plus possibly
server-generated fields like <code>modified_at</code>.</p>
</li>
<li>
<p>Successful <a href="#put"><code>PUT</code></a> requests return <a href="#status-code-200" class="status-code">200</a> or <a href="#status-code-204" class="status-code">204</a> (if the resource was updated&#8201;&#8212;&#8201;with or without returning the resource), <a href="#status-code-201" class="status-code">201</a> (if the resource was newly
created), and <a href="#status-code-202" class="status-code">202</a> (if the request was accepted for asynchronous
processing).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The updated/created resource may be returned as response payload. We recommend,
to not use it per default, but if the resource is enriched with
server-generated fields like <code>version_number</code>. You may also support client side
steering (see <a href="#181"><span class="may-keyword"><strong>MAY</strong></span> consider to support <code>Prefer</code> header to handle processing preferences</a>).</p>
</div>
<div class="paragraph">
<p><strong>Important:</strong> It is good practice to keep the resource identifier management
under control of the service provider and not the client, and, hence, to prefer
<a href="#post"><code>POST</code></a> for creation of (at least top-level) resources, and focus <a href="#put"><code>PUT</code></a> on its
usage for updates. However, in situations where the identifier and all resource
attributes are under control of the client as input for the resource creation
you should use <a href="#put"><code>PUT</code></a> and pass the resource identifier as URL path parameter.
Putting the same resource twice is required to be <a href="#idempotent">idempotent</a> and to result
in the same single resource instance (see <a href="#149"><span class="must-keyword"><strong>MUST</strong></span> fulfill common method properties</a>) without data duplication in
case of repetition.</p>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> To prevent unnoticed concurrent updates and duplicate creations when
using <a href="#put"><code>PUT</code></a>, you <a href="#182"><span class="may-keyword"><strong>MAY</strong></span> consider to support <code>ETag</code> together with <code>If-Match</code>/<code>If-None-Match</code> header</a> to allow the server to react on stricter demands that
expose conflicts and prevent lost updates. See also <a href="#optimistic-locking">Optimistic locking in RESTful APIs</a> for
details and options.</p>
</div>
</div>
<div class="sect3">
<h4 id="post"><a class="link" href="#post">POST</a></h4>
<div class="paragraph">
<p><a href="#post"><code>POST</code></a> requests are idiomatically used to <strong>create</strong> single resources on a
collection resource endpoint, but other semantics on single resources endpoint
are equally possible. The semantic for collection endpoints is best described as
<em>"please add the enclosed representation to the collection resource identified
by the URL"</em>. The semantic for single resource endpoints is best described as
<em>"please execute the given well specified request on the resource identified by
the URL"</em>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Successful <a href="#post"><code>POST</code></a> requests on a collection endpoint will create one or more
resource instances.</p>
</li>
<li>
<p>For single resources, you <span class="should-keyword"><strong>SHOULD</strong></span> return <a href="#status-code-201" class="status-code">201</a> and the new resource object
(including the resource identifier) in the response payload.</p>
<div class="ulist">
<ul>
<li>
<p>The client <span class="should-keyword"><strong>SHOULD</strong></span> be able to use this resource identifier to <a href="#get"><code>GET</code></a> the
resource if supported by the API (see <a href="#143"><span class="must-keyword"><strong>MUST</strong></span> identify resources and sub-resources via path segments</a>).</p>
</li>
<li>
<p>The URL to <a href="#get"><code>GET</code></a> the resource <span class="should-keyword"><strong>SHOULD</strong></span> be provided in the <a href="https://tools.ietf.org/html/rfc9110#section-10.2.2"><code>Location</code></a> header.</p>
</li>
<li>
<p>If the response does not contain the created resource or a resource monitor,
the status code <span class="should-keyword"><strong>SHOULD</strong></span> be <a href="#status-code-201" class="status-code">201</a> and the URL to <a href="#get"><code>GET</code></a> the resource <span class="must-keyword"><strong>MUST</strong></span> be
provided in the <a href="https://tools.ietf.org/html/rfc9110#section-10.2.2"><code>Location</code></a> response header.</p>
</li>
<li>
<p>If the <a href="#post"><code>POST</code></a> is <a href="#idempotent">idempotent</a>, the status code <span class="should-keyword"><strong>SHOULD</strong></span> be <a href="#status-code-201" class="status-code">201</a> if the
resource was created and <a href="#status-code-200" class="status-code">200</a> or <a href="#status-code-204" class="status-code">204</a> if the resource was updated.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The resource identifier <span class="must-keyword"><strong>MUST NOT</strong></span> be passed as request body data by the client,
  but created and maintained by the service.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>For multiple resources you <span class="should-keyword"><strong>SHOULD</strong></span> return <a href="#status-code-201" class="status-code">201</a> in the response, as long as
they are created atomically, meaning that either all the resources are created
or none of them are.</p>
<div class="ulist">
<ul>
<li>
<p>You <a href="#152"><span class="must-keyword"><strong>MUST</strong></span> use code 207 for batch or bulk requests</a> if the request can partially fail, that is some of the resources
can fail to be created.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Posting the same resource twice is <strong>not</strong> required to be <a href="#idempotent">idempotent</a>
(check <a href="#149"><span class="must-keyword"><strong>MUST</strong></span> fulfill common method properties</a>) and may result in multiple resources. However, you <a href="#229"><span class="should-keyword"><strong>SHOULD</strong></span> consider to design <code>POST</code> and <code>PATCH</code> idempotent</a> to prevent
this.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>You <a href="#253"><span class="may-keyword"><strong>MAY</strong></span> support asynchronous request processing</a>, where the resource creation would not finish by the time the
request is delivered, so the response status code <span class="should-keyword"><strong>SHOULD</strong></span> be <a href="#status-code-202" class="status-code">202</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Apart from resource creation, <a href="#post"><code>POST</code></a> should be also used for scenarios that
cannot be covered by the other methods sufficiently. However, in such cases
make sure to document the fact that <a href="#post"><code>POST</code></a> is used as a workaround (see e.g.
<a href="#get-with-body"><code>GET with body</code></a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="patch"><a class="link" href="#patch">PATCH</a></h4>
<div class="paragraph">
<p><a href="#patch"><code>PATCH</code></a> method extends HTTP via <a href="https://tools.ietf.org/html/rfc5789">RFC-5789</a> standard to update parts
of the resource objects where e.g. in contrast to <a href="#put"><code>PUT</code></a> only a specific subset
of resource fields should be changed. The set of changes is represented in a
format called a <em>patch document</em> passed as payload and identified by a specific
media type. The semantic is best described as <em>"please change the resource
identified by the URL according to my patch document"</em>. The syntax and
semantics of the patch document is not defined in <a href="https://tools.ietf.org/html/rfc5789">RFC-5789</a> and must
be described in the API specification by using specific media types.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#patch"><code>PATCH</code></a> requests are usually applied to single resources as patching entire
collection is challenging.</p>
</li>
<li>
<p><a href="#patch"><code>PATCH</code></a> requests are usually not robust against non-existence of resource
instances.</p>
</li>
<li>
<p>On successful <a href="#patch"><code>PATCH</code></a> requests, the server will update parts of the resource
addressed by the URL as defined by the change request in the payload.</p>
</li>
<li>
<p>Successful <a href="#patch"><code>PATCH</code></a> requests return <a href="#status-code-200" class="status-code">200</a> or <a href="#status-code-204" class="status-code">204</a> (if the resource was
updated&#8201;&#8212;&#8201;with or without returning the resource), and <a href="#status-code-202" class="status-code">202</a> (if the request
was accepted for asynchronous processing).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note:</strong> since implementing <a href="#patch"><code>PATCH</code></a> correctly is a bit tricky, we strongly
suggest to choose one and only one of the following patterns per endpoint
(unless forced by a <a href="#106">backwards compatible change</a>). In preference order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use <a href="#put"><code>PUT</code></a> with complete objects to update a resource as long as feasible
(i.e. do not use <a href="#patch"><code>PATCH</code></a> at all).
<strong>Note:</strong> this choice by the API server imposes additional requirements on
the client (<a href="#108"><span class="must-keyword"><strong>MUST</strong></span> prepare clients to accept compatible API extensions</a>) which can be implemented e.g. in Java following the
practice <a href="#handling-compatible-extensions">Handling compatible API extensions</a>.</p>
</li>
<li>
<p>Use <a href="#patch"><code>PATCH</code></a> with <a href="https://tools.ietf.org/html/rfc7396">JSON Merge Patch</a> standard, a
specialized media type <code>application/merge-patch+json</code> for partial
resource representation to update parts of resource objects.</p>
</li>
<li>
<p>Use <a href="#patch"><code>PATCH</code></a> with <a href="https://tools.ietf.org/html/rfc6902">JSON Patch</a> standard, a specialized media type
<code>application/json-patch+json</code> that includes instructions on how to change
the resource.</p>
</li>
<li>
<p>Use <a href="#post"><code>POST</code></a> (with a proper description of what is happening) instead of
<a href="#patch"><code>PATCH</code></a>, if the request does not modify the resource in a way defined by
the semantics of the standard media types above.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In practice <a href="https://tools.ietf.org/html/rfc7396">JSON Merge Patch</a> quickly turns out to be too limited,
especially when trying to update single objects in large collections (as part
of the resource). In this case <a href="https://tools.ietf.org/html/rfc6902">JSON Patch</a> is more powerful while
still showing readable patch requests (see also
<a href="http://erosb.github.io/post/json-patch-vs-merge-patch">JSON patch vs. merge</a>).
JSON Patch supports changing of array elements identified via its index, but
not via (key) fields of the elements as typically needed for collections.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> Patching the same resource twice is <strong>not</strong> required to be <a href="#idempotent">idempotent</a>
(check <a href="#149"><span class="must-keyword"><strong>MUST</strong></span> fulfill common method properties</a>) and may result in a changing result. However, you <a href="#229"><span class="should-keyword"><strong>SHOULD</strong></span> consider to design <code>POST</code> and <code>PATCH</code> idempotent</a> to
prevent this.</p>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> To prevent unnoticed concurrent updates when using <a href="#patch"><code>PATCH</code></a> you <a href="#182"><span class="may-keyword"><strong>MAY</strong></span> consider to support <code>ETag</code> together with <code>If-Match</code>/<code>If-None-Match</code> header</a>
to allow the server to react on stricter demands that expose conflicts and
prevent lost updates. See <a href="#optimistic-locking">Optimistic locking in RESTful APIs</a> and <a href="#229"><span class="should-keyword"><strong>SHOULD</strong></span> consider to design <code>POST</code> and <code>PATCH</code> idempotent</a> for details and
options.</p>
</div>
</div>
<div class="sect3">
<h4 id="delete"><a class="link" href="#delete">DELETE</a></h4>
<div class="paragraph">
<p><a href="#delete"><code>DELETE</code></a> requests are used to <strong>delete</strong> resources. The semantic is best
described as <em>"please delete the resource identified by the URL"</em>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#delete"><code>DELETE</code></a> requests are usually applied to single resources, not on
collection resources, as this would imply deleting the entire collection.</p>
</li>
<li>
<p><a href="#delete"><code>DELETE</code></a> request can be applied to multiple resources at once using query
parameters on the collection resource (see <a href="#delete-with-query-params">DELETE with query parameters</a>).</p>
</li>
<li>
<p>Successful <a href="#delete"><code>DELETE</code></a> requests return <a href="#status-code-200" class="status-code">200</a> or <a href="#status-code-204" class="status-code">204</a> (if the resource was
deleted&#8201;&#8212;&#8201;with or without returning the resource), or <a href="#status-code-202" class="status-code">202</a> (if the request
was accepted for asynchronous processing).</p>
</li>
<li>
<p>Failed <a href="#delete"><code>DELETE</code></a> requests will usually generate <a href="#status-code-404" class="status-code">404</a> (if the resource cannot
be found) or <a href="#status-code-410" class="status-code">410</a> (if the resource was already traceably deleted before).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Important:</strong> After deleting a resource with <a href="#delete"><code>DELETE</code></a>, a <a href="#get"><code>GET</code></a> request on the
resource is expected to either return <a href="#status-code-404" class="status-code">404</a> (not found) or <a href="#status-code-410" class="status-code">410</a> (gone)
depending on how the resource is represented after deletion. Under no
circumstances the resource must be accessible after this operation on its
endpoint.</p>
</div>
</div>
<div class="sect3">
<h4 id="delete-with-query-params"><a class="link" href="#delete-with-query-params">DELETE with query parameters</a></h4>
<div class="paragraph">
<p><a href="#delete"><code>DELETE</code></a> request can have query parameters. Query parameters should be used as
filter parameters on a resource and not for passing context information to
control the operation behavior.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">DELETE /resources?param1=value1&amp;param2=value2...&amp;paramN=valueN</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> When providing <a href="#delete"><code>DELETE</code></a> with query parameters, API designers must
carefully document the behavior in case of (partial) failures to manage client
expectations properly.</p>
</div>
<div class="paragraph">
<p>The response status code of <a href="#delete"><code>DELETE</code></a> with query parameters requests should be
similar to usual <a href="#delete"><code>DELETE</code></a> requests. In addition, it may return the status code
<a href="#status-code-207" class="status-code">207</a> using a payload describing the operation results (see <a href="#152"><span class="must-keyword"><strong>MUST</strong></span> use code 207 for batch or bulk requests</a> for
details).</p>
</div>
</div>
<div class="sect3">
<h4 id="delete-with-body"><a class="link" href="#delete-with-body">DELETE with body payload</a></h4>
<div class="paragraph">
<p>In rare cases <a href="#delete"><code>DELETE</code></a> may require additional information, that cannot be
classified as filter parameters and thus should be transported via request body
payload, to perform the operation. Since <a href="https://tools.ietf.org/html/rfc9110#section-9.3.5">RFC-9110
Section 9.3.5</a> states, that <a href="#delete"><code>DELETE</code></a> has an undefined semantic for payloads, we
recommend to utilize <a href="#post"><code>POST</code></a>. In this case the POST endpoint must be documented
with the hint <a href="#delete-with-body"><code>DELETE with body</code></a> analog to how it is defined for
<a href="#get-with-body"><code>GET with body</code></a>. The response status code of <a href="#delete-with-body"><code>DELETE with body</code></a> requests should
be similar to usual <a href="#delete"><code>DELETE</code></a> requests.</p>
</div>
</div>
<div class="sect3">
<h4 id="head"><a class="link" href="#head">HEAD</a></h4>
<div class="paragraph">
<p><a href="#head"><code>HEAD</code></a> requests are used to <strong>retrieve</strong> the header information of single
resources and resource collections.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#head"><code>HEAD</code></a> has exactly the same semantics as <a href="#get"><code>GET</code></a>, but returns headers only, no
body.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> <a href="#head"><code>HEAD</code></a> is particular useful to efficiently lookup whether large
resources or collection resources have been updated in conjunction with the
<a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>ETag</code></a>-header.</p>
</div>
</div>
<div class="sect3">
<h4 id="options"><a class="link" href="#options">OPTIONS</a></h4>
<div class="paragraph">
<p><a href="#options"><code>OPTIONS</code></a> requests are used to <strong>inspect</strong> the available operations (HTTP
methods) of a given endpoint.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#options"><code>OPTIONS</code></a> responses usually either return a comma separated list of methods
in the <code>Allow</code> header or as a structured list of link templates.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note:</strong> <a href="#options"><code>OPTIONS</code></a> is rarely implemented, though it could be used to
self-describe the full functionality of a resource.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="149"><a class="link" href="#149"><span class="must-keyword"><strong>MUST</strong></span> fulfill common method properties</a></h3>
<div class="paragraph">
<p>Request methods in RESTful services can be&#8230;&#8203;</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="safe"></a><a href="https://tools.ietf.org/html/rfc9110#section-9.2.1">safe</a>&#8201;&#8212;&#8201;the operation semantic is defined to be read-only,
meaning it must not have <em>intended side effects</em>, i.e. changes, to the server
state.</p>
</li>
<li>
<p><a id="idempotent"></a><a href="https://tools.ietf.org/html/rfc9110#section-9.2.2">idempotent</a>&#8201;&#8212;&#8201;the operation has the same
<em>intended effect</em> on the server state, independently whether it is executed
once or multiple times. <strong>Note:</strong> this does not require that the operation is
returning the same response or status code.</p>
</li>
<li>
<p><a id="cacheable"></a><a href="https://tools.ietf.org/html/rfc9110#section-9.2.3">cacheable</a>&#8201;&#8212;&#8201;to indicate that responses are
allowed to be stored for future reuse. In general, requests to safe methods
are cacheable, if it does not require a current or authoritative response
from the server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note:</strong> The above definitions, of <em>intended (side) effect</em> allows the server
to provide additional state changing behavior as logging, accounting, pre-
fetching, etc. However, these actual effects and state changes, must not be
intended by the operation so that it can be held accountable.</p>
</div>
<div class="paragraph">
<p>Method implementations must fulfill the following basic properties according
to <a href="https://tools.ietf.org/html/rfc9110#section-9.2">RFC 9110 Section 9.2</a>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 15%;">
<col style="width: 35%;">
<col style="width: 35%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Idempotent</th>
<th class="tableblock halign-left valign-top">Cacheable</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#get"><code>GET</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#head"><code>HEAD</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#post"><code>POST</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="should-keyword">&#x26a0;&#xFE0F;</span> No, but <a href="#229"><span class="should-keyword"><strong>SHOULD</strong></span> consider to design <code>POST</code> and <code>PATCH</code> idempotent</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="should-keyword">&#x26a0;&#xFE0F;</span> May, but only if specific
<a href="#post"><code>POST</code></a> endpoint is <a href="#safe">safe</a>. <strong>Hint:</strong> not supported by most caches.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#put"><code>PUT</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#patch"><code>PATCH</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="should-keyword">&#x26a0;&#xFE0F;</span> No, but <a href="#229"><span class="should-keyword"><strong>SHOULD</strong></span> consider to design <code>POST</code> and <code>PATCH</code> idempotent</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#delete"><code>DELETE</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#options"><code>OPTIONS</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#trace"><code>TRACE</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Note:</strong> <a href="#227"><span class="must-keyword"><strong>MUST</strong></span> document cacheable <code>GET</code>, <code>HEAD</code>, and <code>POST</code> endpoints</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="229"><a class="link" href="#229"><span class="should-keyword"><strong>SHOULD</strong></span> consider to design <code>POST</code> and <code>PATCH</code> idempotent</a></h3>
<div class="paragraph">
<p>In many cases it is helpful or even necessary to design <a href="#post"><code>POST</code></a> and <a href="#patch"><code>PATCH</code></a>
<a href="#idempotent">idempotent</a> for clients to expose conflicts and prevent resource duplicate
(a.k.a. zombie resources) or lost updates, e.g. if same resources may be
created or changed in parallel or multiple times. To design an <a href="#idempotent">idempotent</a>
API endpoint owners should consider to apply one of the following three
patterns.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A resource specific <strong>conditional key</strong> provided via <a href="#182"><code>If-Match</code> header</a>
in the request. The key is in general a meta information of the resource,
e.g. a <em>hash</em> or <em>version number</em>, often stored with it. It allows to detect
concurrent creations and updates to ensure <a href="#idempotent">idempotent</a> behavior (see
<a href="#182"><span class="may-keyword"><strong>MAY</strong></span> consider to support <code>ETag</code> together with <code>If-Match</code>/<code>If-None-Match</code> header</a>).</p>
</li>
<li>
<p>A resource specific <strong>secondary key</strong> provided as resource property in the
request body. The <em>secondary key</em> is stored permanently in the resource. It
allows to ensure <a href="#idempotent">idempotent</a> behavior by looking up the unique secondary
key in case of multiple independent resource creations from different
clients (see <a href="#231"><span class="should-keyword"><strong>SHOULD</strong></span> use secondary key for idempotent <code>POST</code> design</a>).</p>
</li>
<li>
<p>A client specific <strong>idempotency key</strong> provided via <a href="#230"><code>Idempotency-Key</code></a> header
in the request. The key is not part of the resource but stored temporarily
pointing to the original response to ensure <a href="#idempotent">idempotent</a> behavior when
retrying a request (see <a href="#230"><span class="may-keyword"><strong>MAY</strong></span> consider to support <code>Idempotency-Key</code> header</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note:</strong> While <strong>conditional key</strong> and <strong>secondary key</strong> are focused on handling
concurrent requests, the <strong>idempotency key</strong> is focused on providing the exact
same responses, which is even a <em>stronger</em> requirement than the <a href="#idempotent">idempotency defined above</a>. It can be combined with the two other patterns.</p>
</div>
<div class="paragraph">
<p>To decide, which pattern is suitable for your use case, please consult the
following table showing the major properties of each pattern:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 46%;">
<col style="width: 18%;">
<col style="width: 18%;">
<col style="width: 18%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">Conditional Key</th>
<th class="tableblock halign-left valign-top">Secondary Key</th>
<th class="tableblock halign-left valign-top">Idempotency Key</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Applicable with</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#patch"><code>PATCH</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#post"><code>POST</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#post"><code>POST</code></a>/<a href="#patch"><code>PATCH</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prevents duplicate (zombie) resources</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prevents concurrent lost updates</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supports safe retries</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supports exact same response</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can be inspected (by intermediaries)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Usable without previous <a href="#get"><code>GET</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="must-keyword">&#x274C;</span> No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="may-keyword">&#x2714;</span> Yes</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Note:</strong> The patterns applicable to <a href="#patch"><code>PATCH</code></a> can be applied in the same way to
<a href="#put"><code>PUT</code></a> and <a href="#delete"><code>DELETE</code></a> providing the same properties.</p>
</div>
<div class="paragraph">
<p>If you mainly aim to support safe retries, we suggest to apply <a href="#182">conditional key</a> and <a href="#231">secondary key</a> pattern before the <a href="#230">idempotency key</a> pattern.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> like for <a href="#put"><code>PUT</code></a>, successful <a href="#post"><code>POST</code></a> or <a href="#patch"><code>PATCH</code></a> returns <a href="#status-code-200" class="status-code">200</a> or <a href="#status-code-204" class="status-code">204</a> (if
the resource was updated&#8201;&#8212;&#8201;with or without returning the resource), or <a href="#status-code-201" class="status-code">201</a>
(if resource was created). Hence, clients can differentiate successful robust
repetition from resource created server activity of idempotent <a href="#post"><code>POST</code></a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="231"><a class="link" href="#231"><span class="should-keyword"><strong>SHOULD</strong></span> use secondary key for idempotent <code>POST</code> design</a></h3>
<div class="paragraph">
<p>The most important pattern to design <a href="#post"><code>POST</code></a> <a href="#idempotent">idempotent</a> for creation is to
introduce a resource specific <strong>secondary key</strong> provided in the request body, to
eliminate the problem of duplicate (a.k.a zombie) resources.</p>
</div>
<div class="paragraph">
<p>The secondary key is stored permanently in the resource as <em>alternate key</em> or
<em>combined key</em> (if consisting of multiple properties) guarded by a uniqueness
constraint enforced server-side, that is visible when reading the resource.
The best and often naturally existing candidate is a <em>unique foreign key</em>, that
points to another resource having <em>one-on-one</em> relationship with the newly
created resource, e.g. a parent process identifier.</p>
</div>
<div class="paragraph">
<p>A good example here for a secondary key is the shopping cart ID in an order
resource.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> When using the secondary key pattern without <a href="#230"><code>Idempotency-Key</code></a> all
subsequent retries should fail with status code <a href="#status-code-409" class="status-code">409</a> (conflict). We suggest
to avoid <a href="#status-code-200" class="status-code">200</a> here unless you make sure, that the delivered resource is the
original one implementing a well defined behavior. Using <a href="#status-code-204" class="status-code">204</a> without content
would be a similar well defined option.</p>
</div>
</div>
<div class="sect2">
<h3 id="253"><a class="link" href="#253"><span class="may-keyword"><strong>MAY</strong></span> support asynchronous request processing</a></h3>
<div class="paragraph">
<p>Typically REST APIs are designed as synchronous interfaces where all
server-side processing and state changes initiated by the call are finished
before delivering the result as response. However, in long running request
processing situations you may make use of asynchronous interface design with
multiple calls: one for initiating the asynchronous processing and subsequent
ones for accessing the processing status and/or result.</p>
</div>
<div class="paragraph">
<p>We recommend an API design that represents the asynchronous request processing
explicitly via a job resource that has a status and is different from the
actual business resource. For instance, <code>POST /report-jobs</code> returns HTTP status
code <a href="#status-code-201" class="status-code">201</a> to indicate successful initiation of asynchronous processing
together with the <em>job-id</em> passed in the response payload and/or via the URL of
the <a href="https://tools.ietf.org/html/rfc9110#section-10.2.2"><code>Location</code></a> header. The <em>job-id</em> or <a href="https://tools.ietf.org/html/rfc9110#section-10.2.2"><code>Location</code></a> URL then can be used to poll
the processing status via <code>GET /report-jobs/<a href="#id"><code>id</code></a></code> which returns HTTP status
code <a href="#status-code-200" class="status-code">200</a> with job status and optional report-id as response payload. Once
returned with job status <code>finished</code>, the report-id is provided and can be used
to fetch the result via <code>GET /reports/<a href="#id"><code>id</code></a></code> which returns <a href="#status-code-200" class="status-code">200</a> and the report
object as response payload.</p>
</div>
<div class="paragraph">
<p>Alternatively, if you do not to follow the recommended practice of providing a
separate job resource, you may use <code>POST /reports</code> returning a status code
<a href="#status-code-202" class="status-code">202</a> together with the <a href="https://tools.ietf.org/html/rfc9110#section-10.2.2"><code>Location</code></a> header to indicate successful initiation of
the asynchronous processing. The <a href="https://tools.ietf.org/html/rfc9110#section-10.2.2"><code>Location</code></a> URL is used to fetch the report via
<code>GET /reports/<a href="#id"><code>id</code></a></code> which returns either <a href="#status-code-200" class="status-code">200</a> and the report resource or <a href="#status-code-202" class="status-code">202</a>
without payload, if the asynchronous processing is still ongoing.</p>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> Do <strong>not</strong> use response code <a href="#status-code-204" class="status-code">204</a> or <a href="#status-code-404" class="status-code">404</a> instead of <a href="#status-code-202" class="status-code">202</a> here&#8201;&#8212;&#8201;it
is misleading since neither is the processing successfully finished, nor do we
want to suggest a client failure.</p>
</div>
</div>
<div class="sect2">
<h3 id="154"><a class="link" href="#154"><span class="must-keyword"><strong>MUST</strong></span> define collection format of header and query parameters</a></h3>
<div class="paragraph">
<p>Header and query parameters allow to provide a collection of values, either
by providing a comma-separated list of values or by repeating the parameter
multiple times with different values as follows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14%;">
<col style="width: 30%;">
<col style="width: 39%;">
<col style="width: 17%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter Type</th>
<th class="tableblock halign-left valign-top">Comma-separated Values</th>
<th class="tableblock halign-left valign-top">Multiple Parameters</th>
<th class="tableblock halign-left valign-top">Standard</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Header: value1,value2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Header: value1, Header: value2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc9110#section-5.3">RFC 9110 Section 5.3</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>?param=value1,value2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>?param=value1&amp;param=value2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://tools.ietf.org/html/rfc6570#section-3.2.8">RFC 6570 Section 3.2.8</a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>As OpenAPI does not support both schemas at once, an API specification must
explicitly define the collection format to guide consumers as follows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14%;">
<col style="width: 40%;">
<col style="width: 46%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter Type</th>
<th class="tableblock halign-left valign-top">Comma-separated Values</th>
<th class="tableblock halign-left valign-top">Multiple Parameters</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Header</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>style: simple, explode: false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not allowed (see
  <a href="https://tools.ietf.org/html/rfc9110#section-5.3">RFC 9110 Section 5.3</a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>style: form, explode: false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>style: form, explode: true</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>When choosing the collection format, take into account the tool support,
the escaping of special characters and the maximal URL length.</p>
</div>
</div>
<div class="sect2">
<h3 id="236"><a class="link" href="#236"><span class="should-keyword"><strong>SHOULD</strong></span> design simple query languages using query parameters</a></h3>
<div class="paragraph">
<p>We prefer the use of query parameters to describe resource-specific query
languages for the majority of APIs because it&#8217;s native to HTTP, easy to extend
and has an excellent implementation support in HTTP clients and web frameworks.</p>
</div>
<div class="paragraph">
<p>By simple query language we mean one or more name-value pairs that are combined
in one way only with <code>and</code> semantics.</p>
</div>
<div class="paragraph">
<p>Query parameters should have the following aspects specified:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reference to corresponding property, if any</p>
</li>
<li>
<p>Value range, e.g. inclusive vs. exclusive</p>
</li>
<li>
<p>Comparison semantics (equals, less than, greater than, etc)</p>
</li>
<li>
<p>Implications when combined with other queries, e.g. <em>and</em> vs. <em>or</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>How query parameters are named and used is up to individual API designers, here
are a few tips that could help to decide whether to use simple or more complex
query language:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Consider using simple query language when API is built to be used by others
(external teams):</p>
<div class="ulist">
<ul>
<li>
<p>no additional effort/logic to form the query</p>
</li>
<li>
<p>no ambiguity in meaning of the query parameters. For example
 in <code>GET /items?user_id=gt:100</code>, is <code>user_id</code> greater than <code>100</code> or
is <code>user_id</code> equal to <code>gt:100</code>?</p>
</li>
<li>
<p>easy to read, no learning curve</p>
</li>
</ul>
</div>
</li>
<li>
<p>For internal usage or specific use case a more complex query language can be
used (such as <code>price gt 10</code> or <code>price[gt]=10</code> or <code>price&gt;10</code> etc.). Also
please consider following <a href="#237">our guidance</a> for designing complex query
languages with JSON.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following examples should serve as ideas for simple query language:</p>
</div>
<div class="sect3">
<h4 id="_equals"><a class="link" href="#_equals">Equals</a></h4>
<div class="ulist">
<ul>
<li>
<p><code>name=Zalando</code>, <code>creation_year=2023</code>, <code>updated_by=user1</code> (query elements
based on property equality)</p>
</li>
<li>
<p><code>created_at=2023-09-18T12:12:00.000Z</code>, <code>sort=id:desc</code> (query elements
based on logical properties)</p>
</li>
<li>
<p><code>color=red,green,blue,multicolored</code> (query elements based on multiple
choice possibility)</p>
<div class="ulist">
<ul>
<li>
<p>for these type of filters, consider to use <a href="#237">guidance</a> to have
smth like <code>filters={"color":["red","green","blue"]}</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_less_than"><a class="link" href="#_less_than">Less than</a></h4>
<div class="ulist">
<ul>
<li>
<p><code>max_length=5</code>&#8201;&#8212;&#8201;query elements based on upper/lower bounds (<code>min</code> and <code>max</code>)</p>
</li>
<li>
<p><code>shorter_than=5</code>&#8201;&#8212;&#8201;query elements using terminology specific e.g. to <em>length</em></p>
</li>
<li>
<p><code>price_lower_than=50</code> or <code>price_lower_than_or_equal=50</code></p>
</li>
<li>
<p><code>created_before=2019-07-17</code> or <code>active_until=2023-09-18T12:12:00.000Z</code></p>
<div class="ulist">
<ul>
<li>
<p>Using terminology specific to time: <em>before</em>, <em>after</em>, <em>since</em> and <em>until</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_more_than"><a class="link" href="#_more_than">More than</a></h4>
<div class="ulist">
<ul>
<li>
<p><code>min_length=2</code>&#8201;&#8212;&#8201;query elements based on upper/lower bounds (<code>min</code> and <code>max</code>)</p>
</li>
<li>
<p><code>created_after=2019-07-17</code> or <code>modified_since=2019-07-17</code></p>
<div class="ulist">
<ul>
<li>
<p>Using terminology specific to time: <em>before</em>, <em>after</em>, <em>since</em> and <em>until</em></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>price_higher_than=50</code> or <code>price_equal_or_higher_than=50</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_pagination"><a class="link" href="#_pagination">Pagination</a></h4>
<div class="ulist">
<ul>
<li>
<p><code>offset=10</code> and <code>limit=5</code> (query elements for pagination regardless
customer sorting)</p>
</li>
<li>
<p><code>limit=5</code> and <code>created_after=2019-07-17</code> (query elements for
keyset pagination)</p>
<div class="ulist">
<ul>
<li>
<p>when sorting is in place and new elements are inserted, it prevents showing
repeated/missing results due to offset shift.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Please check <a href="#137">conventional query parameters for pagination and sorting</a>
and you can also find additional info in <a href="#pagination">REST Design - Pagination</a> section below.</p>
</div>
<div class="paragraph">
<p>We don&#8217;t advocate for or against certain names because in the end APIs should
be free to choose the terminology that fits their domain the best.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="237"><a class="link" href="#237"><span class="should-keyword"><strong>SHOULD</strong></span> design complex query languages using JSON</a></h3>
<div class="paragraph">
<p>Minimalistic query languages based on <a href="#236">query parameters</a> are suitable
for simple use cases with a small set of available filters that are combined
in one way and one way only (e.g. <em>and</em> semantics). Simple query languages are
generally preferred over complex ones.</p>
</div>
<div class="paragraph">
<p>Some APIs will have a need for sophisticated and more complex query languages.
Dominant examples are APIs around search (incl. faceting) and product catalogs.</p>
</div>
<div class="paragraph">
<p>Aspects that set those APIs apart from the rest include but are not limited to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Unusual high number of available filters</p>
</li>
<li>
<p>Dynamic filters, due to a dynamic and extensible resource model</p>
</li>
<li>
<p>Free choice of operators, e.g. <code>and</code>, <code>or</code> and <code>not</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>APIs that qualify for a specific, complex query language are encouraged to use
nested JSON data structures and define them using OpenAPI directly. The
provides the following benefits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Data structures are easy to use for clients</p>
<div class="ulist">
<ul>
<li>
<p>No special library support necessary</p>
</li>
<li>
<p>No need for string concatenation or manual escaping</p>
</li>
</ul>
</div>
</li>
<li>
<p>Data structures are easy to use for servers</p>
<div class="ulist">
<ul>
<li>
<p>No special tokenizers needed</p>
</li>
<li>
<p>Semantics are attached to data structures rather than text tokens</p>
</li>
</ul>
</div>
</li>
<li>
<p>Consistent with other HTTP methods</p>
</li>
<li>
<p>API is defined in OpenAPI completely</p>
<div class="ulist">
<ul>
<li>
<p>No external documents or grammars needed</p>
</li>
<li>
<p>Existing means are familiar to everyone</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#json-guidelines">JSON-specific rules</a> and most certainly needs to make use
of the <a href="#get-with-body"><code>GET</code>-with-body</a> pattern.</p>
</div>
<div class="sect3">
<h4 id="_example"><a class="link" href="#_example">Example</a></h4>
<div class="paragraph">
<p>The following JSON document should serve as an idea how a structured query
might look like.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">and</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">match</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Alice</span><span class="delimiter">&quot;</span></span>
    },
    <span class="key"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">or</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">range</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">&gt;</span><span class="delimiter">&quot;</span></span>: <span class="integer">25</span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">&lt;=</span><span class="delimiter">&quot;</span></span>: <span class="integer">50</span>
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">=</span><span class="delimiter">&quot;</span></span>: <span class="integer">65</span>
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Feel free to also get some inspiration from:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl.html">Elastic
Search: Query DSL</a></p>
</li>
<li>
<p><a href="https://graphql.org/learn/queries/">GraphQL: Queries</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="226"><a class="link" href="#226"><span class="must-keyword"><strong>MUST</strong></span> document implicit response filtering</a></h3>
<div class="paragraph">
<p>Sometimes certain collection resources or queries will not list all the
possible elements they have, but only those for which the current client is
authorized to access.</p>
</div>
<div class="paragraph">
<p>Implicit filtering could be done on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the collection of resources being returned on a <a href="#get"><code>GET</code></a> request</p>
</li>
<li>
<p>the fields returned for the detail information of the resource</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In such cases, the fact that implicit filtering is applied must be documented
in the API specification&#8217;s endpoint description. Consider <a href="#227">caching
aspects</a> when implicit filtering is provided. Example:</p>
</div>
<div class="paragraph">
<p>If an employee of the company <em>Foo</em> accesses one of our business-to-business
service and performs a <code><a href="#get"><code>GET</code></a> /business-partners</code>, it must, for legal reasons,
not display any other business partner that is not owned or contractually
managed by her/his company. It should never see that we are doing business
also with company <em>Bar</em>.</p>
</div>
<div class="paragraph">
<p>Response as seen from a consumer working at <code>FOO</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">items</span><span class="delimiter">&quot;</span></span>: [
        { <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Foo Performance</span><span class="delimiter">&quot;</span></span> },
        { <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Foo Sport</span><span class="delimiter">&quot;</span></span> },
        { <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Foo Signature</span><span class="delimiter">&quot;</span></span> }
    ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Response as seen from a consumer working at <code>BAR</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">items</span><span class="delimiter">&quot;</span></span>: [
        { <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Bar Classics</span><span class="delimiter">&quot;</span></span> },
        { <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Bar pour Elle</span><span class="delimiter">&quot;</span></span> }
    ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The API Specification should then specify something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">paths</span>:
  <span class="key">/business-partner</span>:
    <span class="key">get</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">&gt;-</span><span class="content">
        Get the list of registered business partner.
        Only the business partners to which you have access to are returned.</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="http-status-codes-and-errors"><a class="link" href="#http-status-codes-and-errors">10. REST Basics - HTTP status codes</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="243"><a class="link" href="#243"><span class="must-keyword"><strong>MUST</strong></span> use official HTTP status codes</a></h3>
<div class="paragraph">
<p>You must only use official HTTP status codes consistently with their intended
semantics. Official HTTP status codes are defined via RFC standards and
registered in the
<a href="https://www.iana.org/assignments/http-status-codes/http-status-codes.xhtml">IANA
Status Code Registry</a>. Main RFC standards are <a href="https://tools.ietf.org/html/rfc7231" class="bare">https://tools.ietf.org/html/rfc7231</a> // obsoleted by rfc-9110#section-6[RFC7231 -
HTTP/1.1: Semantics] (or <a href="https://tools.ietf.org/html/rfc7235" class="bare">https://tools.ietf.org/html/rfc7235</a> // obsoleted by rfc-9110#page-6[RFC7235 - HTTP/1.1: Authentication])
and <a href="https://tools.ietf.org/html/rfc6585">RFC 6585 - HTTP: Additional Status Codes</a> (and there are
upcoming new ones, e.g.
<a href="https://tools.ietf.org/html/draft-tbray-http-legally-restricted-status-05">draft
legally-restricted-status</a>). An overview on the official error codes provides
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">Wikipedia: HTTP status
codes</a> (which also lists some unofficial status codes, e.g. defined by popular
web servers like Nginx, that we do not suggest to use).</p>
</div>
</div>
<div class="sect2">
<h3 id="151"><a class="link" href="#151"><span class="must-keyword"><strong>MUST</strong></span> specify success and error responses</a></h3>
<div class="paragraph">
<p>APIs should define the functional, business view and abstract from
implementation aspects. Success and error responses are a vital part to
define how an API is used correctly.</p>
</div>
<div class="paragraph">
<p>Therefore, you must define <strong>all</strong> success and service specific error responses
in your API specification. Both are part of the interface definition and
provide important information for service clients to handle standard as well as
exceptional situations. Error code response descriptions should provide
information about the specific conditions that lead to the error, especially if
these conditions can be changed by how the endpoint is used by the clients.</p>
</div>
<div class="paragraph">
<p>API designers should also think about a <strong>troubleshooting board</strong> as part of
the associated online API documentation. It provides information and handling
guidance on application-specific errors and is referenced via links from the
API specification. This can reduce service support tasks and contribute to
service client and provider performance.</p>
</div>
<div class="paragraph">
<p><strong>Exception:</strong> Standard client and server errors, e.g. <a href="#status-code-401" class="status-code">401</a> (unauthenticated),
<a href="#status-code-403" class="status-code">403</a> (unauthorized), <a href="#status-code-404" class="status-code">404</a> (not found), <a href="#status-code-500" class="status-code">500</a> (internal server error), or
<a href="#status-code-503" class="status-code">503</a> (service unavailable), where the semantic can be easily derived from the
end endpoint specification need no individual definition. Instead these can be
included by applying the <code>default</code> shown pattern below. However, error codes
that provide endpoint specific indications for clients on how to avoid calling
the endpoint in the wrong way, or be prepared to react on specific error
situation must be specified explicitly.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">responses</span>:
  <span class="error">...</span>
  <span class="key">default</span>:
    <span class="key">description</span>: <span class="string"><span class="content">error occurred - see status code and problem object for more information.</span></span>
    <span class="key">content</span>:
      <span class="key"><span class="delimiter">&quot;</span><span class="content">application/problem+json</span><span class="delimiter">&quot;</span></span>:
        <span class="key">schema</span>:
          <span class="error">$ref</span>: <span class="error">'https://opensource.zalando.com/restful-api-guidelines/models/problem-1.0.1.yaml#/Problem'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="150"><a class="link" href="#150"><span class="should-keyword"><strong>SHOULD</strong></span> only use most common HTTP status codes</a></h3>
<div class="paragraph">
<p>The most commonly used codes are best understood and listed below as subset of
the official HTTP status codes and consistent with their semantics in the RFCs.
We avoid less commonly used codes that easily create misconceptions due to
less familiar semantics and API specific interpretations.</p>
</div>
<div class="paragraph">
<p><strong>Important:</strong> As long as your HTTP status code usage is well covered by the
semantic defined here, you should not describe it to avoid an overload with
common sense information and the risk of inconsistent definitions. Only if the
HTTP status code is not in the list below or its usage requires additional
information aside the well defined semantic, the API specification must provide
a clear description of the HTTP status code in the response.</p>
</div>
<div class="sect3">
<h4 id="status-code-legend"><a class="link" href="#status-code-legend">Legend</a></h4>
<div class="paragraph">
<p>A more specific version of the <a href="#conventions-used-in-these-guidelines">Conventions used in these guidelines</a>.</p>
</div>
<div class="sect4">
<h5 id="status-code-use"><a class="link" href="#status-code-use"><a href="#status-code-use"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> use</span></a></a></h5>
<div class="paragraph">
<p>A common, well understood status code that should be used where appropriate.
Does NOT mean that every operation must be able to return this code.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-do-not-use"><a class="link" href="#status-code-do-not-use"><a href="#status-code-do-not-use"><span class="status-code-hint mustnot"><span class="icon"><i class="fa fa-times"></i></span> do not use</span></a></a></h5>
<div class="paragraph">
<p>We do not see a good use-case for returning this status code from a RESTful
API. The status code might be applicable in other contexts, e.g. returned by
reverse proxies, for web pages, etc. Implicitly also means <a href="#status-code-do-not-document"><span class="status-code-hint shouldnot"><span class="icon"><i class="fa fa-times"></i></span> do not document</span></a>,
as status codes that are not returned by the API should also not be documented.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-document"><a class="link" href="#status-code-document"><a href="#status-code-document"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> document</span></a></a></h5>
<div class="paragraph">
<p>If the status code can be returned by the API, it should be documented in the
API specification.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-do-not-document"><a class="link" href="#status-code-do-not-document"><a href="#status-code-do-not-document"><span class="status-code-hint shouldnot"><span class="icon"><i class="fa fa-times"></i></span> do not document</span></a></a></h5>
<div class="paragraph">
<p>The status code has a well-understood standard meaning to it, so only document
it if there are operation specific details you want to add. See exception in
<a href="#151">rule 151</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="success-codes"><a class="link" href="#success-codes">Success codes</a></h4>
<div class="sect4">
<h5 id="status-code-200"><a class="link" href="#status-code-200">200 OK <a href="https://tools.ietf.org/html/rfc9110#name-200-ok" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-use"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> use</span></a> <a href="#status-code-document"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> document</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>This is the most general success response. It should be used if the more
specific codes below are not applicable. In a robust resource creation via
<a href="#post"><code>POST</code></a>, <a href="#put"><code>PUT</code></a>, and <a href="#patch"><code>PATCH</code></a> in conjunction with a <a href="#status-code-201" class="status-code">201</a> this indicates that the
returned resource exists before.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-201"><a class="link" href="#status-code-201">201 Created <a href="https://tools.ietf.org/html/rfc9110#name-201-created" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-use"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> use</span></a> <a href="#status-code-document"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> document</span></a> <a href="#post"><code>POST</code></a> <a href="#put"><code>PUT</code></a></a></h5>
<div class="paragraph indent">
<p>Returned on successful resource creation.
<a href="#status-code-201" class="status-code">201</a> is returned with or without response payload (unlike <a href="#status-code-200" class="status-code">200</a> / <a href="#status-code-204" class="status-code">204</a>).
We recommend additionally to return the created resource URL via the <a href="https://tools.ietf.org/html/rfc9110#section-10.2.2"><code>Location</code></a>
response header (see <a href="#133"><span class="may-keyword"><strong>MAY</strong></span> use standard headers</a>).</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-202"><a class="link" href="#status-code-202">202 Accepted <a href="https://tools.ietf.org/html/rfc9110#name-202-accepted" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-use"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> use</span></a> <a href="#status-code-document"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> document</span></a> <a href="#post"><code>POST</code></a> <a href="#put"><code>PUT</code></a> <a href="#patch"><code>PATCH</code></a> <a href="#delete"><code>DELETE</code></a></a></h5>
<div class="paragraph indent">
<p>The request was successful and will be processed asynchronously.
Only applicable to methods which change something, with the exception of
<a href="#get"><code>GET</code></a> methods indicating that a resources is still created asynchronously
as described in <a href="#253"><span class="may-keyword"><strong>MAY</strong></span> support asynchronous request processing</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-204"><a class="link" href="#status-code-204">204 No content <a href="https://tools.ietf.org/html/rfc9110#name-204-no-content" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-use"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> use</span></a> <a href="#status-code-document"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> document</span></a> <a href="#post"><code>POST</code></a> <a href="#put"><code>PUT</code></a> <a href="#patch"><code>PATCH</code></a> <a href="#delete"><code>DELETE</code></a></a></h5>
<div class="paragraph indent">
<p>Returned instead of <a href="#status-code-200" class="status-code">200</a>, if no response payload is returned. Normally only
applicable to methods which change something.</p>
</div>
</div>
<div class="sect4 do-not-use">
<h5 id="status-code-205"><a class="link" href="#status-code-205">205 Reset Content <a href="https://tools.ietf.org/html/rfc9110#name-205-reset-content" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-do-not-use"><span class="status-code-hint mustnot"><span class="icon"><i class="fa fa-times"></i></span> do not use</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>This is meant for interactive use cases, e.g. to clear a form after submitting
it. There is no reason to use it in a REST API.</p>
</div>
</div>
<div class="sect4 do-not-use">
<h5 id="status-code-206"><a class="link" href="#status-code-206">206 Partial Content <a href="https://tools.ietf.org/html/rfc9110#name-206-partial-content" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-do-not-use"><span class="status-code-hint mustnot"><span class="icon"><i class="fa fa-times"></i></span> do not use</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>For responses to range requests, when only a part of the resource indicated by
the byte range is returned. This is not for pagination, where a normal <a href="#status-code-200" class="status-code">200</a>
should be used. This might be useful in rare cases (like media streaming or
downloading large files), but most APIs don&#8217;t need this.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-207"><a class="link" href="#status-code-207">207 Multi-Status <a href="https://tools.ietf.org/html/rfc4918#section-11.1" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-use"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> use</span></a> <a href="#status-code-document"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> document</span></a> <a href="#post"><code>POST</code></a> (<a href="#delete"><code>DELETE</code></a>)</a></h5>
<div class="paragraph indent">
<p>The response body contains status information for multiple different parts of a
batch/bulk request (see <a href="#152"><span class="must-keyword"><strong>MUST</strong></span> use code 207 for batch or bulk requests</a> for details). Normally used for <a href="#post"><code>POST</code></a>, in some
cases also for <a href="#delete"><code>DELETE</code></a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="redirection-codes"><a class="link" href="#redirection-codes">Redirection codes</a></h4>
<div class="sect4 do-not-use">
<h5 id="status-code-301"><a class="link" href="#status-code-301">301 Moved Permanently <a href="https://tools.ietf.org/html/rfc9110#name-301-moved-permanently" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-do-not-use"><span class="status-code-hint mustnot"><span class="icon"><i class="fa fa-times"></i></span> do not use</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>This and all future requests should be directed to the given URI. See also
<a href="#251"><span class="should-keyword"><strong>SHOULD</strong></span> not use redirection codes</a>.</p>
</div>
</div>
<div class="sect4 do-not-use">
<h5 id="status-code-302"><a class="link" href="#status-code-302">302 Found <a href="https://tools.ietf.org/html/rfc9110#name-302-found" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-do-not-use"><span class="status-code-hint mustnot"><span class="icon"><i class="fa fa-times"></i></span> do not use</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>This is a temporary redirect where some clients <span class="may-keyword"><strong>MAY</strong></span> change the request method
from <a href="#post"><code>POST</code></a> to <a href="#get"><code>GET</code></a>. Mainly used for dismissing and redirecting form
submissions in browsers. See also <a href="#251"><span class="should-keyword"><strong>SHOULD</strong></span> not use redirection codes</a>.</p>
</div>
</div>
<div class="sect4 do-not-use">
<h5 id="status-code-303"><a class="link" href="#status-code-303">303 See Other <a href="https://tools.ietf.org/html/rfc9110#name-303-see-other" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-do-not-use"><span class="status-code-hint mustnot"><span class="icon"><i class="fa fa-times"></i></span> do not use</span></a> <a href="#post"><code>POST</code></a> <a href="#put"><code>PUT</code></a> <a href="#patch"><code>PATCH</code></a> <a href="#delete"><code>DELETE</code></a></a></h5>
<div class="paragraph indent">
<p>The response to the request can be found under another URI using a <a href="#get"><code>GET</code></a>
method. A disambiguated version of <a href="#status-code-302" class="status-code">302</a> for the case where the client <span class="must-keyword"><strong>MUST</strong></span>
change the method to <a href="#get"><code>GET</code></a>. See also <a href="#251"><span class="should-keyword"><strong>SHOULD</strong></span> not use redirection codes</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-304"><a class="link" href="#status-code-304">304 Not Modified <a href="https://tools.ietf.org/html/rfc9110#name-304-not-modified" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-document"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> document</span></a> <a href="#get"><code>GET</code></a> <a href="#head"><code>HEAD</code></a></a></h5>
<div class="paragraph indent">
<p>Indicates that a conditional <a href="#get"><code>GET</code></a> or <a href="#head"><code>HEAD</code></a> request would have resulted in
<a href="#status-code-200" class="status-code">200</a> response, if it were not for the fact that the condition evaluated to
false, i.e. resource has not been modified since the date or version passed via
request headers <a href="https://tools.ietf.org/html/rfc9110#section-13.1.3"><code>If-Modified-Since</code></a> or <a href="https://tools.ietf.org/html/rfc9110#section-13.1.2"><code>If-None-Match</code></a>. For
<a href="#put"><code>PUT</code></a>/<a href="#patch"><code>PATCH</code></a>/<a href="#delete"><code>DELETE</code></a> requests, use <a href="#status-code-412" class="status-code">412</a> instead.</p>
</div>
</div>
<div class="sect4 do-not-use">
<h5 id="status-code-307"><a class="link" href="#status-code-307">307 Temporary Redirect <a href="https://tools.ietf.org/html/rfc9110#name-307-temporary-redirect" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-do-not-use"><span class="status-code-hint mustnot"><span class="icon"><i class="fa fa-times"></i></span> do not use</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>The response to the request can be found under another URI. A disambiguated
version of <a href="#status-code-302" class="status-code">302</a> where the client <span class="must-keyword"><strong>MUST</strong></span> keep the same method as the original
request. See also <a href="#251"><span class="should-keyword"><strong>SHOULD</strong></span> not use redirection codes</a>.</p>
</div>
</div>
<div class="sect4 do-not-use">
<h5 id="status-code-308"><a class="link" href="#status-code-308">308 Permanent Redirect <a href="https://tools.ietf.org/html/rfc9110#name-308-permanent-redirect" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-do-not-use"><span class="status-code-hint mustnot"><span class="icon"><i class="fa fa-times"></i></span> do not use</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>Similar to <a href="#status-code-307" class="status-code">307</a>, but the client should persist the new URI. Applicable more to
browsers. For APIs, the URI should be explicitly fixed at the source instead of
being implicitly kept in some state based on a previous redirect. See also
<a href="#251"><span class="should-keyword"><strong>SHOULD</strong></span> not use redirection codes</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="client-side-error-codes"><a class="link" href="#client-side-error-codes">Client side error codes</a></h4>
<div class="sect4">
<h5 id="status-code-400"><a class="link" href="#status-code-400">400 Bad Request <a href="https://tools.ietf.org/html/rfc9110#name-400-bad-request" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-use"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> use</span></a> <a href="#status-code-document"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> document</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>Unspecific client error indicating that the server cannot process the request
due to something that is perceived to be a client error (e.g. malformed request
syntax, invalid request). Should also be delivered in case of input payload
fails business logic / semantic validation (instead of using <a href="#status-code-422" class="status-code">422</a>).</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-401"><a class="link" href="#status-code-401">401 Unauthorized <a href="https://tools.ietf.org/html/rfc9110#name-401-unauthorized" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-use"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> use</span></a> <a href="#status-code-do-not-document"><span class="status-code-hint shouldnot"><span class="icon"><i class="fa fa-times"></i></span> do not document</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>Actually <strong>Unauthenticated</strong>. The credentials are missing or not valid for the
target resource. For an API, this usually means that the provided token or
cookie is not valid. As this can happen for almost every endpoint, APIs should
normally not document this.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-403"><a class="link" href="#status-code-403">403 Forbidden <a href="https://tools.ietf.org/html/rfc9110#name-403-forbidden" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-do-not-document"><span class="status-code-hint shouldnot"><span class="icon"><i class="fa fa-times"></i></span> do not document</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>The user is not authorized to use this resource. For an API, this can mean that
the request&#8217;s token was valid, but was missing a scope for this endpoint. Or
that some object-specific authorization failed. We recommend only documenting
the second case.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-404"><a class="link" href="#status-code-404">404 Not found <a href="https://tools.ietf.org/html/rfc9110#name-404-not-found" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-use"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> use</span></a> <a href="#status-code-do-not-document"><span class="status-code-hint shouldnot"><span class="icon"><i class="fa fa-times"></i></span> do not document</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>The target resource was not found. This will be returned by most paths on most
APIs (with out being documented), and for endpoints with parameters when those
parameters cannot be map to an existing entity. For a <a href="#put"><code>PUT</code></a> endpoint which only
supports updating existing resources, this might be returned if the resource
does not exist. Apart from these special cases, this does not need to be
documented.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-405"><a class="link" href="#status-code-405">405 Method Not Allowed <a href="https://tools.ietf.org/html/rfc9110#name-405-method-not-allowed" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-document"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> document</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>The request method is not supported for this resource. In theory, this can be
returned for all resources for all the methods except the ones documented.
Using this response code for an existing endpoint (usually with path
parameters) only makes sense if it depends on some internal resource state
whether a specific method is allowed, e.g. an order can only be canceled via
<a href="#delete"><code>DELETE</code></a> until the shipment leaves the warehouse. <strong>Do not use it unless you
have such a special use case, but then make sure to document it, making it
clear why a resource might not support a method.</strong></p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-406"><a class="link" href="#status-code-406">406 Not Acceptable <a href="https://tools.ietf.org/html/rfc9110#name-406-not-acceptable" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-use"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> use</span></a> <a href="#status-code-do-not-document"><span class="status-code-hint shouldnot"><span class="icon"><i class="fa fa-times"></i></span> do not document</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>Resource only supports generating content with content-types that are not
listed in the <a href="https://tools.ietf.org/html/rfc9110#section-12.5.1"><code>Accept</code></a> header sent in the request.</p>
</div>
</div>
<div class="sect4 do-not-use">
<h5 id="status-code-408"><a class="link" href="#status-code-408">408 Request timeout <a href="https://tools.ietf.org/html/rfc9110#name-408-request-timeout" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-do-not-use"><span class="status-code-hint mustnot"><span class="icon"><i class="fa fa-times"></i></span> do not use</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>The server times out waiting for the request to arrive. For APIs, this should
not be used.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-409"><a class="link" href="#status-code-409">409 Conflict <a href="https://tools.ietf.org/html/rfc9110#name-409-conflict" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-document"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> document</span></a> <a href="#post"><code>POST</code></a> <a href="#put"><code>PUT</code></a> <a href="#patch"><code>PATCH</code></a> <a href="#delete"><code>DELETE</code></a></a></h5>
<div class="paragraph indent">
<p>The request cannot be completed due to conflict with the current state of the
target resource. For example, you may get a <a href="#status-code-409" class="status-code">409</a> response when updating a
resource that is older than the existing one on the server, resulting in a
version control conflict. If this is used, it <span class="must-keyword"><strong>MUST</strong></span> be documented. For
successful robust creation of resources (<a href="#put"><code>PUT</code></a> or <a href="#post"><code>POST</code></a>) you should always
return <a href="#status-code-200" class="status-code">200</a> or <a href="#status-code-204" class="status-code">204</a> and not <a href="#status-code-409" class="status-code">409</a>, even if the resource exists already. If
any <code>If-*</code> headers cause a conflict, you should use <a href="#status-code-412" class="status-code">412</a> and not <a href="#status-code-409" class="status-code">409</a>. Only
applicable to methods which change something.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-410"><a class="link" href="#status-code-410">410 Gone <a href="https://tools.ietf.org/html/rfc9110#name-410-gone" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-do-not-document"><span class="status-code-hint shouldnot"><span class="icon"><i class="fa fa-times"></i></span> do not document</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>The resource does not exist any longer. It did exist in the past, and will
most likely not exist in the future. This can be used, e.g. when accessing a
resource that has intentionally been deleted. This normally does not need to be
documented, unless there is a specific need to distinguish this case from the
normal <a href="#status-code-404" class="status-code">404</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-411"><a class="link" href="#status-code-411">411 Length Required <a href="https://tools.ietf.org/html/rfc9110#name-411-length-required" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-document"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> document</span></a> <a href="#post"><code>POST</code></a> <a href="#put"><code>PUT</code></a> <a href="#patch"><code>PATCH</code></a></a></h5>
<div class="paragraph indent">
<p>The server requires a <a href="https://tools.ietf.org/html/rfc9110#section-8.6"><code>Content-Length</code></a> header for this request. This is
normally only relevant for large media uploads. The corresponding header
parameter should be marked as required. If used, it <span class="must-keyword"><strong>MUST</strong></span> to be documented
(and explained).</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-412"><a class="link" href="#status-code-412">412 Precondition Failed <a href="https://tools.ietf.org/html/rfc9110#name-412-precondition-failed" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-use"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> use</span></a> <a href="#status-code-do-not-document"><span class="status-code-hint shouldnot"><span class="icon"><i class="fa fa-times"></i></span> do not document</span></a> <a href="#put"><code>PUT</code></a> <a href="#patch"><code>PATCH</code></a> <a href="#delete"><code>DELETE</code></a></a></h5>
<div class="paragraph indent">
<p>Returned for conditional requests, e.g. <a href="https://tools.ietf.org/html/rfc9110#section-13.1.1"><code>If-Match</code></a> if the condition failed.
Used for optimistic locking. Normally only applicable to methods that change
something. For <a href="#head"><code>HEAD</code></a>/<a href="#get"><code>GET</code></a> requests, use <a href="#status-code-304" class="status-code">304</a> instead.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-415"><a class="link" href="#status-code-415">415 Unsupported Media Type <a href="https://tools.ietf.org/html/rfc9110#name-415-unsupported-media-type" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-use"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> use</span></a> <a href="#status-code-do-not-document"><span class="status-code-hint shouldnot"><span class="icon"><i class="fa fa-times"></i></span> do not document</span></a> <a href="#post"><code>POST</code></a> <a href="#put"><code>PUT</code></a> <a href="#patch"><code>PATCH</code></a></a></h5>
<div class="paragraph indent">
<p>The client did not provide a supported content-type for the request body. Only
applicable to methods with a request body.</p>
</div>
</div>
<div class="sect4 do-not-use">
<h5 id="status-code-417"><a class="link" href="#status-code-417">417 Expectation Failed <a href="https://tools.ietf.org/html/rfc9110#name-417-expectation-failed" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-do-not-use"><span class="status-code-hint mustnot"><span class="icon"><i class="fa fa-times"></i></span> do not use</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>Returned when the client used an <a href="https://tools.ietf.org/html/rfc9110#name-expect"><code>Expect</code></a> header which the server does not
support. The only defined value for the <a href="https://tools.ietf.org/html/rfc9110#name-expect"><code>Expect</code></a> header is very technical and
does not belong in an API.</p>
</div>
</div>
<div class="sect4 do-not-use">
<h5 id="status-code-418"><a class="link" href="#status-code-418">418 I&#8217;m a teapot 🫖 (Unused) <a href="https://tools.ietf.org/html/rfc9110#name-418-unused" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-do-not-use"><span class="status-code-hint mustnot"><span class="icon"><i class="fa fa-times"></i></span> do not use</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>Only use if you are implementing an API for a teapot that does not support
brewing coffee. Response defined for April&#8217;s Fools in
<a href="https://www.rfc-editor.org/rfc/rfc2324.html">RFC 2324</a>.</p>
</div>
</div>
<div class="sect4 do-not-use">
<h5 id="status-code-422"><a class="link" href="#status-code-422">422 Unprocessable Content <a href="https://tools.ietf.org/html/rfc9110#name-422-unprocessable-content" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-do-not-use"><span class="status-code-hint mustnot"><span class="icon"><i class="fa fa-times"></i></span> do not use</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>The server understands the content type, but is unable to process the content.
We do not recommend this code to be used as <a href="#status-code-400" class="status-code">400</a> already covers most use-cases
and there does not seem to be a clear benefit to differentiating between them.</p>
</div>
</div>
<div class="sect4 do-not-use">
<h5 id="status-code-423"><a class="link" href="#status-code-423">423 Locked <a href="https://tools.ietf.org/html/rfc4918#section-11.3" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-document"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> document</span></a> <a href="#put"><code>PUT</code></a> <a href="#patch"><code>PATCH</code></a> <a href="#delete"><code>DELETE</code></a></a></h5>
<div class="paragraph indent">
<p>Pessimistic locking, e.g. processing states. May be used to indicate an
existing resource lock, however, we recommend using optimistic locking instead.
If used, it must be documented to indicate pessimistic locking.</p>
</div>
</div>
<div class="sect4 do-not-use">
<h5 id="status-code-424"><a class="link" href="#status-code-424">424 Failed Dependency <a href="https://tools.ietf.org/html/rfc4918#section-11.4" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-do-not-use"><span class="status-code-hint mustnot"><span class="icon"><i class="fa fa-times"></i></span> do not use</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>The request failed due to failure of a previous request. This is not applicable
to restful APIs.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-428"><a class="link" href="#status-code-428">428 Precondition Required <a href="https://tools.ietf.org/html/rfc6585#section-7.1" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-use"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> use</span></a> <a href="#status-code-do-not-document"><span class="status-code-hint shouldnot"><span class="icon"><i class="fa fa-times"></i></span> do not document</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>Server requires the request to be conditional, e.g. to make sure that the "lost
update problem" is avoided (see <a href="#182"><span class="may-keyword"><strong>MAY</strong></span> consider to support <code>ETag</code> together with <code>If-Match</code>/<code>If-None-Match</code> header</a>). Instead of documenting this response
status, the required headers should be documented (and marked as required).</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-429"><a class="link" href="#status-code-429">429 Too many requests <a href="https://tools.ietf.org/html/rfc6585#section-7.2" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-use"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> use</span></a> <a href="#status-code-do-not-document"><span class="status-code-hint shouldnot"><span class="icon"><i class="fa fa-times"></i></span> do not document</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>The client is not abiding by the rate limits in place and has sent too many
requests (see <a href="#153"><span class="must-keyword"><strong>MUST</strong></span> use code 429 with headers for rate limits</a>).</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-431"><a class="link" href="#status-code-431">431 Request Header Fields Too Large <a href="https://tools.ietf.org/html/rfc6585#section-7.3" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-do-not-document"><span class="status-code-hint shouldnot"><span class="icon"><i class="fa fa-times"></i></span> do not document</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>The server is not able to process the request because the request headers are
too large. Usually used by gateways and proxies with memory limits.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_server_side_error_codes"><a class="link" href="#_server_side_error_codes">Server side error codes</a></h4>
<div class="sect4">
<h5 id="status-code-500"><a class="link" href="#status-code-500">500 Internal Server Error <a href="https://tools.ietf.org/html/rfc9110#name-500-internal-server-error" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-use"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> use</span></a> <a href="#status-code-do-not-document"><span class="status-code-hint shouldnot"><span class="icon"><i class="fa fa-times"></i></span> do not document</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>A generic error indication for an unexpected server execution problem. Clients
should be careful with retrying on this response, since the nature of the
problem is unknown and must be expected to continue.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-501"><a class="link" href="#status-code-501">501 Not Implemented <a href="https://tools.ietf.org/html/rfc9110#name-501-not-implemented" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-document"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> document</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>Server cannot fulfill the request, since the endpoint is not implemented yet.
Usually this implies future availability, but retrying now is not recommended.
May be documented on endpoints that are planned to be implemented in the
future to indicate that they are still not available.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-502"><a class="link" href="#status-code-502">502 Bad Gateway <a href="https://tools.ietf.org/html/rfc9110#name-502-bad-gateway" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph">
<p>[.indent]is meaningless
The server, while acting as a gateway or proxy, received an invalid response
from an inbound server attempting to fulfill the request. May be used by a
server to indicate that an inbound service is creating an unexpected result
instead of <a href="#status-code-500" class="status-code">500</a>. Clients should be careful with retrying on this response,
since the nature of the problem is unknown and must be expected to continue.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-503"><a class="link" href="#status-code-503">503 Service Unavailable <a href="https://tools.ietf.org/html/rfc9110#name-503-service-unavailable" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-use"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> use</span></a> <a href="#status-code-do-not-document"><span class="status-code-hint shouldnot"><span class="icon"><i class="fa fa-times"></i></span> do not document</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>Service is (temporarily) not available, e.g. if a required component or inbound
service is not available. Client are encouraged to retry requests following an
exponential back off pattern. If possible, the service should indicate how long
the client should wait by setting the <a href="https://tools.ietf.org/html/rfc9110#section-10.2.3"><code>Retry-After</code></a> header.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-504"><a class="link" href="#status-code-504">504 Gateway Timeout <a href="https://tools.ietf.org/html/rfc9110#name-504-gateway-timeout" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-use"><span class="status-code-hint should"><span class="icon"><i class="fa fa-check"></i></span> use</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>The server, while acting as a gateway or proxy, did not receive a timely
response. May be used by servers to indicate that an inbound service cannot
process the request fast enough. Client may retry the request immediately
exactly once, to check whether warming up the service solved the problem.</p>
</div>
</div>
<div class="sect4 do-not-use">
<h5 id="status-code-505"><a class="link" href="#status-code-505">505 HTTP Version Not Supported <a href="https://tools.ietf.org/html/rfc9110#name-505-http-version-not-suppor" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-do-not-use"><span class="status-code-hint mustnot"><span class="icon"><i class="fa fa-times"></i></span> do not use</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>The server does not support the HTTP protocol version used in the request.
Technical response code that serves not use case in RESTful APIs.</p>
</div>
</div>
<div class="sect4">
<h5 id="status-code-507"><a class="link" href="#status-code-507">507 Insufficient Storage <a href="https://tools.ietf.org/html/rfc4918#section-11.5" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-do-not-document"><span class="status-code-hint shouldnot"><span class="icon"><i class="fa fa-times"></i></span> do not document</span></a> <a href="#post"><code>POST</code></a> <a href="#put"><code>PUT</code></a> <a href="#patch"><code>PATCH</code></a></a></h5>
<div class="paragraph indent">
<p>The server is unable to store the resource as needed to complete the request.
May be used to indicate that the server is out of disk space.</p>
</div>
</div>
<div class="sect4 do-not-use">
<h5 id="status-code-511"><a class="link" href="#status-code-511">511 Network Authentication Required <a href="https://tools.ietf.org/html/rfc6585#section-7.4" target="_blank" rel="noopener"><sup>RFC</sup></a> <a href="#status-code-do-not-use"><span class="status-code-hint mustnot"><span class="icon"><i class="fa fa-times"></i></span> do not use</span></a> <a href="#http-requests"><code title="Applicable to all HTTP methods.">&lt;all&gt;</code></a></a></h5>
<div class="paragraph indent">
<p>The client needs to authenticate to gain network access. Technical response
code that serves no use case in RESTful APIs.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="220"><a class="link" href="#220"><span class="must-keyword"><strong>MUST</strong></span> use most specific HTTP status codes</a></h3>
<div class="paragraph">
<p>You must use the most specific HTTP status code when returning information
about your request processing status or error situations.</p>
</div>
</div>
<div class="sect2">
<h3 id="152"><a class="link" href="#152"><span class="must-keyword"><strong>MUST</strong></span> use code 207 for batch or bulk requests</a></h3>
<div class="paragraph">
<p>Some APIs are required to provide either <em>batch</em> or <em>bulk</em> requests using
<a href="#post"><code>POST</code></a> for performance reasons, i.e. for communication and processing
efficiency. In this case services may be in need to signal multiple response
codes for each part of a batch or bulk request. As HTTP does not provide
proper guidance for handling batch/bulk requests and responses, we herewith
define the following approach:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A batch or bulk request <strong>always</strong> responds with HTTP status code <a href="#status-code-207" class="status-code">207</a>
unless a non-item-specific failure occurs.</p>
</li>
<li>
<p>A batch or bulk request <strong>may</strong> return <a href="#client-side-error-codes" class="status-code">4xx</a>/<a href="#server-side-error-codes" class="status-code">5xx</a> status codes, if the
failure is non-item-specific and cannot be restricted to individual items of
the batch or bulk request, e.g. in case of overload situations or general
service failures.</p>
</li>
<li>
<p>A batch or bulk response with status code <a href="#status-code-207" class="status-code">207</a> <strong>always</strong> returns as payload
a multi-status response containing item specific status and/or monitoring
information for each part of the batch or bulk request.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note:</strong> These rules apply <em>even in the case</em> that processing of all
individual parts <em>fail</em> or each part is executed <em>asynchronously</em>!</p>
</div>
<div class="paragraph">
<p>The rules are intended to allow clients to act on batch and bulk responses in
a consistent way by inspecting the individual results. We explicitly reject
the option to apply <a href="#status-code-200" class="status-code">200</a> for a completely successful batch as proposed in
Nakadi&#8217;s <a href="https://nakadi.io/manual.html#/event-types/name/events_post"><code>POST
/event-types/{name}/events</code></a> as short cut without inspecting the result, as we
want to avoid  risks and expect clients to handle partial
batch failures anyway.</p>
</div>
<div class="paragraph">
<p>The bulk or batch response may look as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">BatchOrBulkResponse</span>:
  <span class="key">description</span>: <span class="string"><span class="content">batch response object.</span></span>
  <span class="key">type</span>: <span class="string"><span class="content">object</span></span>
  <span class="key">properties</span>:
    <span class="key">items</span>:
      <span class="key">type</span>: <span class="string"><span class="content">array</span></span>
      <span class="key">items</span>:
        <span class="key">type</span>: <span class="string"><span class="content">object</span></span>
        <span class="key">properties</span>:
          <span class="key">id</span>:
            <span class="key">description</span>: <span class="string"><span class="content">Identifier of batch or bulk request item.</span></span>
            <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
          <span class="key">status</span>:
            <span class="key">description</span>: <span class="string"><span class="delimiter">&gt;</span><span class="content">
              Response status value. A number or extensible enum describing
              the execution status of the batch or bulk request items.</span></span>
            <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
            <span class="key">x-extensible-enum</span>: <span class="string"><span class="content">[...]</span></span>
          <span class="key">description</span>:
            <span class="key">description</span>: <span class="string"><span class="delimiter">&gt;</span><span class="content">
              Human readable status description and containing additional
              context information about failures etc.</span></span>
            <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
        <span class="key">required</span>: <span class="string"><span class="content">[id, status]</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note</strong>: while a <em>batch</em> defines a collection of requests triggering
independent processes, a <em>bulk</em> defines a collection of independent
resources created or updated together in one request. With respect to
response processing this distinction normally does not matter.</p>
</div>
</div>
<div class="sect2">
<h3 id="153"><a class="link" href="#153"><span class="must-keyword"><strong>MUST</strong></span> use code 429 with headers for rate limits</a></h3>
<div class="paragraph">
<p>APIs that wish to manage the request rate of clients must use the <a href="#status-code-429" class="status-code">429</a> (Too
Many Requests) response code, if the client exceeded the request rate (see
<a href="https://tools.ietf.org/html/rfc6585">RFC 6585</a>). Such responses must also contain header information
providing further details to the client. There are two approaches a service
can take for header information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Return a <a href="https://tools.ietf.org/html/rfc9110#section-10.2.3"><code>Retry-After</code></a> header indicating how long the client ought to wait
before making a follow-up request. The Retry-After header can contain a HTTP
date value to retry after or the number of seconds to delay. Either is
acceptable but APIs should prefer to use a delay in seconds.</p>
</li>
<li>
<p>Return a trio of <code>X-RateLimit</code> headers. These headers (described below) allow
a server to express a service level in the form of a number of allowing
requests within a given window of time and when the window is reset.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>X-RateLimit</code> headers are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>X-RateLimit-Limit</code>: The maximum number of requests that the client is
allowed to make in this window.</p>
</li>
<li>
<p><code>X-RateLimit-Remaining</code>: The number of requests allowed in the current
window.</p>
</li>
<li>
<p><code>X-RateLimit-Reset</code>: The relative time in seconds when the rate limit window
will be reset. <strong>Beware</strong> that this is different to Github and Twitter&#8217;s
usage of a header with the same name which is using UTC epoch seconds
instead.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The reason to allow both approaches is that APIs can have different
needs. Retry-After is often sufficient for general load handling and
request throttling scenarios and notably, does not strictly require the
concept of a calling entity such as a tenant or named account. In turn
this allows resource owners to minimize the amount of state they have to
carry with respect to client requests. The 'X-RateLimit' headers are
suitable for scenarios where clients are associated with pre-existing
account or tenancy structures. 'X-RateLimit' headers are generally
returned on every request and not just on a 429, which implies the
service implementing the API is carrying sufficient state to track the
number of requests made within a given window for each named entity.</p>
</div>
</div>
<div class="sect2">
<h3 id="176"><a class="link" href="#176"><span class="must-keyword"><strong>MUST</strong></span> support problem JSON</a></h3>
<div class="paragraph">
<p><a href="https://tools.ietf.org/html/rfc9457">RFC 9457</a> defines a Problem JSON object using the media type
<code>application/problem+json</code> to provide an extensible human and machine readable
failure information beyond the HTTP response status code to transports the
failure kind (<code>type</code> / <code>title</code>) and the failure cause and location (<code>instant</code> /
<code>detail</code>). To make best use of this additional failure information, every
endpoints must be capable of returning a Problem JSON on client usage errors
(<a href="#client-side-error-codes" class="status-code">4xx</a> status codes) as well as server side processing errors (<a href="#server-side-error-codes" class="status-code">5xx</a> status
codes).</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> Clients must be robust and <strong>not rely</strong> on a Problem JSON object
being returned, since (a) failure responses may be created by infrastructure
components not aware of this guideline or (b) service may be unable to comply
with this guideline in certain error situations.</p>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> The media type <code>application/problem+json</code> is often not implemented as
a subset of <code>application/json</code> by libraries and services! Thus clients need to
include <code>application/problem+json</code> in the <a href="https://tools.ietf.org/html/rfc9110#section-12.5.1"><code>Accept</code></a>-Header to trigger delivery
of the extended failure information.</p>
</div>
<div class="paragraph">
<p>The OpenAPI schema definition of the Problem JSON object can be found
<a href="https://opensource.zalando.com/restful-api-guidelines/models/problem-1.0.1.yaml">on
GitHub</a>. You can reference it by using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">responses</span>:
  <span class="key">503</span>:
    <span class="key">description</span>: <span class="string"><span class="content">Service Unavailable</span></span>
    <span class="key">content</span>:
      <span class="key"><span class="delimiter">&quot;</span><span class="content">application/problem+json</span><span class="delimiter">&quot;</span></span>:
        <span class="key">schema</span>:
          <span class="error">$ref</span>: <span class="error">'https://opensource.zalando.com/restful-api-guidelines/models/problem-1.0.1.yaml#/Problem'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You may define custom problem types as extensions of the Problem JSON object
if your API needs to return specific, additional, and more detailed error
information.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> Problem <code>type</code> and <code>instance</code> identifiers in our APIs are not meant
to be resolved. <a href="https://tools.ietf.org/html/rfc9457">RFC 9457</a> encourages that problem types are URI
references that point to human-readable documentation, <strong>but</strong> we deliberately
decided against that, as all important parts of the API must be documented
using <a href="#101">OpenAPI</a> anyway. In addition, URLs tend to be fragile and not
very stable over longer periods because of organizational and documentation
changes and descriptions might easily get out of sync.</p>
</div>
<div class="paragraph">
<p>In order to stay compatible with <a href="https://tools.ietf.org/html/rfc9457">RFC 9457</a> we proposed to use
<a href="https://tools.ietf.org/html/rfc3986#section-4.1">relative URI references</a>
usually defined by <code>absolute-path [ '?' query ] [ '#' fragment ]</code> as simplified
identifiers in <code>type</code> and <code>instance</code> fields:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>/problems/out-of-stock</code></p>
</li>
<li>
<p><code>/problems/insufficient-funds</code></p>
</li>
<li>
<p><code>/problems/user-deactivated</code></p>
</li>
<li>
<p><code>/problems/connection-error#read-timeout</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> The use of <a href="https://tools.ietf.org/html/rfc3986#section-4.3">absolute
URIs</a> is not forbidden but strongly discouraged. If you use absolute URIs,
please reference
<a href="https://opensource.zalando.com/restful-api-guidelines/models/problem-1.0.0.yaml#/Problem">problem-1.0.0.yaml#/Problem</a>
instead.</p>
</div>
</div>
<div class="sect2">
<h3 id="177"><a class="link" href="#177"><span class="must-keyword"><strong>MUST</strong></span> not expose stack traces</a></h3>
<div class="paragraph">
<p>Stack traces contain implementation details that are not part of an API,
and on which clients should never rely. Moreover, stack traces can leak
sensitive information that partners and third parties are not allowed to
receive and may disclose insights about vulnerabilities to attackers.</p>
</div>
</div>
<div class="sect2">
<h3 id="251"><a class="link" href="#251"><span class="should-keyword"><strong>SHOULD</strong></span> not use redirection codes</a></h3>
<div class="paragraph">
<p>We generally do not recommend using redirection codes for most API cases (except
for <a href="#status-code-304" class="status-code">304</a>, which is not really a redirection code). Usually you would use the
redirection to migrate clients to a new service location. However, this is
better accomplished by one of the following.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Changing the clients to use the new location in the first place, avoiding
the need for redirection.</p>
</li>
<li>
<p>Redirecting the traffic behind the API layer (e.g. in the reverse proxy or
the app itself) without the client having to be involved.</p>
</li>
<li>
<p>Deprecating the endpoint and removing it as described in <a href="#deprecation">REST Design - Deprecation</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For idempotent <a href="#post"><code>POST</code></a> cases, where you want to inform the client that a resource
already exists at a certain location, you should instead use <a href="#status-code-200" class="status-code">200</a> with the
<a href="https://tools.ietf.org/html/rfc9110#section-10.2.2"><code>Location</code></a> header set. This is along the same lines as the creation case where
<a href="#status-code-201" class="status-code">201</a> is used instead. See also <a href="#229"><span class="should-keyword"><strong>SHOULD</strong></span> consider to design <code>POST</code> and <code>PATCH</code> idempotent</a>.</p>
</div>
<div class="paragraph">
<p>For non-idempotent <a href="#post"><code>POST</code></a> cases, where you want to inform the client that the
resource has already been created and cannot be created again (e.g. payment),
you should return <a href="#status-code-409" class="status-code">409</a> instead of redirecting to make the error case
more explicit.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="headers"><a class="link" href="#headers">11. REST Basics - HTTP headers</a></h2>
<div class="sectionbody">
<div id="standard-headers" class="paragraph">
<p>In this section we explain a handful of (standard) HTTP headers, which we found
most useful in certain situations and that require additional explanation to be
used effectively.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> we generally discourage the usage of proprietary headers. However,
they are sometimes useful to pass generic, service independent, overarching
information relevant for our specific application architecture. We consistently
define these proprietary headers below.</p>
</div>
<div class="paragraph">
<p>Whether a service supports a certain header is part of the service contract.
Therefore APIs should use the <code>parameters</code> and <code>headers</code> definition of the API
endpoint and response to clarify what is supported in a certain context.</p>
</div>
<div class="sect2">
<h3 id="using-headers"><a class="link" href="#using-headers">Using Standard Header definitions</a></h3>
<div class="paragraph">
<p>Usually, you can the standard HTTP request and response header definition
provided by the guideline to simplify API by using well recognized patterns.
The best practice importing headers providing the highest readability is as
follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">path</span>:
  <span class="error">'/resource'</span>
    <span class="key">get</span>:
      <span class="key">parameters</span>:
        - <span class="string"><span class="content">$ref: '#/components/parameters/ETag</span></span>

<span class="key">components</span>:
  <span class="error">parameters|headers</span>:
    <span class="key">ETag</span>:
      <span class="error">$ref</span>: <span class="error">'https://opensource.zalando.com/restful-api-guidelines/models/headers-1.0.0.yaml#/ETag'</span>

  <span class="key">responses</span>:
    <span class="key">Default</span>:
      <span class="key">headers</span>:
        <span class="key">ETag</span>:
          <span class="error">$ref</span>: <span class="error">'#/components/(parameters|headers)/ETag'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> It is a question of taste whether headers for responses are defined in
<code>#/components/headers</code> or <code>#/components/parameters</code>. Unfortunately, headers
in the first section cannot be referenced from a <code>parameters</code>-list, while it is
possible to reference the second also from a <code>headers</code>-list.</p>
</div>
</div>
<div class="sect2">
<h3 id="133"><a class="link" href="#133"><span class="may-keyword"><strong>MAY</strong></span> use standard headers</a></h3>
<div class="paragraph">
<p>APIs may make use of HTTP headers defined by non-obsolete RFCs (see following
list of <a href="http://en.wikipedia.org/wiki/List_of_HTTP_header_fields">standard HTTP
headers</a>). The supported headers must be explicitly mentioned in the API
specification.</p>
</div>
</div>
<div class="sect2">
<h3 id="132"><a class="link" href="#132"><span class="should-keyword"><strong>SHOULD</strong></span> use kebab-case with uppercase separate words for HTTP headers</a></h3>
<div class="paragraph">
<p>This convention is followed by (most of) the standard headers e.g. as defined
in <a href="https://tools.ietf.org/html/rfc2616">RFC 2616</a>, <a href="https://tools.ietf.org/html/rfc4229">RFC 4229</a>, <a href="https://tools.ietf.org/html/rfc9110">RFC 9110</a>. Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">If-Modified-Since
Accept-Encoding
Content-ID
Language</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> The HTTP standard defines headers (now called HTTP fields) to be
case-insensitive (see <a href="https://tools.ietf.org/html/rfc9110#section-5.1">RFC 9110 Section 5.1</a>). However,
for the sake of readability and consistency, you should follow the convention
when defining standard or proprietary headers. Exceptions are common
abbreviations like <code>ID</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="178"><a class="link" href="#178"><span class="must-keyword"><strong>MUST</strong></span> use <code>Content-*</code> headers correctly</a></h3>
<div class="paragraph">
<p>Content or entity headers are headers with a <code>Content-</code> prefix. They describe
the content of the body of the message and they can be used in both, HTTP
requests and responses. Commonly used content headers include but are not
limited to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://tools.ietf.org/html/rfc6266#section-3.1.4.2"><code>Content-Disposition</code></a> can indicate that the representation is supposed to be
saved as a file, and the proposed file name.</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc9110#section-8.4"><code>Content-Encoding</code></a> indicates compression or encryption algorithms applied to
the content.</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc9110#section-8.6"><code>Content-Length</code></a> indicates the length of the content (in bytes).</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc9110#section-8.5"><code>Content-Language</code></a> indicates that the body is meant for people literate in
some human language(s).</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc9110#section-8.7"><code>Content-Location</code></a> indicates where the body can be found otherwise (<a href="#179"><span class="may-keyword"><strong>MAY</strong></span> use <code>Content-Location</code> header</a>
for more details]).</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc9110#section-14.4"><code>Content-Range</code></a> is used in responses to range requests to indicate which part
of the requested resource representation is delivered with the body.</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc9110#section-8.3"><code>Content-Type</code></a> indicates the media type of the body content.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="180"><a class="link" href="#180"><span class="should-keyword"><strong>SHOULD</strong></span> use <code>Location</code> header instead of <code>Content-Location</code> header</a></h3>
<div class="paragraph">
<p>As a correct usage of the <a href="https://tools.ietf.org/html/rfc9110#section-8.7"><code>Content-Location</code></a> response header (see <a href="#179"><span class="may-keyword"><strong>MAY</strong></span> use <code>Content-Location</code> header</a>)
with respect to caching and its method specific semantics is difficult, we
<strong>discourage</strong> the use of <a href="https://tools.ietf.org/html/rfc9110#section-8.7"><code>Content-Location</code></a>. In most cases it is sufficient to
inform clients about the resource location in create or re-direct responses by
using the <a href="https://tools.ietf.org/html/rfc9110#section-10.2.2"><code>Location</code></a> header while avoiding the <a href="https://tools.ietf.org/html/rfc9110#section-8.7"><code>Content-Location</code></a> specific
ambiguities and complexities.</p>
</div>
<div class="paragraph">
<p>For more details see <a href="https://tools.ietf.org/html/rfc9110#section-10.2.2">RFC 9110 Section 10.2.2
Location</a>, <a href="https://tools.ietf.org/html/rfc9110#section-8.7">RFC 9110 Section 8.2 Content-Location</a></p>
</div>
</div>
<div class="sect2">
<h3 id="179"><a class="link" href="#179"><span class="may-keyword"><strong>MAY</strong></span> use <code>Content-Location</code> header</a></h3>
<div class="paragraph">
<p>The <a href="https://tools.ietf.org/html/rfc9110#section-8.7"><code>Content-Location</code></a> response header is an <em>optional</em> header that can be used
in successful write operations (<a href="#put"><code>PUT</code></a>, <a href="#post"><code>POST</code></a>, or <a href="#patch"><code>PATCH</code></a>) and read operations
(<a href="#get"><code>GET</code></a>, <a href="#head"><code>HEAD</code></a>) to guide caching and signal a receiver the actual location of
the resource transmitted in the response body. This allows clients to identify
the resource and to update their local copy when receiving a response with this
header.</p>
</div>
<div class="paragraph">
<p>The <a href="https://tools.ietf.org/html/rfc9110#section-8.7"><code>Content-Location</code></a> header can be used to support the following use cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For reading operations <a href="#get"><code>GET</code></a> and <a href="#head"><code>HEAD</code></a>, a different location than the
requested URL can be used to indicate that the returned resource is subject
to <a href="#244">content negotiations</a>, and that the value provides a more specific
identifier of the resource.</p>
</li>
<li>
<p>For writing operations <a href="#put"><code>PUT</code></a> and <a href="#patch"><code>PATCH</code></a>, an identical location to the
requested URL can be used to explicitly indicate that the returned resource
is the current representation of the newly created or updated resource.</p>
</li>
<li>
<p>For writing operations <a href="#post"><code>POST</code></a> and <a href="#delete"><code>DELETE</code></a>, a content location can be used to
indicate that the body contains a status report resource in response to the
requested action, which is available at provided location.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note:</strong> When using the <a href="https://tools.ietf.org/html/rfc9110#section-8.7"><code>Content-Location</code></a> header, the <a href="https://tools.ietf.org/html/rfc9110#section-8.3"><code>Content-Type</code></a> header
has to be set as well. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">GET /products/123/images HTTP/1.1

HTTP/1.1 200 OK
Content-Type: image/png
Content-Location: /products/123/images?format=raw</code></pre>
</div>
</div>
<div class="paragraph">
<p>See also <a href="#227"><span class="must-keyword"><strong>MUST</strong></span> document cacheable <code>GET</code>, <code>HEAD</code>, and <code>POST</code> endpoints</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="181"><a class="link" href="#181"><span class="may-keyword"><strong>MAY</strong></span> consider to support <code>Prefer</code> header to handle processing preferences</a></h3>
<div class="paragraph">
<p>The <a href="https://tools.ietf.org/html/rfc7240"><code>Prefer</code></a> header defined in <a href="https://tools.ietf.org/html/rfc7240">RFC 7240</a> allows clients to request
processing behaviors from servers. It pre-defines a number of preferences and
is extensible, to allow others to be defined. Support for the <a href="https://tools.ietf.org/html/rfc7240"><code>Prefer</code></a> header
is entirely optional and at the discretion of API designers, but as an existing
Internet Standard, is recommended over defining proprietary "X-" headers for
processing directives.</p>
</div>
<div class="paragraph">
<p>The <a href="https://tools.ietf.org/html/rfc7240"><code>Prefer</code></a> header can be defined in the API specification as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">components</span>:
  <span class="key">parameters</span>:
    <span class="key">Prefer</span>:
        <span class="comment"># Do not import this schema directly, since processing directives are usually</span>
        <span class="comment"># highly customized. Instead, copy the schema to your API and adjust it to</span>
        <span class="comment"># your needs.</span>
        <span class="key">name</span>: <span class="string"><span class="content">Prefer</span></span>
        <span class="key">in</span>: <span class="string"><span class="content">header</span></span>
        <span class="key">required</span>: <span class="string"><span class="content">false</span></span>
        <span class="key">description</span>: <span class="string"><span class="delimiter">|-</span><span class="content">
          The **Prefer** header indicates that a particular server behavior is
          preferred by the client, but is not required for successful completion of
          the request (see [RFC 7240][rfc-7240]. The following behaviors are
          supported by this API:

          * **respond-async** is used to suggest the server to respond as fast as
            possible asynchronously using **202** (Accepted) instead of waiting for
            the result.
          * **return=&lt;minimal|representation&gt;** is used to suggest the server to
            return using **204** (No Content) without resource (minimal) or using
            **200** or **201** with resource (representation) in the response body on
            success.
          * **return=&lt;total-count&gt;** is used to suggest the server to return a total
            result count in a collection requests supporting pagination. Since this
            is a costly operation, it should be used with care, and the service may
            decide to ignore this request.
          * **wait=&lt;delta-seconds&gt;** is used to suggest a maximum time the server has
            time to process the request synchronously.
          * **handling=&lt;strict|lenient&gt;** is used to suggest the server to be strict
            and report error conditions or lenient, i.e. robust and try to continue,
            if possible.

          See [RFC 7340][rfc-7240] as well as [API Guideline Rule #181][api-181]
          for further details.

          [rfc-7240]: &lt;https://tools.ietf.org/html/rfc7240&gt;
          [api-181]: &lt;https://opensource.zalando.com/restful-api-guidelines/#181&gt;</span></span>
        <span class="key">schema</span>:
          <span class="key">type</span>: <span class="string"><span class="content">array</span></span>
          <span class="key">items</span>:
            <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
        <span class="key">style</span>: <span class="string"><span class="content">simple</span></span>
        <span class="key">explode</span>: <span class="string"><span class="content">false</span></span>
        <span class="key">example</span>: <span class="string"><span class="content">[ &quot;respond-async&quot;, &quot;return=minimal&quot;, &quot;wait=20&quot;, &quot;handling=strict&quot;,</span><span class="content">
          &quot;respond-async,return=minimal,wait=20,handling=strict&quot; ]</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> Please, copy only the behaviors into your <a href="https://tools.ietf.org/html/rfc7240"><code>Prefer</code></a> header specification
that are supported by your API endpoint. If necessary, specify different
<a href="https://tools.ietf.org/html/rfc7240"><code>Prefer</code></a> headers for each supported use case.</p>
</div>
<div class="paragraph">
<p>Supporting APIs may return the <a href="https://tools.ietf.org/html/rfc7240#section-3"><code>Preference-Applied</code></a> header also defined in
<a href="https://tools.ietf.org/html/rfc7240">RFC 7240</a> to indicate whether a preference has been applied.</p>
</div>
</div>
<div class="sect2">
<h3 id="182"><a class="link" href="#182"><span class="may-keyword"><strong>MAY</strong></span> consider to support <code>ETag</code> together with <code>If-Match</code>/<code>If-None-Match</code> header</a></h3>
<div class="paragraph">
<p>When creating or updating resources it may be necessary to expose conflicts
and to prevent the <em>lost update</em> or <em>initially created</em> problem. Following
<a href="https://tools.ietf.org/html/rfc9110">RFC 9110 Section 13 "Conditional Requests"</a> this can be best
accomplished by supporting the <a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>ETag</code></a> header together with the <a href="https://tools.ietf.org/html/rfc9110#section-13.1.1"><code>If-Match</code></a> or
<a href="https://tools.ietf.org/html/rfc9110#section-13.1.2"><code>If-None-Match</code></a> conditional header. The contents of an <code>ETag: &lt;entity-tag&gt;</code>
header is either (a) a hash of the response body, (b) a hash of the last
modified field of the entity, or (c) a version number or identifier of the
entity version.</p>
</div>
<div class="paragraph">
<p>To expose conflicts between concurrent update operations via <a href="#put"><code>PUT</code></a>, <a href="#post"><code>POST</code></a>, or
<a href="#patch"><code>PATCH</code></a>, the <code>If-Match: &lt;entity-tag&gt;</code> header can be used to force the server to
check whether the version of the updated entity is conforming to the requested
<a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>&lt;entity-tag&gt;</code></a>. If no matching entity is found, the operation is supposed a to
respond with status code <a href="#status-code-412" class="status-code">412</a> - precondition failed.</p>
</div>
<div class="paragraph">
<p>Beside other use cases, <code>If-None-Match: *</code> can be used in a similar way to
expose conflicts in resource creation. If any matching entity is found, the
operation is supposed a to respond with status code <a href="#status-code-412" class="status-code">412</a> - precondition
failed.</p>
</div>
<div class="paragraph">
<p>The <a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>ETag</code></a>, <a href="https://tools.ietf.org/html/rfc9110#section-13.1.1"><code>If-Match</code></a>, and <a href="https://tools.ietf.org/html/rfc9110#section-13.1.2"><code>If-None-Match</code></a> headers can be defined as follows
in the API specification (see also the default definition below):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">components</span>:
  <span class="error">parameters|headers</span>:
    <span class="key">ETag</span>:
      <span class="error">$ref</span>: <span class="error">'https://opensource.zalando.com/restful-api-guidelines/models/headers-1.0.0.yaml#/ETag'</span>
    <span class="key">If-Match</span>:
      <span class="error">$ref</span>: <span class="error">'https://opensource.zalando.com/restful-api-guidelines/models/headers-1.0.0.yaml#/If-Match'</span>
    <span class="key">If-None-Match</span>:
      <span class="error">$ref</span>: <span class="error">'https://opensource.zalando.com/restful-api-guidelines/models/headers-1.0.0.yaml#/If-None-Match'</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">components</span>:
  <span class="key">headers</span>:
    <span class="key">ETag</span>:
        <span class="key">required</span>: <span class="string"><span class="content">false</span></span>
        <span class="key">description</span>: <span class="string"><span class="delimiter">|-</span><span class="content">
          The **ETag** header field in a response provides an opaque quoted string
          identifying the distinct delivered resource. The same selected resource
          depending on version and representation may be identified by multiple
          identifiers. The **ETag** value is guaranteed to change whenever the
          resource changes, and thereby enabling optimistic updates.

          An identifier consists of an opaque quoted string, possibly prefixed by
          a weakness indicator. See [RFC 9110 Section 8.8.3][rfc-9110-8.8.3] as
          well as [API Guideline Rule #182][api-182] for further details.

          [rfc-9110-8.8.3]: &lt;https://tools.ietf.org/html/rfc9110#section-8.8.3&gt;
          [api-182]: &lt;https://opensource.zalando.com/restful-api-guidelines/#182&gt;</span></span>
        <span class="key">schema</span>:
          <span class="key">type</span>: <span class="string"><span class="content">array</span></span>
          <span class="key">items</span>:
            <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
        <span class="key">style</span>: <span class="string"><span class="content">simple</span></span>
        <span class="key">explode</span>: <span class="string"><span class="content">false</span></span>
        <span class="key">example</span>: <span class="string"><span class="content">[ W/&quot;xy&quot;, &quot;5&quot;, &quot;5db68c06-1a68-11e9-8341-68f728c1ba70&quot; ]</span></span>

    <span class="key">If-Match</span>:
        <span class="key">name</span>: <span class="string"><span class="content">If-Match</span></span>
        <span class="key">in</span>: <span class="string"><span class="content">header</span></span>
        <span class="key">required</span>: <span class="string"><span class="content">false</span></span>
        <span class="key">description</span>: <span class="string"><span class="delimiter">|-</span><span class="content">
          The **If-Match** header field is used to declare a list of identifiers that
          are required to match the current resource version identifier in at least
          one position as a pre-condition for executing the request on the server
          side. This behavior is used to validate and reject optimistic updates, by
          checking if the resource version a consumer has based his changes on is
          outdated on arrival of the change request to prevent lost updates.

          If the pre-condition fails the server will respond with status code **412**
          (Precondition Failed). See [RFC 9110 Section 13.1.1][rfc-9110-13.1.1] as
          well as [API Guideline Rule #182][api-182] for further details.

          [rfc-9110-13.1.1]: &lt;https://tools.ietf.org/html/rfc9110#section-13.1.1&gt;
          [api-182]: &lt;https://opensource.zalando.com/restful-api-guidelines/#182&gt;</span></span>
        <span class="key">schema</span>:
          <span class="key">type</span>: <span class="string"><span class="content">array</span></span>
          <span class="key">items</span>:
            <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
        <span class="key">style</span>: <span class="string"><span class="content">simple</span></span>
        <span class="key">explode</span>: <span class="string"><span class="content">false</span></span>
        <span class="key">example</span>: <span class="string"><span class="content">[ &quot;5db68c06-1a68-11e9-8341-68f728c1ba70&quot;, 'W/&quot;xy&quot;, &quot;5&quot;' ]</span></span>

    <span class="key">If-None-Match</span>:
        <span class="key">name</span>: <span class="string"><span class="content">If-None-Match</span></span>
        <span class="key">in</span>: <span class="string"><span class="content">header</span></span>
        <span class="key">required</span>: <span class="string"><span class="content">false</span></span>
        <span class="key">description</span>: <span class="string"><span class="delimiter">|-</span><span class="content">
          The **If-None-Match header** field is used to declare a list of identifiers
          that are required to fail matching all the current resource version
          identifiers as a pre-condition for executing the request on the server
          side. This is especially used in conjunction with an **\*** (asterix) that
          is matching all possible resource identifiers to ensure the initial
          creation of a resource. Other use cases are possible but rare.

          If the pre-condition fails the server will respond with status code **412**
          (Precondition Failed). See [RFC 9110 Section 13.1.2][rfc-9110-13.1.2] as
          well as [API Guideline Rule #182][api-182] for further details.

          [rfc-9110-13.1.2]: &lt;https://tools.ietf.org/html/rfc9110#section-13.1.2&gt;
          [api-182]: &lt;https://opensource.zalando.com/restful-api-guidelines/#182&gt;</span></span>
        <span class="key">schema</span>:
          <span class="key">type</span>: <span class="string"><span class="content">array</span></span>
          <span class="key">items</span>:
            <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
        <span class="key">style</span>: <span class="string"><span class="content">simple</span></span>
        <span class="key">explode</span>: <span class="string"><span class="content">false</span></span>
        <span class="key">example</span>: <span class="string"><span class="content">[ &quot;5db68c06-1a68-11e9-8341-68f728c1ba70&quot;, 'W/&quot;xy&quot;, &quot;5&quot;' ]</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Please see <a href="#optimistic-locking">Optimistic locking in RESTful APIs</a> for a detailed discussion as well as
<a href="#cache-support-patterns">Cache Support Patterns</a> for additional use cases.</p>
</div>
</div>
<div class="sect2">
<h3 id="230"><a class="link" href="#230"><span class="may-keyword"><strong>MAY</strong></span> consider to support <code>Idempotency-Key</code> header</a></h3>
<div class="paragraph">
<p>When creating or updating resources it can be helpful or necessary to ensure a
strong <a href="#idempotent">idempotent</a> behavior comprising same responses, to prevent duplicate
execution in case of retries after timeout and network outages. Generally, this
can be achieved by sending a client specific <em>unique request key</em> – that is not
part of the resource – via <a href="#230"><code>Idempotency-Key</code></a> header.</p>
</div>
<div class="paragraph">
<p>The <em>unique request key</em> is stored temporarily, e.g. for 24 hours, together
with the response and the request hash (optionally) of the first request in a
key cache, regardless of whether it succeeded or failed. The service can now
look up the <em>unique request key</em> in the key cache and serve the response from
the key cache, instead of re-executing the request, to ensure <a href="#idempotent">idempotent</a>
behavior. Optionally, it can check the request hash for consistency before
serving the response. If the key is not in the key store, the request is
executed as usual and the response is stored in the key cache.</p>
</div>
<div class="paragraph">
<p>This allows clients to safely retry requests after timeouts, network outages,
etc. while receive the same response multiple times. <strong>Note:</strong> The request retry
in this context requires to send the exact same request, i.e. updates of the
request that would change the result are off-limits. The request hash in the
key cache can protection against this misbehavior. The service is recommended
to reject such a request using status code <a href="#status-code-400" class="status-code">400</a>.</p>
</div>
<div class="paragraph">
<p><strong>Important:</strong> To grant a reliable <a href="#idempotent">idempotent</a> execution semantic, the
resource and the key cache have to be updated with hard transaction semantics
– considering all potential pitfalls of failures, timeouts, and concurrent
requests in a distributed systems. This makes a correct implementation
exceeding the local context very hard.</p>
</div>
<div class="paragraph">
<p>The <a href="#230"><code>Idempotency-Key</code></a> header must be defined as follows, but you are free to
choose your expiration time:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">components</span>:
  <span class="key">parameters</span>:
    <span class="key">Idempotency-Key</span>:
        <span class="key">name</span>: <span class="string"><span class="content">Idempotency-Key</span></span>
        <span class="key">in</span>: <span class="string"><span class="content">header</span></span>
        <span class="key">required</span>: <span class="string"><span class="content">false</span></span>
        <span class="key">description</span>: <span class="string"><span class="delimiter">|-</span><span class="content">
          The **Idempotency-Key** is a free identifier created by the client to
          identify a request. It is used by the service to identify repeated request
          to ensure idempotent behavior by sending the same (or a similar) response
          without executing the request a second time.

          Clients should be careful as any subsequent requests with the same key may
          return the same response without further check. Thus, it is recommended to
          use a UUID version 4 (random) or any other random string with enough
          entropy to avoid collisions.

          Keys expire after 24 hours. Clients are responsible to stay within this
          limit, if they require idempotent behavior.

          See [API Guideline Rule #181][api-230] for further details.

          [api-230]: &lt;https://opensource.zalando.com/restful-api-guidelines/#230&gt;</span></span>
        <span class="key">schema</span>:
          <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
          <span class="key">format</span>: <span class="string"><span class="content">uuid</span></span>
        <span class="key">example</span>: <span class="string"><span class="content">[ &quot;7da7a728-f910-11e6-942a-68f728c1ba70&quot; ]</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you do not want to change the expiration time, you can also use the standard
definition provided by the guideline:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">components</span>:
  <span class="error">parameters|headers</span>:
    <span class="key">Idempotency-Key</span>:
      <span class="error">$ref</span>: <span class="error">'https://opensource.zalando.com/restful-api-guidelines/models/headers-1.0.0.yaml#/Idempotency-Key'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> The key cache is not intended as request log, and therefore should
have a limited lifetime, else it could easily exceed the data resource in
size.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> The <a href="#230"><code>Idempotency-Key</code></a> header unlike other headers in this section
is not standardized in an RFC. Our only reference are the usage in the
<a href="https://stripe.com/docs/api/idempotent_requests">Stripe API</a>.
However, we do not want to change the header name and semantic, and
do not name it like the proprietary headers below.
The header addresses a generic REST concern and is different from the
Zalando landscape specific proprietary headers.</p>
</div>
</div>
<div class="sect2">
<h3 id="183"><a class="link" href="#183"><span class="should-keyword"><strong>SHOULD</strong></span> use only the specified proprietary Zalando headers</a></h3>
<div class="paragraph">
<p>As a general rule, proprietary HTTP headers should be avoided. In addition
from a conceptual point of view, the business semantics and intent of an
operation should always be expressed via the path and query parameters, the
method, and the content, but not via proprietary headers.</p>
</div>
<div class="paragraph">
<p>Headers are typically used to implement protocol processing aspects, such as
flow control, content negotiation, and authentication, and represent business
agnostic request modifiers that provide generic context information
(<a href="https://tools.ietf.org/html/rfc9110#section-10">RFC 9110 Section 10 "Message Context"</a>).</p>
</div>
<div class="paragraph">
<p>However, the exceptional usage of proprietary headers is still helpful when
domain-specific generic context information</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>needs to be passed <em>end-to-end</em> along the service call chain (even if not
all called services use it as input for steering service behavior, e.g.
<a href="#x-sales-channel"><code>X-Sales-Channel</code></a> header), and/or</p>
</li>
<li>
<p>is provided by specific gateway components, for instance, our Fashion Shop
API or Merchant API gateway.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Below, we explicitly define the list of proprietary headers usable for all
services for passing through generic context information of our fashion domain
(use case 1).</p>
</div>
<div class="paragraph">
<p>Per convention, non standardized, proprietary header names are prefixed with
<code>X-</code> and use the dash (<code>-</code>) as separator (dash-case). (Due to backward
compatibility, we do not follow the recommendation of Internet Engineering
Task Force in <a href="https://tools.ietf.org/html/rfc6648">RFC 6648</a> to deprecate the usage of  `X-`headers.)
Remember that HTTP header field names are not case-sensitive:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 10%;">
<col style="width: 60%;">
<col style="width: 15%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Header field name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Header field value example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="x-flow-id"></a><a href="#x-flow-id"><code>X-Flow-ID</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For more information see <a href="#233"><span class="must-keyword"><strong>MUST</strong></span> support <code>X-Flow-ID</code></a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GKY7oDhpSiKY_gAAAABZ_A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="x-tenant-id"></a><a href="#x-tenant-id"><code>X-Tenant-ID</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the tenant initiated the request
to the multi tenant Zalando Platform. The <a href="#x-tenant-id"><code>X-Tenant-ID</code></a> must be set
according to the Business Partner ID extracted from the OAuth token when
a request from a Business Partner hits the Zalando Platform.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9f8b3ca3-4be5-436c-a847-9cd55460c495</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="x-sales-channel"></a><a href="#x-sales-channel"><code>X-Sales-Channel</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sales channels are owned by retailers and represent a specific consumer segment
being addressed with a specific product assortment that is offered via CFA
retailer catalogs to consumers (see <a href="https://digital-experience.docs.zalando.net/glossary/glossary.html">fashion platform glossary
(internal link)</a>).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">52b96501-0f8d-43e7-82aa-8a96fab134d7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="x-frontend-type"></a><a href="#x-frontend-type"><code>X-Frontend-Type</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Consumer facing applications (CFAs) provide business experience to their
customers via different frontend application types, for instance, mobile app
or browser. Info should be passed-through as generic aspect&#8201;&#8212;&#8201;there are
diverse concerns, e.g. pushing mobiles with specific coupons, that make use of
it. Current range is mobile-app, browser, facebook-app, chat-app, email.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mobile-app</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="x-device-type"></a><a href="#x-device-type"><code>X-Device-Type</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">There are also use cases for steering customer experience (incl. features and
content) depending on device type. Via this header info should be passed-through
as generic aspect. Current range is smartphone, tablet, desktop, other.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tablet</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="x-device-os"></a><a href="#x-device-os"><code>X-Device-OS</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">On top of device type above, we even want to differ between device platform,
e.g. smartphone Android vs. iOS. Via this header info should be passed-through
as generic aspect. Current range is iOS, Android, Windows, Linux, MacOS.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Android</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="x-mobile-advertising-id"></a><a href="#x-mobile-advertising-id"><code>X-Mobile-Advertising-ID</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">It is either the
<a href="https://developer.apple.com/documentation/adsupport/asidentifiermanager">IDFA</a>
(Apple Identifier for mobile Advertising) for iOS, or the
<a href="https://support.google.com/googleplay/android-developer/answer/6048248">GAID</a>
(Google mobile Advertising Identifier) for Android. It is a unique,
customer-resettable identifier provided by mobile device’s operating system
to facilitate personalized advertising, and usually passed by mobile apps via
HTTP header when calling backend services. Called services should be ready to
pass this parameter through when calling other services. It is not sent if the
customer disables it in the settings for respective mobile platform.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">b89fadce-1f42-46aa-9c83-b7bc49e76e1f</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Exception:</strong> The only exception to this guideline are the conventional
hop-by-hop <code>X-RateLimit-</code> headers which can be used as defined in <a href="#153"><span class="must-keyword"><strong>MUST</strong></span> use code 429 with headers for rate limits</a>.</p>
</div>
<div class="paragraph">
<p>As part of the guidelines we provide the default definition of all proprietary
headers, so you can simply reference them when defining the API endpoint. For
details see <a href="#using-headers">Using Standard Header definitions</a>.</p>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> This guideline does not standardize proprietary headers for our
specific gateway components (2. use case above). This include, for instance,
non pass-through headers <code>X-Zalando-Customer</code>, <code>X-Zalando-Client-ID</code>,
<code>X-Zalando-Request-Host</code>, <code>X-Zalando-Request-URI</code> defined by Fashion Shop API
(RKeep), or <code>X-Consumer</code>, <code>X-Consumer-Signature</code>, <code>X-Consumer-Key-ID</code> defined
by Merchant API gateway. All these proprietary headers are allowlisted in the
API Linter (Zally) checking this rule.</p>
</div>
</div>
<div class="sect2">
<h3 id="184"><a class="link" href="#184"><span class="must-keyword"><strong>MUST</strong></span> propagate proprietary headers</a></h3>
<div class="paragraph">
<p>All Zalando&#8217;s proprietary headers defined in <a href="#183"><span class="should-keyword"><strong>SHOULD</strong></span> use only the specified proprietary Zalando headers</a> are end-to-end headers
<sup class="footnote" id="_footnote_header-types">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup> and must be propagated to the services down the call
chain. The header names and values must remain unchanged.</p>
</div>
<div class="paragraph">
<p>For example, the values of the custom headers like <a href="#x-device-type"><code>X-Device-Type</code></a> can affect
the results of queries by using device type information to influence
recommendation results. Besides, the values of the custom headers can influence
the results of the queries (e.g. the device type information influences the
recommendation results).</p>
</div>
<div class="paragraph">
<p>Sometimes the value of a proprietary header will be used as part of the entity
in a subsequent request. In such cases, the proprietary headers must still be
propagated as headers with the subsequent request, despite the duplication of
information.</p>
</div>
</div>
<div class="sect2">
<h3 id="233"><a class="link" href="#233"><span class="must-keyword"><strong>MUST</strong></span> support <a href="#x-flow-id"><code>X-Flow-ID</code></a></a></h3>
<div class="paragraph">
<p>The <a href="#flow-id"><code>Flow-ID</code></a> is a generic parameter to be passed through service APIs and
events and written into log files and traces. A consequent usage of the
<a href="#flow-id"><code>Flow-ID</code></a> facilitates the tracking of call flows through our system and allows
the correlation of service activities initiated by a specific call. This is
extremely helpful for operational troubleshooting and log analysis. Main use
case of <a href="#flow-id"><code>Flow-ID</code></a> is to track service calls of our SaaS fashion commerce
platform and initiated internal processing flows (executed synchronously via
APIs or asynchronously via published events).</p>
</div>
<div class="sect3">
<h4 id="_data_definition"><a class="link" href="#_data_definition">Data Definition</a></h4>
<div class="paragraph">
<p>The <a href="#flow-id"><code>Flow-ID</code></a> must be passed through:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RESTful API requests via <a href="#x-flow-id"><code>X-Flow-ID</code></a> proprietary header (see <a href="#184"><span class="must-keyword"><strong>MUST</strong></span> propagate proprietary headers</a>)</p>
</li>
<li>
<p>Published events via <code>flow_id</code> event field (see <a href="#event-metadata">metadata</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following formats are allowed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>UUID</code> (<a href="https://tools.ietf.org/html/rfc4122">RFC-4122</a>)</p>
</li>
<li>
<p><code>base64</code> (<a href="https://tools.ietf.org/html/rfc4648">RFC-4648</a>)</p>
</li>
<li>
<p><code>base64url</code> (<a href="https://tools.ietf.org/html/rfc4648#section-5">RFC-4648 Section 5</a>)</p>
</li>
<li>
<p>Random unique string restricted to the character set <code>[a-zA-Z0-9/+_-=]</code>
maximal of 128 characters.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note:</strong> If a legacy subsystem can only process <code>Flow-IDs</code> with a specific
format or length, it must define this restriction in its API specification,
and be generous and remove invalid characters or cut the length to the
supported limit.</p>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> In case distributed tracing is supported by
<a href="https://github.bus.zalan.do/SRE/opentracing">OpenTracing (internal link)</a> you should ensure that created
<em>spans</em> are tagged using <code>flow_id</code> — see
<a href="https://github.bus.zalan.do/SRE/opentracing/blob/master/wg-semantic-conventions/best-practices/flowid.md">How
to Connect Log Output with OpenTracing Using Flow-IDs (internal link)</a>  or
<a href="https://github.bus.zalan.do/SRE/opentracing/blob/master/wg-semantic-conventions/best-practices.md">Best
practices (internal link)</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_service_guidance"><a class="link" href="#_service_guidance">Service Guidance</a></h4>
<div class="ulist">
<ul>
<li>
<p>Services <strong>must</strong> support <a href="#flow-id"><code>Flow-ID</code></a> as generic input, i.e.</p>
<div class="ulist">
<ul>
<li>
<p>RESTful API endpoints <strong>must</strong> support <a href="#x-flow-id"><code>X-Flow-ID</code></a> header in requests</p>
</li>
<li>
<p>Event listeners <strong>must</strong> support the metadata <code>flow-id</code> from events.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note:</strong> API-Clients <strong>must</strong> provide <a href="#flow-id"><code>Flow-ID</code></a> when calling a service or
producing events. If no <a href="#flow-id"><code>Flow-ID</code></a> is provided in a request or event, the
service must create a new <a href="#flow-id"><code>Flow-ID</code></a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Services <strong>must</strong> propagate <a href="#flow-id"><code>Flow-ID</code></a>, i.e. use <a href="#flow-id"><code>Flow-ID</code></a> received
with API calls or consumed events as&#8230;&#8203;</p>
<div class="ulist">
<ul>
<li>
<p>input for all API called and events published during processing</p>
</li>
<li>
<p>data field written for logging and tracing</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> This rule also applies to application internal interfaces and events
not published via Nakadi (but e.g. via AWS SQS, Kinesis or service specific
DB solutions).</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="hypermedia"><a class="link" href="#hypermedia">12. REST Design - Hypermedia</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="162"><a class="link" href="#162"><span class="must-keyword"><strong>MUST</strong></span> use REST maturity level 2</a></h3>
<div class="paragraph">
<p>We strive for a good implementation of
<a href="http://martinfowler.com/articles/richardsonMaturityModel.html#level2">REST
Maturity Level 2</a> as it enables us to build resource-oriented APIs that
make full use of HTTP verbs and status codes. You can see this expressed
by many rules throughout these guidelines, e.g.:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#138"><span class="must-keyword"><strong>MUST</strong></span> avoid actions — think about resources</a></p>
</li>
<li>
<p><a href="#141"><span class="must-keyword"><strong>MUST</strong></span> keep URLs verb-free</a></p>
</li>
<li>
<p><a href="#148"><span class="must-keyword"><strong>MUST</strong></span> use HTTP methods correctly</a></p>
</li>
<li>
<p><a href="#150"><span class="should-keyword"><strong>SHOULD</strong></span> only use most common HTTP status codes</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Although this is not HATEOAS, it should not prevent you from designing
proper link relationships in your APIs as stated in rules below.</p>
</div>
</div>
<div class="sect2">
<h3 id="163"><a class="link" href="#163"><span class="may-keyword"><strong>MAY</strong></span> use REST maturity level 3 - HATEOAS</a></h3>
<div class="paragraph">
<p>We do not generally recommend to implement
<a href="http://martinfowler.com/articles/richardsonMaturityModel.html#level3">REST
Maturity Level 3</a>. HATEOAS comes with additional API complexity without
real value in our SOA context where client and server interact via REST
APIs and provide complex business functions as part of our e-commerce
SaaS platform.</p>
</div>
<div class="paragraph">
<p>Our major concerns regarding the promised advantages of HATEOAS (see
also
<a href="https://www.infoq.com/news/2014/03/rest-at-odds-with-web-apis">RESTistential
Crisis over Hypermedia APIs</a>,
<a href="https://jeffknupp.com/blog/2014/06/03/why-i-hate-hateoas/">Why I Hate
HATEOAS</a> and others for a detailed discussion):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We follow the <a href="#100">API First principle</a> with APIs explicitly defined
outside the code with standard specification language. HATEOAS does not
really add value for SOA client engineers in terms of API
self-descriptiveness: a client engineer finds necessary links and usage
description (depending on resource state) in the API reference definition
anyway.</p>
</li>
<li>
<p>Generic HATEOAS clients which need no prior knowledge about APIs and
explore API capabilities based on hypermedia information provided, is a
theoretical concept that we haven&#8217;t seen working in practice and does not
fit to our SOA set-up. The OpenAPI description format (and tooling based
on OpenAPI) doesn&#8217;t provide sufficient support for HATEOAS either.</p>
</li>
<li>
<p>In practice relevant HATEOAS approximations (e.g. following specifications
like HAL or JSON API) support API navigation by abstracting from URL
endpoint and HTTP method aspects via link types. So, Hypermedia does not
prevent clients from required manual changes when domain model changes
over time.</p>
</li>
<li>
<p>Hypermedia make sense for humans, less for SOA machine clients. We would
expect use cases where it may provide value more likely in the frontend and
human facing service domain.</p>
</li>
<li>
<p>Hypermedia does not prevent API clients to implement shortcuts and directly
target resources without 'discovering' them.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However, we do not forbid HATEOAS; you could use it, if you checked its
limitations and still see clear value for your usage scenario that justifies
its additional complexity. If you use HATEOAS please share experience and
present your findings in the <a href="https://api.docs.zalando.net/">API Guild (internal_link)</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="164"><a class="link" href="#164"><span class="must-keyword"><strong>MUST</strong></span> use common hypertext controls</a></h3>
<div class="paragraph">
<p>When embedding links to other resources into representations you must use the
common hypertext control object. It contains at least one attribute:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="href"></a><a href="#href"><code>href</code></a>: The URI of the resource the hypertext control is linking to.
All our API are using HTTP(s) as URI scheme.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In API that contain any hypertext controls, the attribute name <a href="#href"><code>href</code></a> is
reserved for usage within hypertext controls.</p>
</div>
<div class="paragraph">
<p>The schema for hypertext controls can be derived from this model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">HttpLink</span>:
  <span class="key">description</span>: <span class="string"><span class="content">A base type of objects representing links to resources.</span></span>
  <span class="key">type</span>: <span class="string"><span class="content">object</span></span>
  <span class="key">properties</span>:
    <span class="key">href</span>:
      <span class="key">description</span>: <span class="string"><span class="content">Any URI that is using http or https protocol</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">format</span>: <span class="string"><span class="content">uri</span></span>
  <span class="key">required</span>:
    - <span class="string"><span class="content">href</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The name of an attribute holding such a <code>HttpLink</code> object specifies the
relation between the object that contains the link and the linked resource.
Implementations should use names from the <a href="http://www.iana.org/assignments/link-relations">IANA Link Relation Registry</a>
whenever appropriate. As IANA link relation
names use hyphen-case notation, while this guide enforces snake_case
notation for attribute names, hyphens in IANA names have to be replaced
with underscores (e.g. the IANA link relation type <code>version-history</code>
would become the attribute <code>version_history</code>)</p>
</div>
<div class="paragraph">
<p>Specific link objects may extend the basic link type with additional
attributes, to give additional information related to the linked
resource or the relationship between the source resource and the linked
one.</p>
</div>
<div class="paragraph">
<p>E.g. a service providing "Person" resources could model a person who is
married with some other person with a hypertext control that contains
attributes which describe the other person (<code>id</code>, <code>name</code>) but also the
relationship "spouse" between the two persons (<code>since</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">446f9876-e89b-12d3-a456-426655440000</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Peter Mustermann</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">spouse</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">https://...</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">since</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">1996-12-19</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">123e4567-e89b-12d3-a456-426655440000</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Linda Mustermann</span><span class="delimiter">&quot;</span></span>
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Hypertext controls are allowed anywhere within a JSON model. While this
specification would allow
<a href="http://stateless.co/hal_specification.html">HAL</a>, we actually don&#8217;t
recommend/enforce the usage of HAL anymore as the structural separation
of meta-data and data creates more harm than value to the
understandability and usability of an API.</p>
</div>
</div>
<div class="sect2">
<h3 id="165"><a class="link" href="#165"><span class="should-keyword"><strong>SHOULD</strong></span> use simple hypertext controls for pagination and self-references</a></h3>
<div class="paragraph">
<p>For pagination and self-references a simplified form of the <a href="#164">extensible
common hypertext controls</a> should be used to reduce the specification and
cognitive overhead. It consists of a simple URI value in combination with the
corresponding <a href="http://www.iana.org/assignments/link-relations">link relations</a>, e.g. <a href="#next"><code>next</code></a>, <a href="#prev"><code>prev</code></a>, <a href="#first"><code>first</code></a>,
<a href="#last"><code>last</code></a>, or <a href="#self"><code>self</code></a>.</p>
</div>
<div class="paragraph">
<p>See <a href="#164"><span class="must-keyword"><strong>MUST</strong></span> use common hypertext controls</a> and <a href="#161"><span class="should-keyword"><strong>SHOULD</strong></span> use pagination links</a> for more information and examples.</p>
</div>
</div>
<div class="sect2">
<h3 id="217"><a class="link" href="#217"><span class="must-keyword"><strong>MUST</strong></span> use full, absolute URI for resource identification</a></h3>
<div class="paragraph">
<p>Links to other resource must always use full, absolute URI.</p>
</div>
<div class="paragraph">
<p><strong>Motivation</strong>: Exposing any form of relative URI (no matter if the relative
URI uses an absolute or relative path) introduces avoidable client side
complexity. It also requires clarity on the base URI, which might not be given
when using features like embedding subresources. The primary advantage of
non-absolute URI is reduction of the payload size, which is better achievable
by following the recommendation to use <a href="#156">gzip compression</a></p>
</div>
</div>
<div class="sect2">
<h3 id="166"><a class="link" href="#166"><span class="must-keyword"><strong>MUST</strong></span> not use link headers with JSON entities</a></h3>
<div class="paragraph">
<p>For flexibility and precision, we prefer links to be directly embedded in the
JSON payload instead of being attached using the uncommon link header syntax.
As a result, the use of the <a href="https://tools.ietf.org/html/rfc8288#section-3"><code>Link</code> Header defined by RFC
8288</a> in conjunction with JSON media types is forbidden.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performance"><a class="link" href="#performance">13. REST Design - Performance</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="155"><a class="link" href="#155"><span class="should-keyword"><strong>SHOULD</strong></span> reduce bandwidth needs and improve responsiveness</a></h3>
<div class="paragraph">
<p>APIs should support techniques for reducing bandwidth based on client needs.
This holds for APIs that (might) have high payloads and/or are used in
high-traffic scenarios like the public Internet and telecommunication networks.
Typical examples are APIs used by mobile web app clients with (often) less
bandwidth connectivity. (Zalando is a 'Mobile First' company, so be mindful of
this point.)</p>
</div>
<div class="paragraph">
<p>Common techniques include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>compression of request and response bodies (see <a href="#156"><span class="should-keyword"><strong>SHOULD</strong></span> use <code>gzip</code> compression</a>)</p>
</li>
<li>
<p>querying field filters to retrieve a subset of resource attributes (see
<a href="#157"><span class="should-keyword"><strong>SHOULD</strong></span> support partial responses via filtering</a> below)</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>ETag</code></a> and <a href="https://tools.ietf.org/html/rfc9110#section-13.1.1"><code>If-Match</code></a>/<a href="https://tools.ietf.org/html/rfc9110#section-13.1.2"><code>If-None-Match</code></a> headers to avoid re-fetching of
unchanged resources (see <a href="#182"><span class="may-keyword"><strong>MAY</strong></span> consider to support <code>ETag</code> together with <code>If-Match</code>/<code>If-None-Match</code> header</a>)</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc7240"><code>Prefer</code></a> header with <code>return=minimal</code> or <code>respond-async</code> to anticipate reduced
processing requirements of clients (see <a href="#181"><span class="may-keyword"><strong>MAY</strong></span> consider to support <code>Prefer</code> header to handle processing preferences</a>)</p>
</li>
<li>
<p><a href="#pagination">REST Design - Pagination</a> for incremental access of larger collections of data items</p>
</li>
<li>
<p>caching of master data items, i.e. resources that change rarely or not
at all after creation (see <a href="#227"><span class="must-keyword"><strong>MUST</strong></span> document cacheable <code>GET</code>, <code>HEAD</code>, and <code>POST</code> endpoints</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each of these items is described in greater detail below.</p>
</div>
</div>
<div class="sect2">
<h3 id="156"><a class="link" href="#156"><span class="should-keyword"><strong>SHOULD</strong></span> use <code>gzip</code> compression</a></h3>
<div class="paragraph">
<p>A servers and clients should support <code>gzip</code> content encoding to reduce the data
transported over the network and thereby speed up response times, unless there
is a good reason against this. Good reasons against compression are:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The content is already compressed, or</p>
</li>
<li>
<p>The server has not enough resources to support compression.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>While <code>gzip</code> content encoding should be the default, servers must also support
unencoded content for testing. This is ensured by content negotiation using the
<a href="https://tools.ietf.org/html/rfc9110#section-12.5.3"><code>Accept-Encoding</code></a> request header (see <a href="https://tools.ietf.org/html/rfc9110#section-12.5.3">RFC 9110
Section 12.5.3</a>). Successful compression is signaled via the <a href="https://tools.ietf.org/html/rfc9110#section-8.4"><code>Content-Encoding</code></a>
response header (see <a href="https://tools.ietf.org/html/rfc9110#section-8.4">RFC 9110 Section 8.4</a>). Clients and
servers may support other compression algorithms as <code>compress</code>, <code>deflate</code>, or
<code>br</code>.</p>
</div>
<div class="paragraph">
<p>To signal server support for compression the API specification should define
both, the <a href="https://tools.ietf.org/html/rfc9110#section-12.5.3"><code>Accept-Encoding</code></a> request header and the <a href="https://tools.ietf.org/html/rfc9110#section-8.4"><code>Content-Encoding</code></a> response
header. This can be done by simply referencing the standard header definitions
as follows (see also the default definition below):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">components</span>:
  <span class="error">parameters|headers</span>:
    <span class="key">Accept-Encoding</span>:
      <span class="error">$ref</span>: <span class="error">'https://opensource.zalando.com/restful-api-guidelines/models/headers-1.0.0.yaml#/Accept-Encoding'</span>
    <span class="key">Content-Encoding</span>:
      <span class="error">$ref</span>: <span class="error">'https://opensource.zalando.com/restful-api-guidelines/models/headers-1.0.0.yaml#/Content-Encoding'</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">components</span>:
  <span class="key">parameters</span>:
    <span class="key">Accept-Encoding</span>:
        <span class="key">name</span>: <span class="string"><span class="content">Accept-Encoding</span></span>
        <span class="key">in</span>: <span class="string"><span class="content">header</span></span>
        <span class="key">required</span>: <span class="string"><span class="content">false</span></span>
        <span class="key">description</span>: <span class="string"><span class="delimiter">|-</span><span class="content">
          The **Accept-Encoding** indicates the content encoding (usually a
          compression algorithm) the client understands. The server selects one of
          the proposed encodings and returns his choice in the **Content-Encoding**
          response header.

          Supported compression algorithms of the server are [**gzip**][gzip] and
          **identity**, but other encodings from list below may be support too:

          * **gzip** - a compression format that uses [Lempel-Ziv coding][gzip]
            (LZ77) with a 32-bit CRC.
          * **compress** - a format using the [Lempel-Ziv-Welch][lzw] (LZW)
            algorithm.
          * **deflate** - A compression format that uses the [zlib][zlib] structure
            with the [deflate][deflate] compression algorithm.
          * **br** - a compression format that uses the [Brotli][brotli] algorithm.
          * **identity** - the identity function without modification or compression
            used to indicate unchanged responses. This value is always considered as
            acceptable, even if omitted.

          The server may choose not to compress the body of the response, if the
          identity value is acceptable, e.g. if the content is already compressed
          (e.g. for JPEG content), or if the server is missing resources to perform
          the compression operation.

          **Note:** A client is allowed to explicitly forbid the identity value by
          setting **identity;q=0** or **\*;q=0**, however, the server in return may
          respond with a **406** (Not Acceptable) error.

          See [RFC 9110 Section 12.5.3][rfc-9110-12.5.3] as well as [API Guideline
          Rule #156][api-156] for further details.

          [rfc-9110-12.5.3]: &lt;https://tools.ietf.org/html/rfc9110#section-12.5.3&gt;
          [api-156]: &lt;https://opensource.zalando.com/restful-api-guidelines/#156&gt;
          [gzip]: &lt;https://en.wikipedia.org/wiki/LZ77_and_LZ78#LZ77&gt;
          [lzw]: &lt;https://en.wikipedia.org/wiki/LZW&gt;
          [zlib]: &lt;https://en.wikipedia.org/wiki/Zlib&gt;
          [deflate]: &lt;https://en.wikipedia.org/wiki/DEFLATE&gt;
          [brotli]: &lt;https://en.wikipedia.org/wiki/Brotli&gt;</span></span>
        <span class="key">schema</span>:
          <span class="key">type</span>: <span class="string"><span class="content">array</span></span>
          <span class="key">items</span>:
            <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
        <span class="key">style</span>: <span class="string"><span class="content">simple</span></span>
        <span class="key">explode</span>: <span class="string"><span class="content">false</span></span>
        <span class="key">example</span>: <span class="string"><span class="content">[ &quot;gzip&quot;, &quot;gzip;q=0.8,deflate;q=0.2&quot;, &quot;gzip;q=0.9,identity;q=0&quot; ]</span></span>

<span class="key">components</span>:
  <span class="key">headers</span>:
    <span class="key">Content-Encoding</span>:
        <span class="key">required</span>: <span class="string"><span class="content">false</span></span>
        <span class="key">description</span>: <span class="string"><span class="delimiter">|-</span><span class="content">
          The **Content-Encoding** header lists any encoding (usually a compression
          algorithm) applied to the message payload - in execution order. This allows
          the recipient to decode the content in order to obtain the original payload
          format.

          Supported compression algorithms of the server are [**gzip**][gzip] and
          **identity**, but other encoding from list below may be support too:

          * **gzip** - a compression format that uses [Lempel-Ziv coding][gzip]
            (LZ77) with a 32-bit CRC.
          * **compress** - a format using the [Lempel-Ziv-Welch][lzw] (LZW)
            algorithm.
          * **deflate** - A compression format that uses the [zlib][zlib] structure
            with the [deflate][deflate] compression algorithm.
          * **br** - a compression format that uses the [Brotli][brotli] algorithm.
          * **identity** - the identity function without modification or compression
            used to indicate unchanged responses. This value is always considered as
            acceptable, even if omitted.

          **Note:** the original media/content type is specified in the
          **Content-Type**-header, while the **Content-Encoding** applies to the
          representation of the data. If the original media is encoded in some way,
          e.g. as a zip file, then this information is not be included in the
          **Content-Encoding** header.

          See [RFC 9110 Section 8.4][rfc-9110-8.4] as well as [API Guideline Rule
          #156][api-156] for further details.

          [rfc-9110-8.4]: &lt;https://tools.ietf.org/html/rfc9110#section-8.4&gt;
          [api-156]: &lt;https://opensource.zalando.com/restful-api-guidelines/#156&gt;
          [gzip]: &lt;https://en.wikipedia.org/wiki/LZ77_and_LZ78#LZ77&gt;
          [lzw]: &lt;https://en.wikipedia.org/wiki/LZW&gt;
          [zlib]: &lt;https://en.wikipedia.org/wiki/Zlib&gt;
          [deflate]: &lt;https://en.wikipedia.org/wiki/DEFLATE&gt;
          [brotli]: &lt;https://en.wikipedia.org/wiki/Brotli&gt;</span></span>
        <span class="key">schema</span>:
          <span class="key">type</span>: <span class="string"><span class="content">array</span></span>
          <span class="key">items</span>:
            <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
        <span class="key">style</span>: <span class="string"><span class="content">simple</span></span>
        <span class="key">explode</span>: <span class="string"><span class="content">false</span></span>
        <span class="key">example</span>: <span class="string"><span class="content">[ &quot;gzip&quot;, &quot;deflate&quot;, &quot;gzip,deflate&quot; ]</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> since most server and client frameworks still <strong>do not</strong> support
<code>gzip</code>-compression <strong>out-of-the-box</strong> you need to manually activate it, e.g.
<a href="https://www.callicoder.com/configuring-spring-boot-application/#enabling-gzip-compression-in-spring-boot">Spring Boot</a>,
or add a dedicated middleware, e.g. <a href="https://github.com/gin-contrib/gzip#usage">gin-gionic/gin</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="157"><a class="link" href="#157"><span class="should-keyword"><strong>SHOULD</strong></span> support partial responses via filtering</a></h3>
<div class="paragraph">
<p>Depending on your use case and payload size, you can significantly reduce
network bandwidth need by supporting filtering of returned entity fields.
Here, the client can explicitly determine the subset of fields he wants to
receive via the <a href="#fields"><code>fields</code></a> query parameter. (It is analogue to
<a href="https://graphql.org/learn/queries/#fields">GraphQL <code>fields</code></a> and simple
queries, and also applied, for instance, for
<a href="https://cloud.google.com/storage/docs/json_api/v1/how-tos/performance#partial-response">Google
Cloud API&#8217;s partial responses</a>.)</p>
</div>
<div class="sect3">
<h4 id="unfiltered"><a class="link" href="#unfiltered">Unfiltered</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">GET http://api.example.org/users/123 HTTP/1.1

HTTP/1.1 200 OK
Content-Type: application/json

{
  &quot;id&quot;: &quot;cddd5e44-dae0-11e5-8c01-63ed66ab2da5&quot;,
  &quot;name&quot;: &quot;John Doe&quot;,
  &quot;address&quot;: &quot;1600 Pennsylvania Avenue Northwest, Washington, DC, United States&quot;,
  &quot;birthday&quot;: &quot;1984-09-13&quot;,
  &quot;friends&quot;: [ {
    &quot;id&quot;: &quot;1fb43648-dae1-11e5-aa01-1fbc3abb1cd0&quot;,
    &quot;name&quot;: &quot;Jane Doe&quot;,
    &quot;address&quot;: &quot;1600 Pennsylvania Avenue Northwest, Washington, DC, United States&quot;,
    &quot;birthday&quot;: &quot;1988-04-07&quot;
  } ]
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="filtered"><a class="link" href="#filtered">Filtered</a></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">GET http://api.example.org/users/123?fields=(name,friends(name)) HTTP/1.1

HTTP/1.1 200 OK
Content-Type: application/json

{
  &quot;name&quot;: &quot;John Doe&quot;,
  &quot;friends&quot;: [ {
    &quot;name&quot;: &quot;Jane Doe&quot;
  } ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="#fields"><code>fields</code></a> query parameter determines the fields returned with the response
payload object. For instance, <code>(name)</code> returns <code>users</code> root object with only
the <code>name</code> field, and <code>(name,friends(name))</code> returns the <code>name</code> and the nested
<code>friends</code> object with only its <code>name</code> field.</p>
</div>
<div class="paragraph">
<p>OpenAPI doesn&#8217;t support you in formally specifying different return object
schemes depending on a parameter. When you define the field parameter, we
recommend to provide the following description: <code>Endpoint supports filtering
of return object fields as described in
[Rule #157](<a href="https://opensource.zalando.com/restful-api-guidelines/#157" class="bare">https://opensource.zalando.com/restful-api-guidelines/#157</a>)</code></p>
</div>
<div class="paragraph">
<p>The syntax of the query <a href="#fields"><code>fields</code></a> value is defined by the following
<a href="https://en.wikipedia.org/wiki/Backus%E2%80%93Naur_form">BNF</a> grammar.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bnf">&lt;fields&gt;            ::= [ &lt;negation&gt; ] &lt;fields_struct&gt;
&lt;fields_struct&gt;     ::= &quot;(&quot; &lt;field_items&gt; &quot;)&quot;
&lt;field_items&gt;       ::= &lt;field&gt; [ &quot;,&quot; &lt;field_items&gt; ]
&lt;field&gt;             ::= &lt;field_name&gt; | &lt;fields_substruct&gt;
&lt;fields_substruct&gt;  ::= &lt;field_name&gt; &lt;fields_struct&gt;
&lt;field_name&gt;        ::= &lt;dash_letter_digit&gt; [ &lt;field_name&gt; ]
&lt;dash_letter_digit&gt; ::= &lt;dash&gt; | &lt;letter&gt; | &lt;digit&gt;
&lt;dash&gt;              ::= &quot;-&quot; | &quot;_&quot;
&lt;letter&gt;            ::= &quot;A&quot; | ... | &quot;Z&quot; | &quot;a&quot; | ... | &quot;z&quot;
&lt;digit&gt;             ::= &quot;0&quot; | ... | &quot;9&quot;
&lt;negation&gt;          ::= &quot;!&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> Following the
<a href="https://en.wikipedia.org/wiki/Principle_of_least_astonishment">principle of
least astonishment</a>, you should not define the <a href="#fields"><code>fields</code></a> query parameter using
a default value, as the result is counter-intuitive and very likely not
anticipated by the consumer.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="158"><a class="link" href="#158"><span class="should-keyword"><strong>SHOULD</strong></span> allow optional embedding of sub-resources</a></h3>
<div class="paragraph">
<p>Embedding related resources (also know as <em>Resource expansion</em>) is a
great way to reduce the number of requests. In cases where clients know
upfront that they need some related resources they can instruct the
server to prefetch that data eagerly. Whether this is optimized on the
server, e.g. a database join, or done in a generic way, e.g. an HTTP
proxy that transparently embeds resources, is up to the implementation.</p>
</div>
<div class="paragraph">
<p>See <a href="#137"><span class="must-keyword"><strong>MUST</strong></span> stick to conventional query parameters</a> for naming, e.g. "embed" for steering of embedded
resource expansion. Please use the
<a href="https://en.wikipedia.org/wiki/Backus%E2%80%93Naur_form">BNF</a> grammar, as
already defined above for filtering, when it comes to an embedding query
syntax.</p>
</div>
<div class="paragraph">
<p>Embedding a sub-resource can possibly look like this where an order
resource has its order items as sub-resource (/order/{orderId}/items):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">GET /order/123?embed=(items) HTTP/1.1

{
  &quot;id&quot;: &quot;123&quot;,
  &quot;_embedded&quot;: {
    &quot;items&quot;: [
      {
        &quot;position&quot;: 1,
        &quot;sku&quot;: &quot;1234-ABCD-7890&quot;,
        &quot;price&quot;: {
          &quot;amount&quot;: 71.99,
          &quot;currency&quot;: &quot;EUR&quot;
        }
      }
    ]
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="227"><a class="link" href="#227"><span class="must-keyword"><strong>MUST</strong></span> document cacheable <code>GET</code>, <code>HEAD</code>, and <code>POST</code> endpoints</a></h3>
<div class="paragraph">
<p>Caching has to take many aspects into account, e.g. general <a href="#cacheable">cacheability</a> of response information, our guideline to protect endpoints
using SSL and <a href="#104">OAuth authorization</a>, resource update and invalidation
rules, existence of multiple consumer instances. Caching is in best case
complex, e.g. with respect to consistency, in worst case inefficient.</p>
</div>
<div class="paragraph">
<p>As a consequence, client side as well as transparent web caching should be
avoided, unless the service supports and requires it to protect itself, e.g.
in case of a heavily used and therefore rate limited master data service, i.e.
data items that rarely or not at all change after creation.</p>
</div>
<div class="paragraph">
<p>As default, servers and clients should always set the <a href="https://tools.ietf.org/html/rfc9111#section-5.2"><code>Cache-Control</code></a> header
to <a href="https://tools.ietf.org/html/rfc9110#section-5.2.1.5"><code>Cache-Control: no-store</code></a> and assume the same setting, if no <a href="https://tools.ietf.org/html/rfc9111#section-5.2"><code>Cache-Control</code></a>
header is provided.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> There is no need to document this default setting. However, please make
sure that your framework is attaching these header values by default, or ensure
this manually, e.g. using the best practice of
<a href="https://www.baeldung.com/spring-security-cache-control-headers">Spring Security</a>
as shown below. Any setup deviating from this default must be sufficiently
documented.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">Cache-Control: no-cache, no-store, must-revalidate, max-age=0</code></pre>
</div>
</div>
<div class="paragraph">
<p>If your service really requires to support caching, please observe the
following rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Document all <a href="#cacheable">cacheable</a> <a href="#get"><code>GET</code></a>, <a href="#head"><code>HEAD</code></a>, and <a href="#post"><code>POST</code></a> endpoints by declaring
the support of <a href="https://tools.ietf.org/html/rfc9111#section-5.2"><code>Cache-Control</code></a>, <a href="https://tools.ietf.org/html/rfc9110#section-12.5.5"><code>Vary</code></a>, and <a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>ETag</code></a> headers in response.
<strong>Note:</strong> you must not define the <a href="https://tools.ietf.org/html/rfc9111#section-5.3"><code>Expires</code></a> header to prevent redundant and
ambiguous definition of cache lifetime. A sensible default documentation of
these headers is given below.</p>
</li>
<li>
<p>Take care to specify the ability to support caching by defining the right
caching boundaries, i.e. time-to-live and cache constraints, by providing
sensible values for <a href="https://tools.ietf.org/html/rfc9111#section-5.2"><code>Cache-Control</code></a> and <a href="https://tools.ietf.org/html/rfc9110#section-12.5.5"><code>Vary</code></a> in your service. We will
explain best practices below.</p>
</li>
<li>
<p>Provide efficient methods to warm up and update caches (see ).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Usually, you can reuse the standard <a href="https://tools.ietf.org/html/rfc9111#section-5.2"><code>Cache-Control</code></a>, <a href="https://tools.ietf.org/html/rfc9110#section-12.5.5"><code>Vary</code></a>, and <a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>ETag</code></a>
response header definitions provided by the guideline as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">components</span>:
  <span class="error">parameters|headers</span>:
    <span class="key">Accept-Encoding</span>:
      <span class="error">$ref</span>: <span class="error">'https://opensource.zalando.com/restful-api-guidelines/models/headers-1.0.0.yaml#/Cache-Control'</span>
    <span class="key">Content-Encoding</span>:
      <span class="error">$ref</span>: <span class="error">'https://opensource.zalando.com/restful-api-guidelines/models/headers-1.0.0.yaml#/Vary'</span>
    <span class="key">ETag</span>:
      <span class="error">$ref</span>: <span class="error">'https://opensource.zalando.com/restful-api-guidelines/models/headers-1.0.0.yaml#/ETag'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See also <a href="#182"><span class="may-keyword"><strong>MAY</strong></span> consider to support <code>ETag</code> together with <code>If-Match</code>/<code>If-None-Match</code> header</a>.</p>
</div>
<div class="sect3">
<h4 id="cache-support-patterns"><a class="link" href="#cache-support-patterns">Cache Support Patterns</a></h4>
<div class="paragraph">
<p>To make best use of caching in micro service environments you need to provide
efficient methods to warm up and update caches, e.g. as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In general, you should support <a href="#182"><code>ETag</code> Together With <code>If-Match</code>/
<code>If-None-Match</code> Header</a> on all <a href="#cacheable">cacheable</a> endpoints.</p>
</li>
<li>
<p>For larger data items you should support <a href="#head"><code>HEAD</code></a> requests or more a bit more
efficient <a href="#get"><code>GET</code></a> requests with <a href="https://tools.ietf.org/html/rfc9110#section-13.1.2"><code>If-None-Match</code></a> header to check for updates.</p>
</li>
<li>
<p>For small data sets you should provide a <strong>get full collection</strong> <a href="#get"><code>GET</code></a> endpoint
that supports an <a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>ETag</code></a> for the collection in combination with a <a href="#head"><code>HEAD</code></a> or
<a href="#get"><code>GET</code></a> requests with <a href="https://tools.ietf.org/html/rfc9110#section-13.1.2"><code>If-None-Match</code></a> to check for updates.</p>
</li>
<li>
<p>For medium sized data sets provide a <strong>get full collection</strong> <a href="#get"><code>GET</code></a> endpoint
that supports an <a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>ETag</code></a> for the collection in combination with <a href="#pagination">REST Design - Pagination</a>
and <a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>&lt;entity-tag&gt;</code></a> filtering <a href="#get"><code>GET</code></a> requests for limiting the response to
changes since the provided <a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>&lt;entity-tag&gt;</code></a>. <strong>Note:</strong> this is not supported by
generic client and proxy caches on HTTP layer.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> For proper cache support, you must return <a href="#status-code-304" class="status-code">304</a> without content on a
failed <a href="#head"><code>HEAD</code></a> or <a href="#get"><code>GET</code></a> request with  <a href="#182"><code>If-None-Match: &lt;entity-tag&gt;</code></a>
instead of <a href="#status-code-412" class="status-code">412</a>. For <a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>ETag</code></a> see also <a href="#182"><span class="may-keyword"><strong>MAY</strong></span> consider to support <code>ETag</code> together with <code>If-Match</code>/<code>If-None-Match</code> header</a>.</p>
</div>
<div class="sect4">
<h5 id="_default_header_values"><a class="link" href="#_default_header_values">Default Header Values</a></h5>
<div class="paragraph">
<p>The default setting for <a href="https://tools.ietf.org/html/rfc9111#section-5.2"><code>Cache-Control</code></a> should contain the <code>private</code> directive
for endpoints with standard <a href="#104">OAuth authorization</a>, as well as the
<code>must-revalidate</code> directive to ensure, that the client does not use stale cache
entries. Last, the <code>max-age</code> directive should be set to a value between a few
seconds (<code>max-age=60</code>) and a few hours (<code>max-age=86400</code>) depending on the change
rate of your master data and your requirements to keep clients consistent.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">Cache-Control: private, must-revalidate, max-age=300</code></pre>
</div>
</div>
<div class="paragraph">
<p>The default setting for <a href="https://tools.ietf.org/html/rfc9110#section-12.5.5"><code>Vary</code></a> is harder to determine correctly. It depends on
the API endpoint, e.g. whether it supports compression, accepts different media
types, or requires other request specific headers. To support correct caching
you have to carefully choose the value. However, a good first default may be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">Vary: accept, accept-encoding</code></pre>
</div>
</div>
<div class="paragraph">
<p>Anyhow, this is only relevant, if you encourage clients to install generic
HTTP layer client and proxy caches.</p>
</div>
</div>
<div class="sect4">
<h5 id="_caching_strategy"><a class="link" href="#_caching_strategy">Caching strategy</a></h5>
<div class="paragraph">
<p>Generic client and proxy caching on HTTP level is hard to configure. Therefore,
we strongly recommend to attach the (possibly distributed) cache directly to
the service (or gateway) layer of your application. This relieves the service
from interpreting the <a href="https://tools.ietf.org/html/rfc9110#section-12.5.5"><code>Vary</code></a> header and greatly simplifies the usage patterns
of the <a href="https://tools.ietf.org/html/rfc9111#section-5.2"><code>Cache-Control</code></a> and <a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>ETag</code></a> headers. Moreover, is highly efficient with
respect to cache performance and overhead, and allows to support more
<a href="#cache-support-patterns">advanced cache update and warm up patterns</a>.</p>
</div>
<div class="paragraph">
<p>Anyhow, please carefully read <a href="https://tools.ietf.org/html/rfc9111">RFC 9111</a> before adding any client or
proxy cache.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="pagination"><a class="link" href="#pagination">14. REST Design - Pagination</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="159"><a class="link" href="#159"><span class="must-keyword"><strong>MUST</strong></span> support pagination</a></h3>
<div class="paragraph">
<p>Access to lists of data items must support pagination to protect the service
against overload as well as to support client side iteration and batch
processing experience. This holds true for all lists that are (potentially)
larger than just a few hundred entries.</p>
</div>
<div class="paragraph">
<p>There are two well known page iteration techniques:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Offset-based pagination</strong>: numeric offset identifies the first page-entry</p>
</li>
<li>
<p><strong>Cursor-based pagination</strong> — aka key-based pagination: a unique key
identifies the first page-entry (see also
<a href="https://dev.twitter.com/overview/api/cursoring">Twitter API</a> or
<a href="https://developers.facebook.com/docs/graph-api/results">Facebook API</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The technical conception of pagination should also consider user experience
(see <a href="https://www.smashingmagazine.com/2016/03/pagination-infinite-scrolling-load-more-buttons/">Pagination Usability Findings In eCommerce</a>), for
instance, jumping to a specific page is far less used than navigation via
<a href="#next"><code>next</code></a>/<a href="#prev"><code>prev</code></a> page links (see <a href="#161"><span class="should-keyword"><strong>SHOULD</strong></span> use pagination links</a>). This favors an API design using
cursor-based instead of offset-based pagination&#8201;&#8212;&#8201;see <a href="#160"><span class="should-keyword"><strong>SHOULD</strong></span> prefer cursor-based pagination, avoid offset-based pagination</a>.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> To provide a consistent look and feel of pagination patterns,
you must stick to the common query parameter names defined in <a href="#137"><span class="must-keyword"><strong>MUST</strong></span> stick to conventional query parameters</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="160"><a class="link" href="#160"><span class="should-keyword"><strong>SHOULD</strong></span> prefer cursor-based pagination, avoid offset-based pagination</a></h3>
<div class="paragraph">
<p>Cursor-based pagination is usually better and more efficient when compared to
offset-based pagination. Especially when it comes to high-data volumes and/or
storage in NoSQL databases.</p>
</div>
<div class="paragraph">
<p>Before choosing cursor-based pagination, consider the following trade-offs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Usability/framework support:</p>
<div class="ulist">
<ul>
<li>
<p>Offset-based pagination is more widely known than cursor-based pagination,
so it has more framework support and is easier to use for API clients.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Use case - jump to a certain page:</p>
<div class="ulist">
<ul>
<li>
<p>If jumping to a particular page in a range (e.g., 51 of 100) is really a
required use case, cursor-based navigation may not be feasible.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Data changes may lead to anomalies in result pages:</p>
<div class="ulist">
<ul>
<li>
<p>Offset-based pagination may create duplicates or lead to missing entries
if rows are inserted or deleted between two subsequent paging requests.</p>
</li>
<li>
<p>If implemented incorrectly, cursor-based pagination may fail when the
cursor entry has been deleted before fetching the pages.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Performance considerations - efficient server-side processing using
offset-based pagination is hardly feasible for:</p>
<div class="ulist">
<ul>
<li>
<p>Very big data sets, especially if they cannot reside in the main memory of
the database.</p>
</li>
<li>
<p>Sharded or NoSQL databases.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <a href="#cursor"><code>cursor</code></a> used for pagination is an opaque pointer to a page, that must
never be <strong>inspected</strong> or <strong>constructed</strong> by clients. It usually encodes (encrypts)
the page position, i.e. the unique identifier of the first or last page
element, the pagination direction, and the applied query filters (or a hash
over these) to safely recreate the collection (see also best practice
<a href="#cursor-based-pagination">Cursor-based pagination in RESTful APIs</a> below).</p>
</div>
</div>
<div class="sect2">
<h3 id="248"><a class="link" href="#248"><span class="should-keyword"><strong>SHOULD</strong></span> use pagination response page object</a></h3>
<div id="pagination-fields" class="paragraph">
<p>For iterating over collections (result sets) we propose to either use cursors
(see <a href="#160"><span class="should-keyword"><strong>SHOULD</strong></span> prefer cursor-based pagination, avoid offset-based pagination</a>) or simple hypertext control links (see <a href="#161"><span class="should-keyword"><strong>SHOULD</strong></span> use pagination links</a>). To implement
these in a consistent way, we have defined a response page object pattern with
the following field semantics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="self"></a><a href="#self"><code>self</code></a>:the link or cursor pointing to the same page.</p>
</li>
<li>
<p><a id="first"></a><a href="#first"><code>first</code></a>: the link or cursor pointing to the first page.</p>
</li>
<li>
<p><a id="prev"></a><a href="#prev"><code>prev</code></a>: the link or cursor pointing to the previous page.
It is not provided, if it is the first page.</p>
</li>
<li>
<p><a id="next"></a><a href="#next"><code>next</code></a>: the link or cursor pointing to the next page.
It is not provided, if it is the last page.</p>
</li>
<li>
<p><a id="last"></a><a href="#last"><code>last</code></a>: the link or cursor pointing to the last page.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Pagination responses should contain the following additional array field to
transport the page content:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="items"></a><a href="#items"><code>items</code></a>: array of resources, holding all the items of the current
page (<a href="#items"><code>items</code></a> may be replaced by a resource name).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To simplify user experience, the applied query filters may be returned using
the following field (see also <a href="#get-with-body"><code>GET with body</code></a>):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="query"></a><a href="#query"><code>query</code></a>: object containing the query filters applied in the search
request to filter the collection resource.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As Result, the standard response page using <a href="#160">cursors</a> or <a href="#161">pagination links</a> may be defined as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">ResponsePage</span>:
  <span class="key">type</span>: <span class="string"><span class="content">object</span></span>
  <span class="key">required</span>:
    - <span class="string"><span class="content">items</span></span>
  <span class="key">properties</span>:
    <span class="key">self</span>:
      <span class="key">description</span>: <span class="string"><span class="content">Pagination link|cursor pointing to the current page.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">format</span>: <span class="string"><span class="content">uri|cursor</span></span>
    <span class="key">first</span>:
      <span class="key">description</span>: <span class="string"><span class="content">Pagination link|cursor pointing to the first page.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">format</span>: <span class="string"><span class="content">uri|cursor</span></span>
    <span class="key">prev</span>:
      <span class="key">description</span>: <span class="string"><span class="content">Pagination link|cursor pointing to the previous page.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">format</span>: <span class="string"><span class="content">uri|cursor</span></span>
    <span class="key">next</span>:
      <span class="key">description</span>: <span class="string"><span class="content">Pagination link|cursor pointing to the next page.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">format</span>: <span class="string"><span class="content">uri|cursor</span></span>
    <span class="key">last</span>:
      <span class="key">description</span>: <span class="string"><span class="content">Pagination link|cursor pointing to the last page.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">format</span>: <span class="string"><span class="content">uri|cursor</span></span>

    <span class="key">query</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">&gt;</span><span class="content">
        Object containing the query filters applied to the collection resource.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">object</span></span>
      <span class="key">properties</span>: <span class="string"><span class="content">...</span></span>

    <span class="key">items</span>:
      <span class="key">description</span>: <span class="string"><span class="content">Array of collection items.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">array</span></span>
      <span class="key">required</span>: <span class="string"><span class="content">false</span></span>
      <span class="key">items</span>:
        <span class="key">type</span>: <span class="string"><span class="content">...</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> While you may support cursors for <a href="#next"><code>next</code></a>, <a href="#prev"><code>prev</code></a>, <a href="#first"><code>first</code></a>, <a href="#last"><code>last</code></a>, and
<a href="#self"><code>self</code></a>, it is best practice to replace these with pagination links&#8201;&#8212;&#8201;see
<a href="#161"><span class="should-keyword"><strong>SHOULD</strong></span> use pagination links</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="161"><a class="link" href="#161"><span class="should-keyword"><strong>SHOULD</strong></span> use pagination links</a></h3>
<div class="paragraph">
<p>To simplify client design, APIs should support <a href="#165">simplified hypertext
controls</a> as standard pagination links where applicable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">self</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://my-service.zalandoapis.com/resources?cursor=&lt;self-position&gt;</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">first</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://my-service.zalandoapis.com/resources?cursor=&lt;first-position&gt;</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">prev</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://my-service.zalandoapis.com/resources?cursor=&lt;previous-position&gt;</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">next</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://my-service.zalandoapis.com/resources?cursor=&lt;next-position&gt;</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">last</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://my-service.zalandoapis.com/resources?cursor=&lt;last-position&gt;</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">query</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">query-param-&lt;1&gt;</span><span class="delimiter">&quot;</span></span>: <span class="error">.</span><span class="error">.</span><span class="error">.</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">query-param-&lt;n&gt;</span><span class="delimiter">&quot;</span></span>: <span class="error">.</span><span class="error">.</span><span class="error">.</span>
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">items</span><span class="delimiter">&quot;</span></span>: [<span class="error">.</span><span class="error">.</span><span class="error">.</span>]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See also <a href="#248"><span class="should-keyword"><strong>SHOULD</strong></span> use pagination response page object</a> for details on the pagination fields and page result object.</p>
</div>
</div>
<div class="sect2">
<h3 id="254"><a class="link" href="#254"><span class="should-keyword"><strong>SHOULD</strong></span> avoid a total result count</a></h3>
<div class="paragraph">
<p>In pagination responses you should generally avoid providing a <em>total result
count</em>, since calculating it is a costly operation that is usually not required
by clients. Counting the total number of results for complex queries usually
requires a full scan of all involved indexes, as it is difficult to calculate
and cache it in advance. While this is only an implementation detail, it is
important to consider that providing these total counts over the life-span
of a service might become expensive as the data set grows over time.</p>
</div>
<div class="paragraph">
<p>As clients may integrate against these counts over time alongside data
set growth, removing them will be more difficult than not providing them
in the first place.</p>
</div>
<div class="paragraph">
<p>If your consumer really requires a total result count in the response, you may
support this requirement via the <a href="https://tools.ietf.org/html/rfc7240"><code>Prefer</code></a> header adding the directive
<code>return=total-count</code> (see also <a href="#181"><span class="may-keyword"><strong>MAY</strong></span> consider to support <code>Prefer</code> header to handle processing preferences</a>).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="compatibility"><a class="link" href="#compatibility">15. REST Design - Compatibility</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="106"><a class="link" href="#106"><span class="must-keyword"><strong>MUST</strong></span> not break backward compatibility</a></h3>
<div class="paragraph">
<p>Change APIs, but keep all consumers running. Consumers usually have independent
release lifecycles, focus on stability, and avoid changes that do not provide
additional value. APIs are contracts between service providers and service
consumers that cannot be broken via unilateral decisions.</p>
</div>
<div class="paragraph">
<p>There are two techniques to change APIs without breaking them:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>follow rules for compatible extensions</p>
</li>
<li>
<p>introduce new API versions and still support older versions with
<a href="https://opensource.zalando.com/restful-api-guidelines/#deprecation">deprecation</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We strongly encourage using compatible API extensions and discourage versioning
(see <a href="#113"><span class="should-keyword"><strong>SHOULD</strong></span> avoid versioning</a> and <a href="#114"><span class="must-keyword"><strong>MUST</strong></span> use media type versioning</a> below). The following guidelines for service providers
(<a href="#107"><span class="should-keyword"><strong>SHOULD</strong></span> prefer compatible extensions</a>) and consumers (<a href="#108"><span class="must-keyword"><strong>MUST</strong></span> prepare clients to accept compatible API extensions</a>) enable us (having Postel’s Law in mind) to
make compatible changes without versioning.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> There is a difference between incompatible and breaking changes.
Incompatible changes are changes that are not covered by the compatibility
rules below. Breaking changes are incompatible changes deployed into operation,
and thereby breaking running API consumers. Usually, incompatible changes are
breaking changes when deployed into operation. However, in specific controlled
situations it is possible to deploy incompatible changes in a non-breaking way,
if no API consumer is using the affected API aspects (see also <a href="#deprecation">Deprecation</a> guidelines).</p>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> Please note that the compatibility guarantees are for the "on the wire"
format. Binary or source compatibility of code generated from an API definition
is not covered by these rules. If client implementations update their
generation process to a new version of the API definition, it has to be
expected that code changes are necessary.</p>
</div>
</div>
<div class="sect2">
<h3 id="107"><a class="link" href="#107"><span class="should-keyword"><strong>SHOULD</strong></span> prefer compatible extensions</a></h3>
<div class="paragraph">
<p>API designers should apply the following rules to evolve RESTful APIs for
services in a backward-compatible way:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add only optional, never mandatory fields.</p>
</li>
<li>
<p>Never change the semantic of fields (e.g. changing the semantic from
customer-number to customer-id, as both are different unique customer keys)</p>
</li>
<li>
<p>Input fields may have (complex) constraints being validated via server-side
business logic. Never change the validation logic to be more restrictive and
make sure that all constraints are clearly defined in description.</p>
</li>
<li>
<p>Enum ranges can be reduced when used as input parameters, only if the server
is ready to accept and handle old range values too. Enum range can be reduced
when used as output parameters.</p>
</li>
<li>
<p>Enum ranges cannot be extended when used for output parameters — clients may
not be prepared to handle it. However, enum ranges can be extended when used
for input parameters.</p>
</li>
<li>
<p>Use <a href="#112"><code>x-extensible-enum</code></a>, if range is used for output parameters and likely to
be extended with growing functionality. It defines an open list of explicit
values and clients must be agnostic to new values.</p>
</li>
<li>
<p>Consider <a href="#250"><span class="should-keyword"><strong>SHOULD</strong></span> be aware of services not fully supporting JSON/unicode</a> in case a URL has to change.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="109"><a class="link" href="#109"><span class="should-keyword"><strong>SHOULD</strong></span> design APIs conservatively</a></h3>
<div class="paragraph">
<p>Designers of service provider APIs should be conservative and accurate in what
they accept from clients:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Unknown input fields in payload or URL should not be ignored; servers should
provide error feedback to clients via an HTTP 400 response code.
Otherwise, if unexpected fields are planned to be handled in some way instead
of being rejected, API designers <strong>must</strong> document clearly how unexpected
fields are being handled for <a href="#put"><code>PUT</code></a>, <a href="#post"><code>POST</code></a>, and <a href="#patch"><code>PATCH</code></a> requests.</p>
</li>
<li>
<p>Be accurate in defining input data constraints (like formats, ranges, lengths
etc.) — and check constraints and return dedicated error information in case
of violations.</p>
</li>
<li>
<p>Prefer being more specific and restrictive (if compliant to functional
requirements), e.g. by defining length range of strings. It may simplify
implementation while providing freedom for further evolution as compatible
extensions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Not ignoring unknown input fields is a specific deviation from Postel&#8217;s Law
(e.g. see also<br>
<a href="https://cacm.acm.org/magazines/2011/8/114933-the-robustness-principle-reconsidered/fulltext">The
Robustness Principle Reconsidered</a>) and a strong recommendation. Servers might
want to take different approach but should be aware of the following problems
and be explicit in what is supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ignoring unknown input fields is actually not an option for <a href="#put"><code>PUT</code></a>, since it
becomes asymmetric with subsequent <a href="#get"><code>GET</code></a> response and HTTP is clear about the
<a href="#put"><code>PUT</code></a> <em>replace</em> semantics and default roundtrip expectations (see
<a href="https://tools.ietf.org/html/rfc9110#section-9.3.4">RFC 9110 Section 9.3.4</a>). Note, accepting (i.e. not
ignoring) unknown input fields and returning it in subsequent <a href="#get"><code>GET</code></a> responses
is a different situation and compliant to <a href="#put"><code>PUT</code></a> semantics.</p>
</li>
<li>
<p>Certain client errors cannot be recognized by servers, e.g. attribute name
typing errors will be ignored without server error feedback. The server
cannot differentiate between the client intentionally providing an additional
field versus the client sending a mistakenly named field, when the client&#8217;s
actual intent was to provide an optional input field.</p>
</li>
<li>
<p>Future extensions of the input data structure might be in conflict with
already ignored fields and, hence, will not be compatible, i.e. break clients
that already use this field but with different type.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In specific situations, where a (known) input field is not needed anymore, it
either can stay in the API definition with "not used anymore" description or
can be removed from the API definition as long as the server ignores this
specific parameter.</p>
</div>
</div>
<div class="sect2">
<h3 id="108"><a class="link" href="#108"><span class="must-keyword"><strong>MUST</strong></span> prepare clients to accept compatible API extensions</a></h3>
<div class="paragraph">
<p>Service clients should apply the robustness principle:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Be conservative with API requests and data passed as input, e.g. avoid to
exploit definition deficits like passing megabytes of strings with
unspecified maximum length.</p>
</li>
<li>
<p>Be tolerant in processing and reading data of API responses, more
specifically service clients must be prepared for compatible API extensions
of response data:</p>
<div class="ulist">
<ul>
<li>
<p>Be tolerant with unknown fields in the payload (see also Fowler’s
<a href="http://martinfowler.com/bliki/TolerantReader.html">"TolerantReader"</a> post),
i.e. ignore new fields but do not eliminate them from payload if needed for
subsequent <a href="#put"><code>PUT</code></a> requests.</p>
</li>
<li>
<p>Be prepared that <a href="#112"><code>x-extensible-enum</code></a> return parameter may deliver new values;
either be agnostic or provide default behavior for unknown values.</p>
</li>
<li>
<p>Be prepared to handle HTTP status codes not explicitly specified in endpoint
definitions. Note also, that status codes are extensible. Default handling is
how you would treat the corresponding <a href="#http-status-codes-and-errors" class="status-code">2xx</a> code (see
<a href="https://tools.ietf.org/html/rfc9110#section-15">RFC 9110 Section 15</a>).</p>
</li>
<li>
<p>Follow the redirect when the server returns HTTP status code <a href="#status-code-301" class="status-code">301</a> (Moved
Permanently).</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <a href="#handling-compatible-extensions">Handling compatible API extensions</a> section describes a best practice to implement the requirements in Java.</p>
</div>
</div>
<div class="sect2">
<h3 id="111"><a class="link" href="#111"><span class="must-keyword"><strong>MUST</strong></span> treat OpenAPI specification as open for extension by default</a></h3>
<div class="paragraph">
<p>The OpenAPI specification is not very specific on default extensibility
of objects, and redefines JSON-Schema keywords related to extensibility, like
<code>additionalProperties</code>. Following our compatibility guidelines, OpenAPI
object definitions are considered open for extension by default as per
<a href="http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.18">Section
5.18 "additionalProperties"</a> of JSON-Schema.</p>
</div>
<div class="paragraph">
<p>When it comes to OpenAPI, this means an <code>additionalProperties</code> declaration
is not required to make an object definition extensible:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>API clients consuming data must not assume that objects are closed for
extension in the absence of an <code>additionalProperties</code> declaration and must
ignore fields sent by the server they cannot process. This allows API
servers to evolve their data formats.</p>
</li>
<li>
<p>For API servers receiving unexpected data, the situation is slightly
different. According to <a href="#109"><span class="should-keyword"><strong>SHOULD</strong></span> design APIs conservatively</a>, instead of ignoring fields,
servers <em>should</em> reject requests whose entities contain undefined fields
in order to signal to clients that those fields would not be stored on behalf
of the client.
Otherwise, if unexpected fields are planned to be handled in some way instead
of being rejected, API designers <strong>must</strong> document clearly how unexpected
fields are being handled for <a href="#put"><code>PUT</code></a>, <a href="#post"><code>POST</code></a>, and <a href="#patch"><code>PATCH</code></a> requests.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>API formats must not declare <code>additionalProperties</code> to be false, as this
prevents objects being extended in the future.</p>
</div>
<div class="paragraph">
<p>Note that this guideline concentrates on default extensibility and does not
exclude the use of <code>additionalProperties</code> with a schema as a value, which might
be appropriate in some circumstances, e.g. see <a href="#216"><span class="should-keyword"><strong>SHOULD</strong></span> define maps using <code>additionalProperties</code></a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="113"><a class="link" href="#113"><span class="should-keyword"><strong>SHOULD</strong></span> avoid versioning</a></h3>
<div class="paragraph">
<p>When changing your RESTful APIs, do so in a compatible way and avoid generating
additional API versions. Multiple versions can significantly complicate
understanding, testing, maintaining, evolving, operating and releasing our
systems
(<a href="http://martinfowler.com/articles/enterpriseREST.html">supplementary
reading</a>).</p>
</div>
<div class="paragraph">
<p>If changing an API can’t be done in a compatible way, then proceed in one of
these three ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>create a new resource (variant) in addition to the old resource variant</p>
</li>
<li>
<p>create a new service endpoint — i.e. a new application with a new API (with a
new domain name)</p>
</li>
<li>
<p>create a new API version supported in parallel with the old API by the same
microservice</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As we discourage versioning by all means because of the manifold disadvantages,
we strongly recommend to only use the first two approaches.</p>
</div>
</div>
<div class="sect2">
<h3 id="114"><a class="link" href="#114"><span class="must-keyword"><strong>MUST</strong></span> use media type versioning</a></h3>
<div class="paragraph">
<p>However, when API versioning is unavoidable, you have to design your
multi-version RESTful APIs using media type versioning (see <a href="#115"><span class="must-keyword"><strong>MUST</strong></span> not use URL versioning</a>).
Media type versioning is less tightly coupled since
it supports content negotiation and hence reduces complexity of release
management.</p>
</div>
<div class="paragraph">
<p>Version information and media type are provided
together via the HTTP <code>Content-Type</code> header — e.g.
<code>application/x.zalando.cart+json;version=2</code>. For incompatible changes, a new
media type version for the resource is created. To generate the new
representation version, consumer and producer can do <a href="#244">content negotiation</a> using
the HTTP <code>Content-Type</code> and <code>Accept</code> headers.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This versioning method only applies to
the request and response payload schema, not to URI or method semantics.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_custom_media_type_format"><a class="link" href="#_custom_media_type_format">Custom media type format</a></h4>
<div class="paragraph">
<p>Custom media type format should have the following pattern:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">application/x.&lt;custom-media-type&gt;+json;version=&lt;version&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;custom-media-type&gt;</code> is a custom type name, e.g. <code>x.zalando.cart</code></p>
</li>
<li>
<p><code>&lt;version&gt;</code> is a (sequence) number, e.g. <code>2</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_example_2"><a class="link" href="#_example_2">Example</a></h4>
<div class="paragraph">
<p>In this example, a client wants only the new version of the response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">Accept: application/x.zalando.cart+json;version=2</code></pre>
</div>
</div>
<div class="paragraph">
<p>A server responding to this, as well as a client sending a request with content
should use the <code>Content-Type</code> header, declaring that one is sending the new
version:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">Content-Type: application/x.zalando.cart+json;version=2</code></pre>
</div>
</div>
<div class="paragraph">
<p>Media type versioning should&#8230;&#8203;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use a custom media type, e.g. <code>application/x.zalando.cart+json</code></p>
</li>
<li>
<p>Include media type versions in request and response headers to increase visibility</p>
</li>
<li>
<p>Include <code>Content-Type</code> in the <code>Vary</code> header to enable proxy caches to differ
between versions</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">Vary: Content-Type</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Until an incompatible change is necessary, it is recommended to stay
with the standard <code>application/json</code> media type without versioning.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Further reading:
<a href="https://apisyouwonthate.com/blog/api-versioning-has-no-right-way">API
Versioning Has No "Right Way"</a> provides an overview on different versioning
approaches to handle breaking changes without being opinionated.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="115"><a class="link" href="#115"><span class="must-keyword"><strong>MUST</strong></span> not use URL versioning</a></h3>
<div class="paragraph">
<p>With URL versioning a (major) version number is included in the path, e.g.
<code>/v1/customers</code>. The consumer has to wait until the provider has been released
and deployed. If the consumer also supports hypermedia links — even in their
APIs — to drive workflows (HATEOAS), this quickly becomes complex. So does
coordinating version upgrades — especially with hyperlinked service
dependencies — when using URL versioning. To avoid this tighter coupling and
complexer release management we do not use URL versioning, instead we <a href="#114"><span class="must-keyword"><strong>MUST</strong></span> use media type versioning</a>
with content negotiation.</p>
</div>
</div>
<div class="sect2">
<h3 id="110"><a class="link" href="#110"><span class="must-keyword"><strong>MUST</strong></span> always return JSON objects as top-level data structures</a></h3>
<div class="paragraph">
<p>In a response body, you must always return a JSON object (and not e.g. an
array) as a top level data structure to support future extensibility. JSON
objects support compatible extension by additional attributes. This allows you
to easily extend your response and e.g. add pagination later, without breaking
backwards compatibility. See <a href="#161"><span class="should-keyword"><strong>SHOULD</strong></span> use pagination links</a> for an example.</p>
</div>
<div class="paragraph">
<p>Maps (see <a href="#216"><span class="should-keyword"><strong>SHOULD</strong></span> define maps using <code>additionalProperties</code></a>), even though technically objects, are also forbidden as top
level data structures, since they don&#8217;t support compatible, future extensions.</p>
</div>
</div>
<div class="sect2">
<h3 id="112"><a class="link" href="#112"><span class="should-keyword"><strong>SHOULD</strong></span> used open-ended list of values (<code>x-extensible-enum</code>) for enumerations</a></h3>
<div class="paragraph">
<p>Enumerations are per definition closed sets of values that are assumed to be
complete and not intended for extension. This closed principle of enumerations
imposes compatibility issues when an enumeration must be extended. To avoid
these issues, we strongly recommend to use an open-ended list of values instead
of an enumeration unless:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the API has full control of the enumeration values, i.e. the list of values
does not depend on any external tool or interface, and</p>
</li>
<li>
<p>the list of values is complete with respect to any thinkable and unthinkable
future feature.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To specify an open-ended list of values use the marker <a href="#112"><code>x-extensible-enum</code></a> as
follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">delivery_methods</span>:
  <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
  <span class="key">x-extensible-enum</span>:
    - <span class="string"><span class="content">PARCEL</span></span>
    - <span class="string"><span class="content">LETTER</span></span>
    - <span class="string"><span class="content">EMAIL</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> <a href="#112"><code>x-extensible-enum</code></a> is not JSON Schema conform but will be ignored by
most tools.</p>
</div>
<div class="paragraph">
<p>See <a href="#240"><span class="should-keyword"><strong>SHOULD</strong></span> declare enum values using UPPER_SNAKE_CASE string</a> about enum value naming conventions.</p>
</div>
<div class="paragraph">
<p><strong>Important:</strong> Clients must be prepared for extensions of enums returned with server responses, i.e.
must implement a fallback / default behavior to handle unknown new enum values&#8201;&#8212;&#8201;see <a href="#108"><span class="must-keyword"><strong>MUST</strong></span> prepare clients to accept compatible API extensions</a>.
API owners must take care to extend enums in a compatible way that does not change the
semantics of already existing enum values, for instance, do not split an old enum value
into two new enum values.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deprecation"><a class="link" href="#deprecation">16. REST Design - Deprecation</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes it is necessary to phase out an API endpoint, an API version, or an
API feature, e.g. if a field or parameter is no longer supported or a whole
business functionality behind an endpoint is supposed to be shut down. As long
as the API endpoints and features are still used by consumers these shut downs
are breaking changes and not allowed. To progress the following deprecation
rules have to be applied to make sure that the necessary consumer changes and
actions are well communicated and aligned using <em>deprecation</em> and <em>sunset</em>
dates.</p>
</div>
<div class="sect2">
<h3 id="187"><a class="link" href="#187"><span class="must-keyword"><strong>MUST</strong></span> reflect deprecation in API specifications</a></h3>
<div class="paragraph">
<p>The API deprecation must be part of the API specification.</p>
</div>
<div class="paragraph">
<p>If an API endpoint (operation object), an input argument (parameter object),
an in/out data object (schema object), or on a more fine grained level, a
schema attribute or property should be deprecated, the producers must set
<code>deprecated: true</code> for the affected element and add further explanation to the
<code>description</code> section of the API specification. If a future shut down is
planned, the producer must provide a sunset date and document in details
what consumers should use instead and how to migrate.</p>
</div>
</div>
<div class="sect2">
<h3 id="185"><a class="link" href="#185"><span class="must-keyword"><strong>MUST</strong></span> obtain approval of clients before API shut down</a></h3>
<div class="paragraph">
<p>Before shutting down an API, version of an API, or API feature the producer
must make sure, that all clients have given their consent on a sunset date.
Producers should help consumers to migrate to a potential new API or API
feature by providing a migration manual and clearly state the time line for
replacement availability and sunset (see also <a href="#189"><span class="should-keyword"><strong>SHOULD</strong></span> add <code>Deprecation</code> and <code>Sunset</code> header to responses</a>). Once all clients of
a sunset API feature are migrated, the producer may shut down the deprecated
API feature.</p>
</div>
</div>
<div class="sect2">
<h3 id="186"><a class="link" href="#186"><span class="must-keyword"><strong>MUST</strong></span> collect external partner consent on deprecation time span</a></h3>
<div class="paragraph">
<p>If the API is consumed by any external partner, the API owner must define a
reasonable time span that the API will be maintained after the producer has
announced deprecation. All external partners must state consent with this
after-deprecation-life-span, i.e. the minimum time span between official
deprecation and first possible sunset, <strong>before</strong> they are allowed to use the
API.</p>
</div>
</div>
<div class="sect2">
<h3 id="188"><a class="link" href="#188"><span class="must-keyword"><strong>MUST</strong></span> monitor usage of deprecated API scheduled for sunset</a></h3>
<div class="paragraph">
<p>Owners of an API, API version, or API feature used in production that is
scheduled for sunset must monitor the usage of the sunset API, API version, or
API feature in order to observe migration progress and avoid uncontrolled
breaking effects on ongoing consumers. See also <a href="#193"><span class="should-keyword"><strong>SHOULD</strong></span> monitor API usage</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="189"><a class="link" href="#189"><span class="should-keyword"><strong>SHOULD</strong></span> add <code>Deprecation</code> and <code>Sunset</code> header to responses</a></h3>
<div class="paragraph">
<p>During the deprecation phase, the producer should add a <code>Deprecation: &lt;date-time&gt;</code>
(see <a href="https://tools.ietf.org/html/draft-ietf-httpapi-deprecation-header">draft: RFC
Deprecation HTTP Header Field</a>) and - if also planned - a <code>Sunset: &lt;date-time&gt;</code>
(see <a href="https://tools.ietf.org/html/rfc8594#section-3">RFC 8594</a>) header on each response affected by a
deprecated element (see <a href="#187"><span class="must-keyword"><strong>MUST</strong></span> reflect deprecation in API specifications</a>).</p>
</div>
<div class="paragraph">
<p>The <a href="https://tools.ietf.org/html/draft-ietf-httpapi-deprecation-header"><code>Deprecation</code></a> header can either be set to <code>true</code> - if a feature is retired
-, or carry a deprecation time stamp, at which a replacement will become/became
available and consumers must not on-board any longer (see <a href="#191"><span class="must-keyword"><strong>MUST</strong></span> not start using deprecated APIs</a>). The optional
<a href="https://tools.ietf.org/html/rfc8594"><code>Sunset</code></a> time stamp carries the information when consumers latest have to stop
using a feature. The sunset date should always offer an eligible time interval
for switching to a replacement feature.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="txt">Deprecation: Tue, 31 Dec 2024 23:59:59 GMT
Sunset: Wed, 31 Dec 2025 23:59:59 GMT</code></pre>
</div>
</div>
<div class="paragraph">
<p>If multiple elements are deprecated the <a href="https://tools.ietf.org/html/draft-ietf-httpapi-deprecation-header"><code>Deprecation</code></a> and <a href="https://tools.ietf.org/html/rfc8594"><code>Sunset</code></a> headers are
expected to be set to the earliest time stamp to reflect the shortest interval
at which consumers are expected to get active. The <a href="https://tools.ietf.org/html/draft-ietf-httpapi-deprecation-header"><code>Deprecation</code></a> and <a href="https://tools.ietf.org/html/rfc8594"><code>Sunset</code></a>
headers can be defined as follows in the API specification (see also the
default definition below):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">components</span>:
  <span class="error">parameters|headers</span>:
    <span class="key">Deprecation</span>:
      <span class="error">$ref</span>: <span class="error">'https://opensource.zalando.com/restful-api-guidelines/models/headers-1.0.0.yaml#/Deprecation'</span>
    <span class="key">Sunset</span>:
      <span class="error">$ref</span>: <span class="error">'https://opensource.zalando.com/restful-api-guidelines/models/headers-1.0.0.yaml#/Sunset'</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">components</span>:
  <span class="key">headers</span>:
    <span class="key">Deprecation</span>:
        <span class="key">required</span>: <span class="string"><span class="content">false</span></span>
        <span class="key">description</span>: <span class="string"><span class="delimiter">|-</span><span class="content">
          The **Deprecation** response header (see [Draft &quot;The Deprecation HTTP
          Header Field&quot;][draft]) announces an upcoming deprecation of a feature or
          resource. The deprecation value is either a timestamp as defined in [RFC
          9110 Section 5.6.7][rfc-9110-5.6.7] or `true` - if the feature is already
          deprecated.

          The scope of the distinct deprecated feature or resource must be derived
          from the API spec. If the timestamp points to the past, the API spec also
          contains a migration advise.

          Clients should monitor the usage of **Deprecation** headers and notify
          about them in time, so that migration measures can be planned and executed
          timely (see also [API Guideline - Deprecation][api]).

          [draft]: &lt;https://datatracker.ietf.org/doc/html/draft-ietf-httpapi-deprecation-header-02&gt;
          [rfc-9110-5.6.7]: &lt;https://tools.ietf.org/html/rfc9110#section-5.6.7&gt;
          [api]: &lt;https://opensource.zalando.com/restful-api-guidelines/#deprecation&gt;</span></span>
        <span class="key">schema</span>:
          <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
          <span class="key">format</span>: <span class="string"><span class="content">date-time</span></span>
        <span class="key">example</span>: <span class="string"><span class="content">[ &quot;Tue, 31 Dec 2024 23:59:59 GMT&quot; ]</span></span>

    <span class="key">Sunset</span>:
        <span class="key">required</span>: <span class="string"><span class="content">false</span></span>
        <span class="key">description</span>: <span class="string"><span class="delimiter">|-</span><span class="content">
          The **Sunset** response header (see [RFC 8594][rfc-8594]) communicates the
          point in time at which the feature or resource becomes unresponsive. The
          sunset value is providing a timestamp as defined in [RFC 9110 Section
          5.6.7][rfc-9110-5.6.7] usually pointing to the future. If a sunset value
          points to the past, the feature or resource must be expected to become
          unavailable at any time.

          Clients should monitor the usage of **Sunset** headers and warn/alert about
          them before the sunset time has come to take counter measures, e.g. prepare
          a client shutdown or migration (see also [API Guideline -
          Deprecation][api-deprecation]).

          [rfc-8594]: &lt;https://tools.ietf.org/html/rfc8594&gt;
          [rfc-9110-5.6.7]: &lt;https://tools.ietf.org/html/rfc9110#section-5.6.7&gt;
          [api-deprecation]: &lt;https://opensource.zalando.com/restful-api-guidelines/#deprecation&gt;</span></span>
        <span class="key">schema</span>:
          <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
          <span class="key">format</span>: <span class="string"><span class="content">date-time</span></span>
        <span class="key">example</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Wed, 31 Dec 2025 23:59:59 GMT</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> adding the <a href="https://tools.ietf.org/html/draft-ietf-httpapi-deprecation-header"><code>Deprecation</code></a> and <a href="https://tools.ietf.org/html/rfc8594"><code>Sunset</code></a> header is not sufficient to gain
client consent to shut down an API or feature.</p>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> In earlier guideline versions, we used the <a href="https://tools.ietf.org/html/rfc9111#section-5.5"><code>Warning</code></a> header to provide
the deprecation info to clients. However, <a href="https://tools.ietf.org/html/rfc9111#section-5.5"><code>Warning</code></a> header has a less specific
semantics, will be obsolete with
<a href="https://tools.ietf.org/html/draft-ietf-httpbis-cache-06">draft: RFC HTTP
Caching</a>, and our syntax was not compliant with <a href="https://tools.ietf.org/html/rfc9111#section-5.5">RFC 9111
 Section 5.5 "Warning"</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="190"><a class="link" href="#190"><span class="should-keyword"><strong>SHOULD</strong></span> add monitoring for <code>Deprecation</code> and <code>Sunset</code> header</a></h3>
<div class="paragraph">
<p>Clients should monitor the <a href="https://tools.ietf.org/html/draft-ietf-httpapi-deprecation-header"><code>Deprecation</code></a> and <a href="https://tools.ietf.org/html/rfc8594"><code>Sunset</code></a> headers in HTTP responses
to get information about future sunset of APIs and API features (see <a href="#189"><span class="should-keyword"><strong>SHOULD</strong></span> add <code>Deprecation</code> and <code>Sunset</code> header to responses</a>).
We recommend that client owners build alerts on this monitoring information to
ensure alignment with service owners on required migration task.</p>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> In earlier guideline versions, we used the <code>Warning</code> header to provide
the deprecation info (see hint in <a href="#189"><span class="should-keyword"><strong>SHOULD</strong></span> add <code>Deprecation</code> and <code>Sunset</code> header to responses</a>).</p>
</div>
</div>
<div class="sect2">
<h3 id="191"><a class="link" href="#191"><span class="must-keyword"><strong>MUST</strong></span> not start using deprecated APIs</a></h3>
<div class="paragraph">
<p>Clients must not start using deprecated APIs, API versions, or API features.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api-operation"><a class="link" href="#api-operation">17. REST Operation</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="192"><a class="link" href="#192"><span class="must-keyword"><strong>MUST</strong></span> publish OpenAPI specification</a></h3>
<div class="paragraph">
<p>All service applications must publish OpenAPI specifications of their external
APIs. While this is optional for internal APIs, i.e. APIs marked with the
<strong>component-internal</strong> <a href="#219">API audience</a> group, we still recommend to do so
to profit from the API management infrastructure.</p>
</div>
<div class="paragraph">
<p>An API is published by copying its <strong>OpenAPI specification</strong> into the reserved
<strong>/zalando-apis</strong> directory of the <strong>deployment artifact</strong> used to deploy the
provisioning service. The directory must only contain <strong>self-contained YAML</strong>
<strong>files</strong> that each describe one API (exception see <a href="#234"><span class="must-keyword"><strong>MUST</strong></span> only use durable and immutable remote references</a>). We prefer this
deployment artifact-based method over the past (now legacy)
<code>.well-known/schema-discovery</code> service endpoint-based publishing process, that
we only support for backward compatibility reasons.</p>
</div>
<div class="paragraph">
<p>Background: In our dynamic and complex service infrastructure, it is important
to provide API client developers a central place with online access to the API
specifications of all running applications. As a part of the infrastructure,
the API publishing process is used to detect API specifications. The findings
are published in the API Portal - the universal hub for all Zalando APIs.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> To publish an API, it is still necessary to deploy the artifact
successful, as we focus the discovery experience on APIs supported by running
services.</p>
</div>
</div>
<div class="sect2">
<h3 id="193"><a class="link" href="#193"><span class="should-keyword"><strong>SHOULD</strong></span> monitor API usage</a></h3>
<div class="paragraph">
<p>Owners of APIs used in production should monitor API service to get
information about its using clients. This information, for instance, is
useful to identify potential review partner for API changes.</p>
</div>
<div class="paragraph">
<p>Hint: A preferred way of client detection implementation is by logging
of the client-id retrieved from the OAuth token.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="events"><a class="link" href="#events">18. EVENT Basics - Event Types</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Zalando’s architecture centers around decoupled microservices and in
that context we favour asynchronous event driven approaches. The
guidelines focus on how to design and publish events
intended to be shared for others to consume.</p>
</div>
<div class="paragraph">
<p>Events are defined using an item called an <em>Event Type</em>. The Event Type
allows events to have their structure declared with a schema by
producers and understood by consumers. An Event Type declares standard
information, such as a name, an owning application (and by implication,
an owning team), a schema defining the event&#8217;s custom data, and a
compatibility mode declaring how the schema will be evolved. Event Types
also allow the declaration of validation and enrichment strategies for
events, along with supplemental information such as how events can be
partitioned in an event stream.</p>
</div>
<div class="paragraph">
<p>Event Types belong to a well known <em>Event Category</em> (such as a data
change category), which provides extra information that is common to
that kind of event.</p>
</div>
<div class="paragraph">
<p>Event Types can be published and made available as API resources for
teams to use, typically in an <em>Event Type Registry</em>. Each event
published can then be validated against the overall structure of its
event type and the schema for its custom data.</p>
</div>
<div class="paragraph">
<p>The basic model described above was originally developed in the
<a href="https://github.com/zalando/nakadi">Nakadi project</a>, which acts as a
reference implementation (see also <a href="https://apis.zalando.net/apis/nakadi-event-bus-api-definition/ui">Nakadi API (internal_link)</a>)
of the event type registry, and as a validating
publish/subscribe broker for event producers and consumers.</p>
</div>
<div class="sect2">
<h3 id="208"><a class="link" href="#208"><span class="must-keyword"><strong>MUST</strong></span> define events compliant with overall API guidelines</a></h3>
<div class="paragraph">
<p>Events must be consistent with other API data and the API Guidelines in
general (as far as applicable).</p>
</div>
<div class="paragraph">
<p>Everything expressed in the <a href="#introduction">Introduction</a> to
these Guidelines is applicable to event data interchange between
services. This is because our events, just like our APIs, represent a
commitment to express what our systems do and designing high-quality,
useful events allows us to develop new and interesting products and
services.</p>
</div>
<div class="paragraph">
<p>What distinguishes events from other kinds of data is the delivery style
used, asynchronous publish-subscribe messaging. But there is no reason
why they could not be made available using a REST API, for example via a
search request or as a paginated feed, and it will be common to base
events on the models created for the service’s REST API.</p>
</div>
<div class="paragraph">
<p>The following existing guideline sections are applicable to events:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#general-guidelines">General guidelines</a></p>
</li>
<li>
<p><a href="#data-formats">REST Basics - Data formats</a></p>
</li>
<li>
<p><a href="#json-guidelines">REST Basics - JSON payload</a></p>
</li>
<li>
<p><a href="#hypermedia">REST Design - Hypermedia</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="194"><a class="link" href="#194"><span class="must-keyword"><strong>MUST</strong></span> treat events as part of the service interface</a></h3>
<div class="paragraph">
<p>Events are part of a service’s interface to the outside world equivalent
in standing to a service’s REST API. Services publishing data for
integration must treat their events as a first class design concern,
just as they would an API. For example this means approaching events
with the "API first" principle in mind as described in the <a href="#introduction">Introduction</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="195"><a class="link" href="#195"><span class="must-keyword"><strong>MUST</strong></span> make event schema available for review</a></h3>
<div class="paragraph">
<p>Services publishing event data for use by others must make the event
schema as well as the event type definition available for review.</p>
</div>
</div>
<div class="sect2">
<h3 id="197"><a class="link" href="#197"><span class="must-keyword"><strong>MUST</strong></span> specify and register events as event types</a></h3>
<div class="paragraph">
<p>In Zalando&#8217;s architecture, events are registered using a structure
called an <em>Event Type</em>. The Event Type declares standard information as
follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A well known event category, such as a general or data change
category.</p>
</li>
<li>
<p>The name of the event type.</p>
</li>
<li>
<p>The definition of the <a href="#219">event target audience</a>.</p>
</li>
<li>
<p>An owning application, and by implication, an owning team.</p>
</li>
<li>
<p>A schema defining the event payload.</p>
</li>
<li>
<p>The compatibility mode for the type.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Event Types allow easier discovery of event information and ensure that
information is well-structured, consistent, and can be validated.
The core Event Type structure is shown below as an OpenAPI object
definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">EventType</span>:
  <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
    An event type defines the schema and its runtime properties. The required
    fields are the minimum set the creator of an event type is expected to
    supply.</span></span>
  <span class="key">required</span>:
    - <span class="string"><span class="content">name</span></span>
    - <span class="string"><span class="content">category</span></span>
    - <span class="string"><span class="content">owning_application</span></span>
    - <span class="string"><span class="content">schema</span></span>
  <span class="key">properties</span>:
    <span class="key">name</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        Name of this EventType. The name must follow the functional naming
        pattern `&lt;functional-name&gt;.&lt;event-name&gt;` to preserve global
        uniqueness and readability.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">pattern</span>: <span class="string"><span class="content">'[a-z][a-z0-9-]*\.[a-z][a-z0-9-]*(\.[Vv][0-9.]+)?'</span></span>
      <span class="key">example</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        transactions-order.order-cancelled
        customer-personal-data.email-changed.v2</span></span>
    <span class="key">audience</span>:
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">x-extensible-enum</span>:
        - <span class="string"><span class="content">component-internal</span></span>
        - <span class="string"><span class="content">business-unit-internal</span></span>
        - <span class="string"><span class="content">company-internal</span></span>
        - <span class="string"><span class="content">external-partner</span></span>
        - <span class="string"><span class="content">external-public</span></span>
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        Intended target audience of the event type, analogue to audience definition for REST APIs
        in rule #219 -- see https://opensource.zalando.com/restful-api-guidelines/#219</span></span>
    <span class="key">owning_application</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        Name of the application (eg, as would be used in infrastructure
        application or service registry) owning this `EventType`.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">price-service</span></span>
    <span class="key">category</span>:
      <span class="key">description</span>: <span class="string"><span class="content">Defines the category of this EventType.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">x-extensible-enum</span>:
        - <span class="string"><span class="content">data</span></span>
        - <span class="string"><span class="content">general</span></span>
    <span class="key">compatibility_mode</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        The compatibility mode to evolve the schema.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">x-extensible-enum</span>:
        - <span class="string"><span class="content">compatible</span></span>
        - <span class="string"><span class="content">forward</span></span>
        - <span class="string"><span class="content">none</span></span>
      <span class="key">default</span>: <span class="string"><span class="content">forward</span></span>
    <span class="key">schema</span>:
      <span class="key">description</span>: <span class="string"><span class="content">The most recent payload schema for this EventType.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">object</span></span>
      <span class="key">properties</span>:
        <span class="key">version</span>:
          <span class="key">description</span>: <span class="string"><span class="content">Values are based on semantic versioning (eg &quot;1.2.1&quot;).</span></span>
          <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
          <span class="key">default</span>: <span class="string"><span class="content">'1.0.0'</span></span>
        <span class="key">created_at</span>:
          <span class="key">description</span>: <span class="string"><span class="content">Creation timestamp of the schema.</span></span>
          <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
          <span class="key">readOnly</span>: <span class="string"><span class="content">true</span></span>
          <span class="key">format</span>: <span class="string"><span class="content">date-time</span></span>
          <span class="key">example</span>: <span class="string"><span class="content">'1996-12-19T16:39:57-08:00'</span></span>
        <span class="key">type</span>:
          <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
             The schema language of schema definition. Currently only
             json_schema (JSON Schema v04) syntax is defined, but in the
             future there could be others.</span></span>
          <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
          <span class="key">x-extensible-enum</span>:
            - <span class="string"><span class="content">json_schema</span></span>
        <span class="key">schema</span>:
          <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
              The schema as string in the syntax defined in the field type.</span></span>
          <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">required</span>:
        - <span class="string"><span class="content">type</span></span>
        - <span class="string"><span class="content">schema</span></span>
    <span class="key">ordering_key_fields</span>:
      <span class="key">type</span>: <span class="string"><span class="content">array</span></span>
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        Indicates which field is used for application level ordering of events.
        It is typically a single field, but also multiple fields for compound
        ordering key are supported (first item is most significant).

        This is an informational only event type attribute for specification of
        application level ordering. Nakadi transportation layer is not affected,
        where events are delivered to consumers in the order they were published.

        Scope of the ordering is all events (of all partitions), unless it is
        restricted to data instance scope in combination with
        `ordering_instance_ids` attribute below.

        This field can be modified at any moment, but event type owners are
        expected to notify consumer in advance about the change.

        *Background:* Event ordering is often created on application level using
        ascending counters, and data providers/consumers do not need to rely on the
        event publication order. A typical example are data instance change events
        used to keep a data store replica in sync. Here you have an order
        defined per instance using data object change counters (aka row update
        version) and the order of event publication is not relevant, because
        consumers for data synchronization skip older instance versions when they
        reconstruct the data object replica state.</span></span>

      <span class="key">items</span>:
        <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
        <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
          Indicates a single ordering field. This is a JsonPointer, which is applied
          onto the whole event object, including the contained metadata and data (in
          case of a data change event) objects. It must point to a field of type
          string or number/integer (as for those the ordering is obvious).

          Indicates a single ordering field. It is a simple path (dot separated) to
          the JSON leaf element of the whole event object, including the contained metadata and data (in
          case of a data change event) objects. It must point to a field of type
          string or number/integer (as for those the ordering is obvious), and must be
          present in the schema.</span></span>
        <span class="key">example</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">data.order_change_counter</span><span class="delimiter">&quot;</span></span>
    <span class="key">ordering_instance_ids</span>:
      <span class="key">type</span>: <span class="string"><span class="content">array</span></span>
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        Indicates which field represents the data instance identifier and scope in
        which ordering_key_fields provides a strict order. It is typically a single
        field, but multiple fields for compound identifier keys are also supported.

        This is an informational only event type attribute without specific Nakadi
        semantics for specification of application level ordering. It only can be
        used in combination with `ordering_key_fields`.

        This field can be modified at any moment, but event type owners are expected
        to notify consumer in advance about the change.</span></span>
      <span class="key">items</span>:
        <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
        <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
          Indicates a single key field. It is a simple path (dot separated) to the JSON
          leaf element of the whole event object, including the contained metadata and
          data (in case of a data change event) objects, and it must be present in the
          schema.</span></span>
       <span class="key">example</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">data.order_number</span><span class="delimiter">&quot;</span></span>
    <span class="key">created_at</span>:
      <span class="key">description</span>: <span class="string"><span class="content">When this event type was created.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">pattern</span>: <span class="string"><span class="content">date-time</span></span>
    <span class="key">updated_at</span>:
      <span class="key">description</span>: <span class="string"><span class="content">When this event type was last updated.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">pattern</span>: <span class="string"><span class="content">date-time</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>APIs such as registries supporting event types, may extend the model,
including the set of supported categories and schema formats. For
example the Nakadi API&#8217;s event category registration also allows the
declaration of validation and enrichment strategies for events, along
with supplemental information, such as how events are partitioned in the
stream (see <a href="#204"><span class="should-keyword"><strong>SHOULD</strong></span> use the hash partition strategy for data change events</a>).</p>
</div>
</div>
<div class="sect2">
<h3 id="213"><a class="link" href="#213"><span class="must-keyword"><strong>MUST</strong></span> follow naming convention for event type names</a></h3>
<div class="paragraph">
<p>Event type names must (or should, see <a href="#223"><span class="must-keyword"><strong>MUST</strong></span>/<span class="should-keyword"><strong>SHOULD</strong></span>/<span class="may-keyword"><strong>MAY</strong></span> use functional naming schema</a> for details and definition)
conform to the functional naming depending on the <a href="#219">audience</a> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bnf">&lt;event-type-name&gt;       ::= &lt;functional-event-name&gt; | &lt;application-event-name&gt;

&lt;functional-event-name&gt; ::= &lt;functional-name&gt;.&lt;event-name&gt;[.&lt;version&gt;]

&lt;event-name&gt;            ::= [a-z][a-z0-9-]* -- free event name (functional name)

&lt;version&gt;               ::= [Vv][0-9.]* -- major version of non compatible schemas</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> The following convention (e.g. used by legacy STUPS infrastructure) is deprecated
and <strong>only</strong> allowed for <a href="#223">internal</a> event type names:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bnf">&lt;application-event-name&gt; ::= [&lt;organization-id&gt;.]&lt;application-id&gt;.&lt;event-name&gt;
&lt;organization-id&gt;  ::= [a-z][a-z0-9-]* -- organization identifier, e.g. team identifier
&lt;application-id&gt;   ::= [a-z][a-z0-9-]* -- application identifier</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> consistent naming should be used whenever the same entity is exposed
by a data change event and a RESTful API.</p>
</div>
</div>
<div class="sect2">
<h3 id="207"><a class="link" href="#207"><span class="must-keyword"><strong>MUST</strong></span> indicate ownership of event types</a></h3>
<div class="paragraph">
<p>Event definitions must have clear ownership - this can be indicated via
the <code>owning_application</code> field of the EventType.</p>
</div>
<div class="paragraph">
<p>Typically there is one producer application, which owns the EventType
and is responsible for its definition, akin to how RESTful API
definitions are managed. However, the owner may also be a particular
service from a set of multiple services that are producing the same kind
of event.</p>
</div>
</div>
<div class="sect2">
<h3 id="245"><a class="link" href="#245"><span class="must-keyword"><strong>MUST</strong></span> carefully define the compatibility mode</a></h3>
<div class="paragraph">
<p>Event type owners must pay attention to the choice of compatibility
mode. The mode provides a means to evolve the schema. The range of
modes are designed to be flexible enough so that producers can evolve
schemas while not inadvertently breaking existing consumers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>none</code>: Any schema modification is accepted, even if it might break
existing producers or consumers. When validating events, undefined
properties are accepted unless declared in the schema.</p>
</li>
<li>
<p><code>forward</code>: A schema <code>S1</code> is forward compatible if the previously
registered schema, <code>S0</code> can read events defined by <code>S1</code> - that is,
consumers can read events tagged with the latest schema version using
the previous version as long as consumers follow the robustness
principle described in the guideline&#8217;s <a href="#api-design-principles">API design principles</a>.</p>
</li>
<li>
<p><code>compatible</code>: This means changes are fully compatible. A new schema,
<code>S1</code>, is fully compatible when every event published since the first
schema version will validate against the latest schema. In compatible
mode, only the addition of new optional properties and definitions to an
existing schema is allowed. Other changes are forbidden.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="196"><a class="link" href="#196"><span class="must-keyword"><strong>MUST</strong></span> ensure event schema conforms to OpenAPI schema object</a></h3>
<div class="paragraph">
<p>To align the event schema specifications to API specifications, we use
the Schema Object as defined by the OpenAPI Specifications to define event
schemas. This is particularly useful for events that represent data changes
about resources also used in other APIs.</p>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/OAI/OpenAPI-Specification/blob/main/versions/2.0.md#schemaObject">OpenAPI Schema Object</a>
is an <strong>extended subset</strong> of
<a href="http://json-schema.org/">JSON Schema Draft 4</a>. For convenience,
we highlight some important differences below. Please refer to the
<a href="https://github.com/OAI/OpenAPI-Specification/blob/main/versions/2.0.md#schemaObject">OpenAPI Schema Object specification</a>
for details.</p>
</div>
<div class="paragraph">
<p>As the OpenAPI Schema Object specification <em>removes</em> some JSON Schema
keywords, the following properties <strong>must not</strong> be used in event schemas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>additionalItems</code></p>
</li>
<li>
<p><code>contains</code></p>
</li>
<li>
<p><code>patternProperties</code></p>
</li>
<li>
<p><code>dependencies</code></p>
</li>
<li>
<p><code>propertyNames</code></p>
</li>
<li>
<p><code>const</code></p>
</li>
<li>
<p><code>not</code></p>
</li>
<li>
<p><code>oneOf</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>On the other side Schema Object <em>redefines</em> some JSON Schema keywords:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>additionalProperties</code>: For event types that declare compatibility
guarantees, there are recommended constraints around the use of this
field. See the guideline <a href="#210"><span class="should-keyword"><strong>SHOULD</strong></span> avoid <code>additionalProperties</code> in event type schemas</a> for details.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Finally, the Schema Object <em>extends</em> JSON Schema with some keywords:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>readOnly</code>: events are logically immutable, so <code>readOnly</code> can be
considered redundant, but harmless.</p>
</li>
<li>
<p><code>discriminator</code>: to support polymorphism, as an alternative to <code>oneOf</code>.</p>
</li>
<li>
<p><code>^x-</code>: patterned objects in the form of
<a href="https://github.com/OAI/OpenAPI-Specification/blob/main/versions/2.0.md#vendorExtensions">vendor
extensions</a> can be used in event type schema, but it might be the case
that general purpose validators do not understand them to enforce a
validation check, and fall back to must-ignore processing. A future
version of the guidelines may define well known vendor extensions for
events.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="210"><a class="link" href="#210"><span class="should-keyword"><strong>SHOULD</strong></span> avoid <code>additionalProperties</code> in event type schemas</a></h3>
<div class="paragraph">
<p>Event type schema should avoid using <code>additionalProperties</code>
declarations, in order to support schema evolution.</p>
</div>
<div class="paragraph">
<p>Events are often intermediated by publish/subscribe systems and are
commonly captured in logs or long term storage to be read later. In
particular, the schemas used by publishers and consumers can<br>
drift over time. As a result, compatibility and extensibility issues
that happen less frequently with client-server style APIs become
important and regular considerations for event design. The guidelines
recommend the following to enable event schema evolution:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Publishers who intend to provide compatibility and allow their schemas
to evolve safely over time <strong>must not</strong> declare an <code>additionalProperties</code>
field with a value of <code>true</code> (i.e., a wildcard extension point). Instead
they must define new optional fields and update their schemas in advance
of publishing those fields.</p>
</li>
<li>
<p>Consumers <strong>must</strong> ignore fields they cannot process and not raise
errors. This can happen if they are processing events with an older copy
of the event schema than the one containing the new definitions
specified by the publishers.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The above constraint does not mean fields can never be added in future
revisions of an event type schema - additive compatible changes are
allowed, only that the new schema for an event type must define the
field first before it is published within an event. By the same turn the
consumer must ignore fields it does not know about from its copy of the
schema, just as they would as an API client - that is, they cannot treat
the absence of an <code>additionalProperties</code> field as though the event type
schema was closed for extension.</p>
</div>
<div class="paragraph">
<p>Requiring event publishers to define their fields ahead of publishing
avoids the problem of <em>field redefinition</em>. This is when a publisher
defines a field to be of a different type that was already being
emitted, or, is changing the type of an undefined field. Both of these
are prevented by not using <code>additionalProperties</code>.</p>
</div>
<div class="paragraph">
<p>See also rule <a href="#111"><span class="must-keyword"><strong>MUST</strong></span> treat OpenAPI specification as open for extension by default</a> in the <a href="#compatibility">REST Design - Compatibility</a> section for further guidelines
on the use of <code>additionalProperties</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="246"><a class="link" href="#246"><span class="must-keyword"><strong>MUST</strong></span> use semantic versioning of event type schemas</a></h3>
<div class="paragraph">
<p>Event schemas must be versioned&#8201;&#8212;&#8201;analog to <a href="#116"><span class="must-keyword"><strong>MUST</strong></span> use semantic versioning</a> for REST API definitions.
The compatibility mode interact with revision numbers in the schema
<code>version</code> field, which follows semantic versioning (MAJOR.MINOR.PATCH):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Changing an event type with compatibility mode <code>compatible</code> or <code>forward</code>
can lead to a PATCH or MINOR version revision.
MAJOR breaking changes are not allowed.</p>
</li>
<li>
<p>Changing an event type with compatibility mode <code>none</code> can lead to
PATCH, MINOR or MAJOR level changes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following examples illustrate these relations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Changes to the event type&#8217;s <code>title</code> or <code>description</code> are considered
PATCH level.</p>
</li>
<li>
<p>Adding new optional fields to an event type&#8217;s schema is considered a
MINOR level change.</p>
</li>
<li>
<p>All other changes are considered MAJOR level, such as renaming or
removing fields, or adding new required fields.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="event-categories"><a class="link" href="#event-categories">19. EVENT Basics - Event Categories</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>An <em>event category</em> describes a generic class of event types. The
guidelines define two such categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>General Event: a general purpose category.</p>
</li>
<li>
<p>Data Change Event: a category to inform about data entity changes
and used e.g. for data replication based data integration.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="198"><a class="link" href="#198"><span class="must-keyword"><strong>MUST</strong></span> ensure that events conform to an event category</a></h3>
<div class="paragraph">
<p>A category describes a predefined structure (e.g. including event
metadata as part of the event payload) that event publishers must
conform to along with standard information specific for the event category
(e.g. the operation for data change events).</p>
</div>
<div class="sect3">
<h4 id="_the_general_event_category"><a class="link" href="#_the_general_event_category">The general event category</a></h4>
<div class="paragraph">
<p>The structure of the <em>General Event Category</em> is shown below as an OpenAPI
Schema Object definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">GeneralEvent</span>:
  <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
    A general kind of event. Event kinds based on this event define their
    custom schema payload as the top level of the document, with the
    &quot;metadata&quot; field being required and reserved for standard metadata. An
    instance of an event based on the event type thus conforms to both the
    EventMetadata definition and the custom schema definition.
    Hint: In earlier versions this category was called the Business Category.</span></span>
  <span class="key">required</span>:
    - <span class="string"><span class="content">metadata</span></span>
  <span class="key">properties</span>:
    <span class="key">metadata</span>:
        <span class="error">$ref</span>: <span class="error">'#/definitions/EventMetadata'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Event types based on the General Event Category define their custom
schema payload at the top-level of the document, with the
<a href="#event-metadata">metadata</a> field being reserved for standard
information (the contents of <a href="#event-metadata">metadata</a> are
described further down in this section).</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>The General Event was called a <em>Business Event</em> in earlier versions of
the guidelines. Implementation experience has shown that the
category&#8217;s structure gets used for other kinds of events, hence the name
has been generalized to reflect how teams are using it.</p>
</li>
<li>
<p>The General Event is still useful and recommended for the purpose of
defining events that drive a business process.</p>
</li>
<li>
<p>The Nakadi broker still refers to the General Category as the Business
Category and uses the keyword <code>business</code> for event type registration.
Other than that, the JSON structures are identical.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#201"><span class="must-keyword"><strong>MUST</strong></span> use general events to signal steps in business processes</a> for more guidance on how to use the category.</p>
</div>
</div>
<div class="sect3">
<h4 id="_the_data_change_event_category"><a class="link" href="#_the_data_change_event_category">The data change event category</a></h4>
<div class="paragraph">
<p>The <em>Data Change Event Category</em> structure is shown below as an OpenAPI
Schema Object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">DataChangeEvent</span>:
  <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
    Represents a change to an entity. The required fields are those
    expected to be sent by the producer, other fields may be added
    by intermediaries such as a publish/subscribe broker. An instance
    of an event based on the event type conforms to both the
    DataChangeEvent's definition and the custom schema definition.</span></span>
  <span class="key">required</span>:
    - <span class="string"><span class="content">metadata</span></span>
    - <span class="string"><span class="content">data_op</span></span>
    - <span class="string"><span class="content">data_type</span></span>
    - <span class="string"><span class="content">data</span></span>
  <span class="key">properties</span>:
    <span class="key">metadata</span>:
      <span class="key">description</span>: <span class="string"><span class="content">The metadata for this event.</span></span>
      <span class="error">$ref</span>: <span class="error">'#/definitions/EventMetadata'</span>
    <span class="key">data</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        Contains custom payload for the event type. The payload must conform
        to a schema associated with the event type declared in the metadata
        object's `event_type` field.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">object</span></span>
    <span class="key">data_type</span>:
      <span class="key">description</span>: <span class="string"><span class="content">name of the (business) data entity that has been mutated</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">'sales_order.order'</span></span>
    <span class="key">data_op</span>:
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">enum</span>: <span class="string"><span class="content">['C', 'U', 'D', 'S']</span></span>
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        The type of operation executed on the entity:

        - C: Creation of an entity
        - U: An update to an entity.
        - D: Deletion of an entity.
        - S: A snapshot of an entity at a point in time.</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The Data Change Event Category is structurally different to the General Event Category
by defining a field called <code>data</code> as container for the custom payload, as well as
specific information related to data changes in the <code>data_op</code>.</p>
</div>
<div class="paragraph">
<p>The following guidelines specifically apply to Data Change Events:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#202"><span class="must-keyword"><strong>MUST</strong></span> use data change events to signal mutations</a></p>
</li>
<li>
<p><a href="#242"><span class="must-keyword"><strong>MUST</strong></span> provide explicit event ordering for data change events</a></p>
</li>
<li>
<p><a href="#205"><span class="should-keyword"><strong>SHOULD</strong></span> ensure that data change events match the APIs resources</a></p>
</li>
<li>
<p><a href="#204"><span class="should-keyword"><strong>SHOULD</strong></span> use the hash partition strategy for data change events</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="event-metadata"><a class="link" href="#event-metadata">Event metadata</a></h4>

</div>
</div>
<div class="sect2">
<h3 id="247"><a class="link" href="#247"><span class="must-keyword"><strong>MUST</strong></span> provide mandatory event metadata</a></h3>
<div class="paragraph">
<p>The General and Data Change event categories share a common structure for <em>metadata</em>
representing generic event information. Parts of the metadata is provided by the
Nakadi event messaging platform, but event identifier (eid) and event creation
timestamp (occurred_at) have to be provided by the event producers.
The metadata structure is defined below as an OpenAPI Schema Object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">EventMetadata</span>:
  <span class="key">type</span>: <span class="string"><span class="content">object</span></span>
  <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
    Carries metadata for an Event along with common fields. The required
    fields are those expected to be sent by the producer, other fields may be
    added by intermediaries such as publish/subscribe broker.</span></span>
  <span class="key">required</span>:
    - <span class="string"><span class="content">eid</span></span>
    - <span class="string"><span class="content">occurred_at</span></span>
  <span class="key">properties</span>:
    <span class="key">eid</span>:
      <span class="key">description</span>: <span class="string"><span class="content">Identifier of this event.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">format</span>: <span class="string"><span class="content">uuid</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">'105a76d8-db49-4144-ace7-e683e8f4ba46'</span></span>
    <span class="key">event_type</span>:
      <span class="key">description</span>: <span class="string"><span class="content">The name of the EventType of this Event.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">'example.important-business-event'</span></span>
    <span class="key">occurred_at</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
         Technical timestamp of when the event object was created during processing
         of the business event by the producer application. Note, it may differ from
         the timestamp when the related real-world business event happened (e.g. when
         the packet was handed over to the customer), which should be passed separately
         via an event type specific attribute.
         Depending on the producer implementation, the timestamp is typically some
         milliseconds earlier than when the event is published and received by the
         API event post endpoint server -- see below.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">format</span>: <span class="string"><span class="content">date-time</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">'1996-12-19T16:39:57-08:00'</span></span>
    <span class="key">received_at</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        Timestamp of when the event was received via the API event post endpoints.
        It is automatically enriched, and events will be rejected if set by the
        event producer.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">readOnly</span>: <span class="string"><span class="content">true</span></span>
      <span class="key">format</span>: <span class="string"><span class="content">date-time</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">'1996-12-19T16:39:57-08:00'</span></span>
    <span class="key">version</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        Version of the schema used for validating this event. This may be
        enriched upon reception by intermediaries. This string uses semantic
        versioning.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">readOnly</span>: <span class="string"><span class="content">true</span></span>
    <span class="key">parent_eids</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        Event identifiers of the Event that caused the generation of
        this Event. Set by the producer.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">array</span></span>
      <span class="key">items</span>:
        <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
        <span class="key">format</span>: <span class="string"><span class="content">uuid</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">'105a76d8-db49-4144-ace7-e683e8f4ba46'</span></span>
    <span class="key">flow_id</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        A flow-id for this event (corresponds to the X-Flow-Id HTTP header).</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">'JAh6xH4OQhCJ9PutIV_RYw'</span></span>
    <span class="key">partition</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">|</span><span class="content">
        Indicates the partition assigned to this Event. Used for systems
        where an event type's events can be sub-divided into partitions.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">example</span>: <span class="string"><span class="content">'0'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note that intermediaries acting between the producer of an event
and its ultimate consumers, may perform operations like validation of
events and enrichment of an event&#8217;s <a href="#event-metadata">metadata</a>. For
example brokers such as Nakadi, can validate and enrich events with
arbitrary additional fields that are not specified here and may set default
or other values, if some of the specified fields are not supplied. How
such systems work is outside the scope of these guidelines but producers
and consumers working with such systems should look into their documentation
for additional information.</p>
</div>
</div>
<div class="sect2">
<h3 id="211"><a class="link" href="#211"><span class="must-keyword"><strong>MUST</strong></span> provide unique event identifiers</a></h3>
<div class="paragraph">
<p>Event publishers must provide the <code>eid</code> (event identifier) as a standard
event object field and part of the event <a href="#metadata">metadata</a>.
The <code>eid</code> must be a unique identifier for the event in the scope of the
event type / stream lifetime.</p>
</div>
<div class="paragraph">
<p>Event producers must use the same <code>eid</code> when publishing the same event object
multiple times. For instance, producers must ensure that publish event
retries&#8201;&#8212;&#8201;e.g. due to temporary Nakadi or network failures or fail-overs&#8201;&#8212;&#8201;use
the same <code>eid</code> value as the initial (possibly failed) attempt.</p>
</div>
<div class="paragraph">
<p>The <code>eid</code> supports event consumers in detecting and being robust against
event duplicates&#8201;&#8212;&#8201;see <a href="#214"><span class="must-keyword"><strong>MUST</strong></span> be robust against duplicates when consuming events</a>.</p>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> Using the same eid for retries can be ensured, for instance, by
generating a UUID either (i) as part of the event object construction and
using some form of intermediate persistence, like an event publish retry
queue, or (ii) via a deterministic function that computes the UUID value
from the event fields as input (without random salt).</p>
</div>
</div>
<div class="sect2">
<h3 id="201"><a class="link" href="#201"><span class="must-keyword"><strong>MUST</strong></span> use general events to signal steps in business processes</a></h3>
<div class="paragraph">
<p>When publishing events that represent steps in a business process, event
types <strong>must</strong> be based on the General Event category.
All your events of a single business process will conform to the
following rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Business events must contain a specific identifier field (a business
process id or "bp-id") similar to flow-id to allow for efficient
aggregation of all events in a business process execution.</p>
</li>
<li>
<p>Business events must contain a means to correctly order events in a
business process execution. In distributed settings where monotonically
increasing values (such as a high precision timestamp that is assured to
move forwards) cannot be obtained, the <code>parent_eids</code> data structure
allows causal relationships to be declared between events.</p>
</li>
<li>
<p>Business events should only contain information that is new to the
business process execution at the specific step/arrival point.</p>
</li>
<li>
<p>Each business process sequence should be started by a business event
containing all relevant context information.</p>
</li>
<li>
<p>Business events must be published reliably by the service.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>At the moment we cannot state whether it&#8217;s best practice to publish all
the events for a business process using a single event type and
represent the specific steps with a state field, or whether to use
multiple event types to represent each step. For now we suggest
assessing each option and sticking to one for a given business process.</p>
</div>
</div>
<div class="sect2">
<h3 id="203"><a class="link" href="#203"><span class="should-keyword"><strong>SHOULD</strong></span> provide explicit event ordering for general events</a></h3>
<div class="paragraph">
<p>Event processing consumer applications need the order information to
reconstruct the business event stream, for instance, in order to replay
events in error situations, or to execute analytical use cases
outside the context of the original event stream consumption.
All general events (fka business events) <strong>should</strong> be provided with the explicit
information about the business ordering of the events. To accomplish this
event ordering the event type definition</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>must</strong> specify a the <code>ordering_key_fields</code> property to indicate which
field(s) contain the ordering key, and</p>
</li>
<li>
<p><strong>should</strong> specify the <code>ordering_instance_ids</code> property to define which
field(s) represents the business entity instance identifier.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note:</strong> The <code>ordering_instance_ids</code> restrict the scope in which the
<code>ordering_key_fields</code> provide the strict order. If undefined, the ordering is
assumed to be provided in scope of all events.</p>
</div>
<div class="paragraph">
<p>The business ordering information can be provided – among other ways – by maintaining&#8230;&#8203;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a strictly monotonically increasing version of entity instances (e.g. created as
row update counter by a database), or</p>
</li>
<li>
<p>a strictly monotonically increasing sequence counter (maintained per partition
or event type).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> timestamps are often a bad choice, since in distributed systems events
may occur at the same time, or clocks are not exactly synchronized, or
jump forward and backward to compensate drifts or leap-seconds. If you use anyway
timestamps to indicate event ordering, you <em>must</em> carefully ensure that the designated
event order is not messed up by these effects and use UTC time zone format.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> The <code>received_at</code> and <code>partition_offset</code> metadata set by Nakadi typically is
different from the business event ordering, since (1) Nakadi is a distributed concurrent
system without atomic, ordered event creation and (2) the application&#8217;s implementation
of event publishing may not exactly reflect the business order. The business ordering
information is application knowledge, and implemented in the scope of event
partitions or specific entities, but may also comprise all events, if scaling
requirements are low.</p>
</div>
</div>
<div class="sect2">
<h3 id="202"><a class="link" href="#202"><span class="must-keyword"><strong>MUST</strong></span> use data change events to signal mutations</a></h3>
<div class="paragraph">
<p>You <strong>must</strong> use data change events to signal changes of stored entity instances
and facilitate e.g. change data capture (CDC). Event sourced change data capture
is crucial for our data integration architecture as it supports the logical
replication (and reconstruction) of the application datastores
to the data analytics and AI platform as transactional source datasets.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Change events must be provided when publishing events that represent created,
updated, or deleted data.</p>
</li>
<li>
<p>Change events must provide the complete entity data including the identifier of
the changed instance to allow aggregation of all related events for the entity.</p>
</li>
<li>
<p>Change events <a href="#242"><span class="must-keyword"><strong>MUST</strong></span> provide explicit event ordering for data change events</a>.</p>
</li>
<li>
<p>Change events must be published reliably by the service.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="242"><a class="link" href="#242"><span class="must-keyword"><strong>MUST</strong></span> provide explicit event ordering for data change events</a></h3>
<div class="paragraph">
<p>While the order information is recommended for business events, it <strong>must</strong> be
provided for data change events. The ordering information defines the (create,
update, delete) change order of the data entity instances managed via the
application&#8217;s transactional datastore. It is needed for change data capture
to keep transactional dataset replicas in sync as source for data analytics.</p>
</div>
<div class="paragraph">
<p>For details about how to provide the data change ordering information,
please check <a href="#203"><span class="should-keyword"><strong>SHOULD</strong></span> provide explicit event ordering for general events</a>.</p>
</div>
<div class="paragraph">
<p><strong>Exception</strong>: In situations where the transactional data is 'append only',
i.e. entity instances are only created, but never updated or deleted, the
ordering information may not be provided.</p>
</div>
</div>
<div class="sect2">
<h3 id="204"><a class="link" href="#204"><span class="should-keyword"><strong>SHOULD</strong></span> use the hash partition strategy for data change events</a></h3>
<div class="paragraph">
<p>The <code>hash</code> partition strategy allows a producer to define which fields
in an event are used as input to compute a logical partition the event
should be added to. Partitions are useful as they allow supporting
systems to scale their throughput while provide local ordering for event
entities.</p>
</div>
<div class="paragraph">
<p>The <code>hash</code> option is particularly useful for data changes as it allows
all related events for an entity to be consistently assigned to a
partition, providing a relative ordered stream of events for that
entity. This is because while each partition has a total ordering,
ordering across partitions is not assured by a supporting system, thus
it is possible for events sent across partitions to appear in a
different order to consumers that the order they arrived at the server.</p>
</div>
<div class="paragraph">
<p>When using the <code>hash</code> strategy the partition key in almost all cases
should represent the entity being changed and not a per event or change
identifier such as the <code>eid</code> field or a timestamp. This ensures data
changes arrive at the same partition for a given entity and can be
consumed effectively by clients.</p>
</div>
<div class="paragraph">
<p>There may be exceptional cases where data change events could have their
partition strategy set to be the producer defined or random options, but
generally <code>hash</code> is the right option - that is while the guidelines here
are a "should", they can be read as "must, unless you have a very good
reason".</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="events-design"><a class="link" href="#events-design">20. EVENT Design</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="200"><a class="link" href="#200"><span class="should-keyword"><strong>SHOULD</strong></span> avoid writing sensitive data to events</a></h3>
<div class="paragraph">
<p>Event data security is supported by Nakadi Event Bus mechanisms for access
control and authorization of publishing or consuming events.  However, we avoid
writing sensitive data (e.g. personal data like e-mail or address) to events unless
it is needed for the business. Sensitive data create additional obligations for
access control and compliance and generally increases data protection risks.</p>
</div>
</div>
<div class="sect2">
<h3 id="214"><a class="link" href="#214"><span class="must-keyword"><strong>MUST</strong></span> be robust against duplicates when consuming events</a></h3>
<div class="paragraph">
<p>Duplicate events are multiple occurrences of the same event object representing
the same (business or data change) event instance.</p>
</div>
<div class="paragraph">
<p>Event consumers must be robust against duplicate events. Depending on the use case,
being robust implies that event consumers need to <em>deduplicate events</em>, i.e. to ignore
duplicates in event processing. For instance, for accounting reporting a high accuracy
is required by the business, and duplicates need to be explicitly ignored, whereas
customer behavior reporting (click rates) might not care about event duplicates
since accuracy in per-mille range is not needed.</p>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> Event consumers are supported in deduplication:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deduplication can be based on the <code>eid</code> as mandatory standard for all events&#8201;&#8212;&#8201;see <a href="#211"><span class="must-keyword"><strong>MUST</strong></span> provide unique event identifiers</a>.</p>
</li>
<li>
<p>Processing data change events to replay data changes and keep transactional
data copies in sync (CDC) is robust against duplicates because it is based on
data keys and change ordering&#8201;&#8212;&#8201;see <a href="#202"><span class="must-keyword"><strong>MUST</strong></span> use data change events to signal mutations</a> and <a href="#242"><span class="must-keyword"><strong>MUST</strong></span> provide explicit event ordering for data change events</a>.</p>
</li>
<li>
<p>Data analytics users of the Data Lake are well advised to use curated data as a
source for analytics. Raw event datasets materialized in the lake are typically
cleaned-up (including deduplication and data synchronization) and provided as
transactional data copy or curated data products, for instance
<a href="https://curated-product-data.docs.zalando.net/">curated product data [internal link</a>] or
<a href="https://curated-sales-data.docs.zalando.net/">curated sales data [internal link</a>].</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Context:</strong> One <em>source of duplicate events</em> are the event producers, for instance,
due to publish call retries or publisher client failovers. Another source is
Nakadi&#8217;s 'at-least-once' delivery promise (like provided by most message broker
distributed systems). It also currently applies to the Data Lake event materialization
as raw event datasets (in Delta or JSON format) for Data Analytics.
From an event consumer point of view, duplicate events may also be created when
consumers reprocess parts of the event stream, for instance, due to inaccurate
continuation after failures. Event publishers and infrastructure systems should
keep event duplication at a minimum typically below per-mille range.
(In Nov. 2022, for instance, we observed &lt;0.2 ‰ daily event duplicate
rate (95th percentile) for high volume events.)</p>
</div>
</div>
<div class="sect2">
<h3 id="212"><a class="link" href="#212"><span class="should-keyword"><strong>SHOULD</strong></span> design for idempotent out-of-order processing</a></h3>
<div class="paragraph">
<p>Events that are designed for <a href="#149">idempotent</a> out-of-order
processing allow for extremely resilient systems: If processing an event
fails, consumers and producers can skip/delay/retry it without stopping
the world or corrupting the processing result.</p>
</div>
<div class="paragraph">
<p>To enable this freedom of processing, you must explicitly design for
idempotent out-of-order processing: Either your events must contain
enough information to infer their original order during consumption or
your domain must be designed in a way that order becomes irrelevant.</p>
</div>
<div class="paragraph">
<p>As common example similar to data change events, idempotent out-of-order
processing can be supported by sending the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the process/resource/entity identifier,</p>
</li>
<li>
<p>a <a href="#203">monotonically increasing ordering key</a> and</p>
</li>
<li>
<p>the process/resource state after the change.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A receiver that is interested in the current state can then ignore
events that are older than the last processed event of each resource. A
receiver interested in the history of a resource can use the ordering
key to recreate a (partially) ordered sequence of events.</p>
</div>
</div>
<div class="sect2">
<h3 id="199"><a class="link" href="#199"><span class="must-keyword"><strong>MUST</strong></span> ensure that events define useful business resources</a></h3>
<div class="paragraph">
<p>Events are intended to be used by other services including business
process/data analytics and monitoring. They should be based around the
resources and business processes you have defined for your service
domain and adhere to its natural lifecycle (see also <a href="#139"><span class="should-keyword"><strong>SHOULD</strong></span> model complete business processes</a> and <a href="#140"><span class="should-keyword"><strong>SHOULD</strong></span> define <em>useful</em> resources</a>).</p>
</div>
<div class="paragraph">
<p>As there is a cost in creating an explosion of event types and topics,
prefer to define event types that are abstract/generic enough to be
valuable for multiple use cases, and avoid publishing event types
without a clear need.</p>
</div>
</div>
<div class="sect2">
<h3 id="205"><a class="link" href="#205"><span class="should-keyword"><strong>SHOULD</strong></span> ensure that data change events match the APIs resources</a></h3>
<div class="paragraph">
<p>A data change event&#8217;s representation of an entity should correspond to
the REST API representation.</p>
</div>
<div class="paragraph">
<p>There&#8217;s value in having the fewest number of published structures for a
service. Consumers of the service will be working with fewer
representations, and the service owners will have less API surface to
maintain. In particular, you should only publish events that are
interesting in the domain and abstract away from implementation or local
details - there&#8217;s no need to reflect every change that happens within
your system.</p>
</div>
<div class="paragraph">
<p>There are cases where it could make sense to define data change events
that don&#8217;t directly correspond to your API resource representations.
Some examples are -</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Where the API resource representations are very different from the
datastore representation, but the physical data are easier to reliably
process for data integration.</p>
</li>
<li>
<p>Publishing aggregated data. For example a data change to an individual
entity might cause an event to be published that contains a coarser
representation than that defined for an API</p>
</li>
<li>
<p>Events that are the result of a computation, such as a matching
algorithm, or the generation of enriched data, and which might not be
stored as entity by the service.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="209"><a class="link" href="#209"><span class="must-keyword"><strong>MUST</strong></span> maintain backwards compatibility for events</a></h3>
<div class="paragraph">
<p>Changes to events must be based around making additive and backward
compatible changes. This follows the guideline, "Must: Don’t Break
Backward Compatibility" from the <a href="#compatibility">REST Design - Compatibility</a> guidelines.</p>
</div>
<div class="paragraph">
<p>In the context of events, compatibility issues are complicated by the
fact that producers and consumers of events are highly asynchronous and
can’t use content-negotiation techniques that are available to REST
style clients and servers. This places a higher bar on producers to
maintain compatibility as they will not be in a position to serve
versioned media types on demand.</p>
</div>
<div class="paragraph">
<p>For event schema, these are considered backward compatible changes, as
seen by consumers -</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adding new optional fields to JSON objects.</p>
</li>
<li>
<p>Changing the order of fields (field order in objects is arbitrary).</p>
</li>
<li>
<p>Changing the order of values with same type in an array.</p>
</li>
<li>
<p>Removing optional fields.</p>
</li>
<li>
<p>Removing an individual value from an enumeration.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These are considered backwards-incompatible changes, as seen by
consumers -</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Removing required fields from JSON objects.</p>
</li>
<li>
<p>Changing the default value of a field.</p>
</li>
<li>
<p>Changing the type of a field, object, enum or array.</p>
</li>
<li>
<p>Changing the order of values with different type in an array (also
known as a tuple).</p>
</li>
<li>
<p>Adding a new optional field to redefine the meaning of an existing
field (also known as a co-occurrence constraint).</p>
</li>
<li>
<p>Adding a value to an enumeration (note that <a href="#112"><code>x-extensible-enum</code></a>
is not available in JSON Schema)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="appendix-references"><a class="link" href="#appendix-references">Appendix A: References</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section collects links to documents to which we refer, and base our guidelines on.</p>
</div>
<div class="sect2">
<h3 id="openapi-specification"><a class="link" href="#openapi-specification">OpenAPI specification</a></h3>
<div class="ulist">
<ul>
<li>
<p><strong><a href="https://github.com/OAI/OpenAPI-Specification/">OpenAPI specification</a></strong></p>
</li>
<li>
<p><strong><a href="https://openapi-map.apihandyman.io/">OpenAPI specification mind map</a></strong></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="publications-specifications-and-standards"><a class="link" href="#publications-specifications-and-standards">Publications, specifications and standards</a></h3>
<div class="ulist">
<ul>
<li>
<p><strong><a href="https://tools.ietf.org/html/rfc3339">RFC 3339</a>:</strong> Date and Time on the Internet: Timestamps</p>
</li>
<li>
<p><strong><a href="https://tools.ietf.org/html/rfc4122">RFC 4122</a>:</strong> A Universally Unique IDentifier (UUID) URN Namespace</p>
</li>
<li>
<p><strong><a href="https://tools.ietf.org/html/rfc4627">RFC 4627</a>:</strong> The application/json Media Type for JavaScript Object Notation (JSON)</p>
</li>
<li>
<p><strong><a href="https://tools.ietf.org/html/rfc4648">RFC 4648</a>:</strong> The Base16, Base32, and Base64 Data Encodings</p>
</li>
<li>
<p><strong><a href="https://tools.ietf.org/html/rfc6585">RFC 6585</a>:</strong> Additional HTTP Status Codes</p>
</li>
<li>
<p><strong><a href="https://tools.ietf.org/html/rfc6902">RFC 6902</a>:</strong> JavaScript Object Notation (JSON) Patch</p>
</li>
<li>
<p><strong><a href="https://tools.ietf.org/html/rfc7159">RFC 7159</a>:</strong> The JavaScript Object Notation (JSON) Data Interchange Format</p>
</li>
<li>
<p><strong><a href="https://tools.ietf.org/html/rfc7240">RFC 7240</a>:</strong> Prefer Header for HTTP</p>
</li>
<li>
<p><strong><a href="https://tools.ietf.org/html/rfc7396">RFC 7396</a>:</strong> JSON Merge Patch</p>
</li>
<li>
<p><strong><a href="https://tools.ietf.org/html/rfc8288">RFC 8288</a>:</strong> Web Linking</p>
</li>
<li>
<p><strong><a href="https://tools.ietf.org/html/rfc9110">RFC 9110</a>:</strong> HTTP Semantics</p>
</li>
<li>
<p><strong><a href="https://tools.ietf.org/html/rfc9111">RFC 9111</a>:</strong> HTTP Caching</p>
</li>
<li>
<p><strong><a href="https://tools.ietf.org/html/rfc9457">RFC 9457</a>:</strong> Problem Details for HTTP APIs</p>
</li>
<li>
<p><strong><a href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a>:</strong> Date and time format</p>
</li>
<li>
<p><strong><a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">ISO 3166-1 alpha-2</a>:</strong> Two letter country codes</p>
</li>
<li>
<p><strong><a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes">ISO 639-1</a>:</strong> Two letter language codes</p>
</li>
<li>
<p><strong><a href="https://en.wikipedia.org/wiki/ISO_4217">ISO 4217</a>:</strong> Currency codes</p>
</li>
<li>
<p><strong><a href="https://tools.ietf.org/html/bcp47">BCP 47</a>:</strong> Tags for Identifying Languages</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="dissertations"><a class="link" href="#dissertations">Dissertations</a></h3>
<div class="ulist">
<ul>
<li>
<p><strong><a href="http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm">Roy Thomas
Fielding - Architectural Styles and the Design of Network-Based Software
Architectures</a>:</strong> This is the text which defines what REST is.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="books"><a class="link" href="#books">Books</a></h3>
<div class="ulist">
<ul>
<li>
<p><strong><a href="http://www.amazon.de/REST-Practice-Hypermedia-Systems-Architecture/dp/0596805829">REST in Practice: Hypermedia and Systems Architecture</a></strong></p>
</li>
<li>
<p><strong><a href="https://leanpub.com/build-apis-you-wont-hate">Build APIs You Won&#8217;t Hate</a></strong></p>
</li>
<li>
<p><strong><a href="http://www.infoq.com/minibooks/emag-web-api">InfoQ eBook - Web APIs: From Start to Finish</a></strong></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="blogs"><a class="link" href="#blogs">Blogs</a></h3>
<div class="ulist">
<ul>
<li>
<p><strong><a href="http://restful-api-design.readthedocs.org/en/latest/">Lessons-learned blog: Thoughts on RESTful API Design</a></strong></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="appendix-tooling"><a class="link" href="#appendix-tooling">Appendix B: Tooling</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is not a part of the actual guidelines, but might be helpful for following them.
Using a tool mentioned here doesn&#8217;t automatically ensure you follow the guidelines.</p>
</div>
<div class="sect2">
<h3 id="api-first-integrations"><a class="link" href="#api-first-integrations">API first integrations</a></h3>
<div class="paragraph">
<p>The following frameworks were specifically designed to support the API First
workflow with OpenAPI YAML files (sorted alphabetically):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><a href="https://github.com/zalando/connexion">Connexion</a>:</strong>
OpenAPI First framework for Python on top of Flask</p>
</li>
<li>
<p><strong><a href="https://github.com/zalando/api-first-hand">Api-First-Hand</a>:</strong>
API-First Play Bootstrapping Tool for Swagger/OpenAPI specs</p>
</li>
<li>
<p><strong><a href="https://github.com/swagger-api/swagger-codegen">Swagger Codegen</a>:</strong>
template-driven engine to generate client code in different languages by
parsing Swagger Resource Declaration</p>
</li>
<li>
<p><strong><a href="https://github.com/zalando-stups/swagger-codegen-tooling">Swagger Codegen Tooling</a>:</strong>
plugin for Maven that generates pieces of code from OpenAPI specification</p>
</li>
<li>
<p><strong><a href="https://github.com/zalando/intellij-swagger">Swagger Plugin for IntelliJ IDEA</a>:</strong>
plugin to help you easily edit Swagger specification files inside IntelliJ IDEA</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Swagger/OpenAPI homepage lists more
<a href="http://swagger.io/open-source-integrations/">Community-Driven Language
Integrations</a>, but most of them do not fit our API First approach.</p>
</div>
</div>
<div class="sect2">
<h3 id="support-libraries"><a class="link" href="#support-libraries">Support libraries</a></h3>
<div class="paragraph">
<p>These utility libraries support you in implementing various parts of our
RESTful API guidelines (sorted alphabetically):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><a href="https://github.com/zalando/problem">Problem</a>:</strong>
Java library that implements application/problem+json</p>
</li>
<li>
<p><strong><a href="https://github.com/zalando/problem-spring-web">Problems for Spring Web MVC</a>:</strong>
library for handling Problems in Spring Web MVC</p>
</li>
<li>
<p><strong><a href="https://github.com/zalando/jackson-datatype-money">Jackson Datatype Money</a>:</strong>
extension module to properly support datatypes of javax.money</p>
</li>
<li>
<p><strong><a href="https://github.com/zalando/tracer">Tracer</a>:</strong>
call tracing and log correlation in distributed systems</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="appendix-best-practices"><a class="link" href="#appendix-best-practices">Appendix C: Best practices</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The best practices presented in this section are not part of the actual
guidelines, but should provide guidance for common challenges we face when
implementing RESTful APIs.</p>
</div>
<div class="sect2">
<h3 id="cursor-based-pagination"><a class="link" href="#cursor-based-pagination">Cursor-based pagination in RESTful APIs</a></h3>
<div class="paragraph">
<p>Cursor-based pagination is a very powerful and valuable technique (see also
<a href="#160"><span class="should-keyword"><strong>SHOULD</strong></span> prefer cursor-based pagination, avoid offset-based pagination</a>) that allows to efficiently provide a stable view on changing data.
This is obtained by using an anchor element that allows to retrieve all page
elements directly via an ordering combined-index, usually based on <code>created_at</code>
or <code>modified_at</code>. Simple said, the cursor is the information set needed to
reconstruct the database query that retrieves the minimal page information from
the data storage.</p>
</div>
<div class="paragraph">
<p>The <a href="#cursor"><code>cursor</code></a> itself is an opaque string, transmitted forth and back between
service and clients, that must never be <strong>inspected</strong> or <strong>constructed</strong> by
clients. Therefore, it is good practice to encode (encrypt) its content in a
non-human-readable form.</p>
</div>
<div class="paragraph">
<p>The <a href="#cursor"><code>cursor</code></a> content usually consists of a pointer to the anchor element
defining the page position in the collection, a flag whether the element is
included or excluded into/from the page, the retrieval direction, and a hash
over the applied query filters (or the query filter itself) to safely re-create
the collection. It is important to note, that a <a href="#cursor"><code>cursor</code></a> should be always
defined in relation to the current page to anticipate all occurring changes
when progressing.</p>
</div>
<div class="paragraph">
<p>The <a href="#cursor"><code>cursor</code></a> is usually defined as an encoding of the following information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">Cursor</span>:
  <span class="key">descriptions</span>: <span class="string"><span class="delimiter">&gt;</span><span class="content">
    Cursor structure that contains all necessary information to efficiently
    retrieve a page from the data store.</span></span>
  <span class="key">type</span>: <span class="string"><span class="content">object</span></span>
  <span class="key">properties</span>:
    <span class="key">position</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">&gt;</span><span class="content">
        Object containing the keys pointing to the anchor element that is
        defining the collection resource page. Normally the position is given
        by the first or the last page element. The position object contains all
        values required to access the element efficiently via the ordered,
        combined index, e.g `modified_at`, `id`.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">object</span></span>
      <span class="key">properties</span>: <span class="string"><span class="content">...</span></span>

    <span class="key">element</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">&gt;</span><span class="content">
        Flag whether the anchor element, which is pointed to by the `position`,
        should be *included* or *excluded* from the result set. Normally, only
        the current page includes the pointed to element, while all others are
        exclude it.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">enum</span>: <span class="string"><span class="content">[ INCLUDED, EXCLUDED ]</span></span>

    <span class="key">direction</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">&gt;</span><span class="content">
        Flag for the retrieval direction that is defining which elements to
        choose from the collection resource starting from the anchor elements
        position. It is either *ascending* or *descending* based on the
        ordering combined index.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
      <span class="key">enum</span>: <span class="string"><span class="content">[ ASCENDING, DESCENDING ]</span></span>

    <span class="key">query_hash</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">&gt;</span><span class="content">
        Stable hash calculated over all query filters applied to create the
        collection resource that is represented by this cursor.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">string</span></span>

    <span class="key">query</span>:
      <span class="key">description</span>: <span class="string"><span class="delimiter">&gt;</span><span class="content">
        Object containing all query filters applied to create the collection
        resource that is represented by this cursor.</span></span>
      <span class="key">type</span>: <span class="string"><span class="content">object</span></span>
      <span class="key">properties</span>: <span class="string"><span class="content">...</span></span>

  <span class="key">required</span>:
    - <span class="string"><span class="content">position</span></span>
    - <span class="string"><span class="content">element</span></span>
    - <span class="string"><span class="content">direction</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> In case of complex and long search requests, e.g. when <a href="#get-with-body"><code>GET with body</code></a>
is already required, the <a href="#cursor"><code>cursor</code></a> may not be able to include the <code>query</code> because
of common HTTP parameter size restrictions. In this case the <code>query</code> filters
should be transported via body - in the request as well as in the response,
while the pagination consistency should be ensured via the <code>query_hash</code>.</p>
</div>
<div class="paragraph">
<p><strong>Remark:</strong> It is also important to check the efficiency of the data-access.
You need to make sure that you have a fully ordered stable index, that allows
to efficiently resolve all elements of a page. If necessary, you need to
provide a combined index that includes the <code>id</code> to ensure the full order and
additional filter criteria to ensure efficiency.</p>
</div>
<div class="sect3">
<h4 id="_further_reading"><a class="link" href="#_further_reading">Further reading</a></h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://dev.twitter.com/rest/public/timelines">Twitter</a></p>
</li>
<li>
<p><a href="http://use-the-index-luke.com/no-offset">Use the Index, Luke</a></p>
</li>
<li>
<p><a href="https://www.citusdata.com/blog/1872-joe-nelson/409-five-ways-paginate-postgres-basic-exotic">Paging
in PostgreSQL</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="optimistic-locking"><a class="link" href="#optimistic-locking">Optimistic locking in RESTful APIs</a></h3>
<div class="sect3">
<h4 id="_introduction"><a class="link" href="#_introduction">Introduction</a></h4>
<div class="paragraph">
<p>Optimistic locking might be used to avoid concurrent writes on the same entity,
which might cause data loss. A client always has to retrieve a copy of an
entity first and specifically update this one. If another version has been
created in the meantime, the update should fail. In order to make this work,
the client has to provide some kind of version reference, which is checked by
the service, before the update is executed. Please read the more detailed
description on how to update resources via <a href="#put"><code>PUT</code></a> in the <a href="#put">HTTP Requests
Section</a>.</p>
</div>
<div class="paragraph">
<p>A RESTful API usually includes some kind of search endpoint, which will then
return a list of result entities. There are several ways to implement
optimistic locking in combination with search endpoints which, depending on the
approach chosen, might lead to performing additional requests to get the
current version of the entity that should be updated.</p>
</div>
</div>
<div class="sect3">
<h4 id="_etag_with_if_match_header"><a class="link" href="#_etag_with_if_match_header"><code>ETag</code> with <code>If-Match</code> header</a></h4>
<div class="paragraph">
<p>An <a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>ETag</code></a> can only be obtained by performing a <a href="#get"><code>GET</code></a> request on the single
entity resource before the update, i.e. when using a search endpoint an
additional request is necessary.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">&lt; GET /orders

&gt; HTTP/1.1 200 OK
&gt; {
&gt;   &quot;items&quot;: [
&gt;     { &quot;id&quot;: &quot;O0000042&quot; },
&gt;     { &quot;id&quot;: &quot;O0000043&quot; }
&gt;   ]
&gt; }

&lt; GET /orders/BO0000042

&gt; HTTP/1.1 200 OK
&gt; ETag: osjnfkjbnkq3jlnksjnvkjlsbf
&gt; { &quot;id&quot;: &quot;BO0000042&quot;, ... }

&lt; PUT /orders/O0000042
&lt; If-Match: osjnfkjbnkq3jlnksjnvkjlsbf
&lt; { &quot;id&quot;: &quot;O0000042&quot;, ... }

&gt; HTTP/1.1 204 No Content</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or, if there was an update since the <a href="#get"><code>GET</code></a> and the entity&#8217;s <a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>ETag</code></a> has changed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">&gt; HTTP/1.1 412 Precondition failed</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_pros_2"><a class="link" href="#_pros_2">Pros</a></h5>
<div class="ulist">
<ul>
<li>
<p>RESTful solution</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_cons_2"><a class="link" href="#_cons_2">Cons</a></h5>
<div class="ulist">
<ul>
<li>
<p>Many additional requests are necessary to build a meaningful front-end</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="etag-in-result-entities"><a class="link" href="#etag-in-result-entities"><code>ETags</code> in result entities</a></h4>
<div class="paragraph">
<p>The ETag for every entity is returned as an additional property of that entity.
In a response containing multiple entities, every entity will then have a
distinct <a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>ETag</code></a> that can be used in subsequent <a href="#put"><code>PUT</code></a> requests.</p>
</div>
<div class="paragraph">
<p>In this solution, the <a href="#etag"><code>etag</code></a> property should be <code>readonly</code> and never be expected
in the <a href="#put"><code>PUT</code></a> request payload.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">&lt; GET /orders

&gt; HTTP/1.1 200 OK
&gt; {
&gt;   &quot;items&quot;: [
&gt;     { &quot;id&quot;: &quot;O0000042&quot;, &quot;etag&quot;: &quot;osjnfkjbnkq3jlnksjnvkjlsbf&quot;, &quot;foo&quot;: 42, &quot;bar&quot;: true },
&gt;     { &quot;id&quot;: &quot;O0000043&quot;, &quot;etag&quot;: &quot;kjshdfknjqlowjdsljdnfkjbkn&quot;, &quot;foo&quot;: 24, &quot;bar&quot;: false }
&gt;   ]
&gt; }

&lt; PUT /orders/O0000042
&lt; If-Match: osjnfkjbnkq3jlnksjnvkjlsbf
&lt; { &quot;id&quot;: &quot;O0000042&quot;, &quot;foo&quot;: 43, &quot;bar&quot;: true }

&gt; HTTP/1.1 204 No Content</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or, if there was an update since the <a href="#get"><code>GET</code></a> and the entity&#8217;s <a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>ETag</code></a> has changed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">&gt; HTTP/1.1 412 Precondition failed</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_pros_3"><a class="link" href="#_pros_3">Pros</a></h5>
<div class="ulist">
<ul>
<li>
<p>Perfect optimistic locking</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_cons_3"><a class="link" href="#_cons_3">Cons</a></h5>
<div class="ulist">
<ul>
<li>
<p>Information that only belongs in the HTTP header is part of the business
objects</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_version_numbers"><a class="link" href="#_version_numbers">Version numbers</a></h4>
<div class="paragraph">
<p>The entities contain a property with a version number. When an update is
performed, this version number is given back to the service as part of the
payload. The service performs a check on that version number to make sure it
was not incremented since the consumer got the resource and performs the
update, incrementing the version number.</p>
</div>
<div class="paragraph">
<p>Since this operation implies a modification of the resource by the service, a
<a href="#post"><code>POST</code></a> operation on the exact resource (e.g. <code>POST /orders/O0000042</code>) should be
used instead of a <a href="#put"><code>PUT</code></a>.</p>
</div>
<div class="paragraph">
<p>In this solution, the <code>version</code> property is not <code>readonly</code> since it is provided
at <a href="#post"><code>POST</code></a> time as part of the payload.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">&lt; GET /orders

&gt; HTTP/1.1 200 OK
&gt; {
&gt;   &quot;items&quot;: [
&gt;     { &quot;id&quot;: &quot;O0000042&quot;, &quot;version&quot;: 1,  &quot;foo&quot;: 42, &quot;bar&quot;: true },
&gt;     { &quot;id&quot;: &quot;O0000043&quot;, &quot;version&quot;: 42, &quot;foo&quot;: 24, &quot;bar&quot;: false }
&gt;   ]
&gt; }

&lt; POST /orders/O0000042
&lt; { &quot;id&quot;: &quot;O0000042&quot;, &quot;version&quot;: 1, &quot;foo&quot;: 43, &quot;bar&quot;: true }

&gt; HTTP/1.1 204 No Content</code></pre>
</div>
</div>
<div class="paragraph">
<p>or if there was an update since the <a href="#get"><code>GET</code></a> and the version number in the
database is higher than the one given in the request body:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">&gt; HTTP/1.1 409 Conflict</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_pros_4"><a class="link" href="#_pros_4">Pros</a></h5>
<div class="ulist">
<ul>
<li>
<p>Perfect optimistic locking</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_cons_4"><a class="link" href="#_cons_4">Cons</a></h5>
<div class="ulist">
<ul>
<li>
<p>Functionality that belongs into the HTTP header becomes part of the
business object</p>
</li>
<li>
<p>Using <a href="#post"><code>POST</code></a> instead of PUT for an update logic (not a problem in itself,
but may feel unusual for the consumer)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_last_modified_if_unmodified_since"><a class="link" href="#_last_modified_if_unmodified_since"><code>Last-Modified</code> / <code>If-Unmodified-Since</code></a></h4>
<div class="paragraph">
<p>In HTTP 1.0 there was no <a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>ETag</code></a> and the mechanism used for optimistic locking
was based on a date. This is still part of the HTTP protocol and can be used.
Every response contains a <a href="https://tools.ietf.org/html/rfc9110#section-8.8.2"><code>Last-Modified</code></a> header with a HTTP date. When
requesting an update using a <a href="#put"><code>PUT</code></a> request, the client has to provide this
value via the header <a href="https://tools.ietf.org/html/rfc9110#section-13.1.4"><code>If-Unmodified-Since</code></a>. The server rejects the request, if
the last modified date of the entity is after the given date in the header.</p>
</div>
<div class="paragraph">
<p>This effectively catches any situations where a change that happened between
<a href="#get"><code>GET</code></a> and <a href="#put"><code>PUT</code></a> would be overwritten. In the case of multiple result entities,
the <a href="https://tools.ietf.org/html/rfc9110#section-8.8.2"><code>Last-Modified</code></a> header will be set to the latest date of all the entities.
This ensures that any change to any of the entities that happens between <a href="#get"><code>GET</code></a>
and <a href="#put"><code>PUT</code></a> will be detectable, without locking the rest of the batch as well.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">&lt; GET /orders

&gt; HTTP/1.1 200 OK
&gt; Last-Modified: Wed, 22 Jul 2009 19:15:56 GMT
&gt; {
&gt;   &quot;items&quot;: [
&gt;     { &quot;id&quot;: &quot;O0000042&quot;, ... },
&gt;     { &quot;id&quot;: &quot;O0000043&quot;, ... }
&gt;   ]
&gt; }

&lt; PUT /block/O0000042
&lt; If-Unmodified-Since: Wed, 22 Jul 2009 19:15:56 GMT
&lt; { &quot;id&quot;: &quot;O0000042&quot;, ... }

&gt; HTTP/1.1 204 No Content</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or, if there was an update since the <a href="#get"><code>GET</code></a> and the entities last modified is
later than the given date:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="http">&gt; HTTP/1.1 412 Precondition failed</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_pros_5"><a class="link" href="#_pros_5">Pros</a></h5>
<div class="ulist">
<ul>
<li>
<p>Well established approach that has been working for a long time</p>
</li>
<li>
<p>No interference with the business objects; the locking is done via HTTP
headers only</p>
</li>
<li>
<p>Very easy to implement</p>
</li>
<li>
<p>No additional request needed when updating an entity of a search endpoint
result</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_cons_5"><a class="link" href="#_cons_5">Cons</a></h5>
<div class="ulist">
<ul>
<li>
<p>If a client communicates with two different instances and their clocks are
not perfectly in sync, the locking could potentially fail</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conclusion"><a class="link" href="#_conclusion">Conclusion</a></h4>
<div class="paragraph">
<p>We suggest to either use the <em><a href="https://tools.ietf.org/html/rfc9110#section-8.8.3"><code>ETag</code></a> in result entities</em> or <em><a href="https://tools.ietf.org/html/rfc9110#section-8.8.2"><code>Last-Modified</code></a>
/ <a href="https://tools.ietf.org/html/rfc9110#section-13.1.4"><code>If-Unmodified-Since</code></a></em> approach.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="handling-compatible-extensions"><a class="link" href="#handling-compatible-extensions">Handling compatible API extensions</a></h3>
<div class="sect3">
<h4 id="client-handling-compatible-extensions"><a class="link" href="#client-handling-compatible-extensions">In the clients</a></h4>
<div class="paragraph">
<p>Client must not eliminate unknown optional fields from the
fetched resource payload, and to serialize them later when submitting the
complete resource payload back to the API server via <a href="#put"><code>PUT</code></a> (<a href="#108"><span class="must-keyword"><strong>MUST</strong></span> prepare clients to accept compatible API extensions</a>).</p>
</div>
<div class="paragraph">
<p>When using Java with Jackson serialization, for example, that can be achieved
by including a field in the Java class representing the API resource, like the
following one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@JsonAnyGetter</span>
<span class="annotation">@JsonAnySetter</span>
<span class="directive">private</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, JsonNode&gt; additionalProperties = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;&gt;();</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="appendix-changelog"><a class="link" href="#appendix-changelog">Appendix D: Changelog</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This change log only contains major changes and lists major changes since October 2016.</p>
</div>
<div class="paragraph">
<p>Non-major changes are editorial-only changes or minor changes of existing guidelines, e.g. adding new error code or specific example.
Major changes are changes that come with additional obligations, or even change an existing guideline obligation.
Major changes are listed as "Rule Changes" below.</p>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> Most recent major changes might be missing in the list since we update it
only occasionally, not with each pull request, to avoid merge commits.
Please have a look at the
<a href="https://github.com/zalando/restful-api-guidelines/commits/main">commit list in Github</a>
to see a list of all changes.</p>
</div>
<div class="sect2">
<h3 id="rule-changes"><a class="link" href="#rule-changes">Rule Changes</a></h3>
<div class="ulist">
<ul>
<li>
<p><code>2021-12-09</code>: event id must not change in retry situations when producers <a href="#211"><span class="must-keyword"><strong>MUST</strong></span> provide unique event identifiers</a>.</p>
</li>
<li>
<p><code>2021-11-24</code>: restructuring of the document and some rules.</p>
</li>
<li>
<p><code>2021-10-18</code>: new rule <a href="#244"><span class="should-keyword"><strong>SHOULD</strong></span> use content negotiation, if clients may choose from different resource representations</a>.</p>
</li>
<li>
<p><code>2021-10-12</code>: improve clarity on <a href="#patch"><code>PATCH</code></a> usage in rule <a href="#148"><span class="must-keyword"><strong>MUST</strong></span> use HTTP methods correctly</a>.</p>
</li>
<li>
<p><code>2021-08-24</code>: improve clarity on <a href="#put"><code>PUT</code></a> usage in rule <a href="#148"><span class="must-keyword"><strong>MUST</strong></span> use HTTP methods correctly</a>.</p>
</li>
<li>
<p><code>2021-08-24</code>: only use codes registered via IANA in rule <a href="#243"><span class="must-keyword"><strong>MUST</strong></span> use official HTTP status codes</a>.</p>
</li>
<li>
<p><code>2021-08-17</code>: update formats per OpenAPI 3.1 in <a href="#238"><span class="must-keyword"><strong>MUST</strong></span> use standard data formats</a>.</p>
</li>
<li>
<p><code>2021-06-22</code>: <a href="#238"><span class="must-keyword"><strong>MUST</strong></span> use standard data formats</a> changed from <span class="should-keyword"><strong>SHOULD</strong></span> to <span class="must-keyword"><strong>MUST</strong></span>; consistency for rules around standards for data.</p>
</li>
<li>
<p><code>2021-06-03</code>: <a href="#104"><span class="must-keyword"><strong>MUST</strong></span> secure endpoints</a> with clear distinction of OpenAPI security schemes, favoring <code>bearer</code> to <code>oauth2</code>.</p>
</li>
<li>
<p><code>2021-06-01</code>: resolve uncertainties around 'occurred_at' semantics of <a href="#event-metadata">event metadata</a>.</p>
</li>
<li>
<p><code>2021-05-25</code>: <a href="#172"><span class="should-keyword"><strong>SHOULD</strong></span> use standard media types</a> with <a href="#114">API endpoint versioning</a> as only custom media type usage exception.</p>
</li>
<li>
<p><code>2021-05-05</code>: define usage on resource-ids in <a href="#put"><code>PUT</code></a> and <a href="#post"><code>POST</code></a> in <a href="#148"><span class="must-keyword"><strong>MUST</strong></span> use HTTP methods correctly</a>.</p>
</li>
<li>
<p><code>2021-04-29</code>: improve clarity of <a href="#133"><span class="may-keyword"><strong>MAY</strong></span> use standard headers</a>.</p>
</li>
<li>
<p><code>2021-03-19</code>: clarity on <a href="#167"><span class="must-keyword"><strong>MUST</strong></span> use JSON as payload data interchange format</a>.</p>
</li>
<li>
<p><code>2021-03-15</code>: <a href="#242"><span class="must-keyword"><strong>MUST</strong></span> provide explicit event ordering for data change events</a> changed from <span class="should-keyword"><strong>SHOULD</strong></span> to <span class="must-keyword"><strong>MUST</strong></span>; improve clarity around <a href="#203">event ordering</a>.</p>
</li>
<li>
<p><code>2021-03-19</code>: best practice section <a href="#cursor-based-pagination">Cursor-based pagination in RESTful APIs</a></p>
</li>
<li>
<p><code>2021-02-16</code>: define how to reference models outside the api in <a href="#234"><span class="must-keyword"><strong>MUST</strong></span> only use durable and immutable remote references</a>.</p>
</li>
<li>
<p><code>2021-02-15</code>: improve guideline <a href="#176"><span class="must-keyword"><strong>MUST</strong></span> support problem JSON</a>&#8201;&#8212;&#8201;clients must be prepared to not receive problem return objects.</p>
</li>
<li>
<p><code>2021-01-19</code>: more details for <a href="#get-with-body"><code>GET with body</code></a> and <a href="#delete-with-body"><code>DELETE with body</code></a> (<a href="#148"><span class="must-keyword"><strong>MUST</strong></span> use HTTP methods correctly</a>).</p>
</li>
<li>
<p><code>2020-09-29</code>: include models for headers to be included by reference in API definitions (<a href="#183"><span class="should-keyword"><strong>SHOULD</strong></span> use only the specified proprietary Zalando headers</a>)</p>
</li>
<li>
<p><code>2020-09-08</code>: add exception for legacy host names to <a href="#224"><span class="must-keyword"><strong>MUST</strong></span> follow naming convention for hostnames</a></p>
</li>
<li>
<p><code>2020-08-25</code>: change <a href="#240"><span class="should-keyword"><strong>SHOULD</strong></span> declare enum values using UPPER_SNAKE_CASE string</a> from <span class="must-keyword"><strong>MUST</strong></span> to <span class="should-keyword"><strong>SHOULD</strong></span>, explain exceptions</p>
</li>
<li>
<p><code>2020-08-25</code>: add exception for <code>self</code> to <a href="#143"><span class="must-keyword"><strong>MUST</strong></span> identify resources and sub-resources via path segments</a> and <a href="#134"><span class="must-keyword"><strong>MUST</strong></span> pluralize resource names</a>.</p>
</li>
<li>
<p><code>2020-08-24</code>: change "<span class="must-keyword"><strong>MUST</strong></span> avoid trailing slashes" to <a href="#136"><span class="must-keyword"><strong>MUST</strong></span> use normalized paths without empty path segments and trailing slashes</a>.</p>
</li>
<li>
<p><code>2020-08-20</code>: change <a href="#183"><span class="should-keyword"><strong>SHOULD</strong></span> use only the specified proprietary Zalando headers</a> from <span class="must-keyword"><strong>MUST</strong></span> to <span class="should-keyword"><strong>SHOULD</strong></span>, mention gateway-specific headers (which are not part of the public API).</p>
</li>
<li>
<p><code>2020-06-30</code>: add details to <a href="#114"><span class="must-keyword"><strong>MUST</strong></span> use media type versioning</a></p>
</li>
<li>
<p><code>2020-05-19</code>: new sections about DELETE with query parameters and <a href="#delete-with-body"><code>DELETE with body</code></a> in <a href="#148"><span class="must-keyword"><strong>MUST</strong></span> use HTTP methods correctly</a>.</p>
</li>
<li>
<p><code>2020-02-06</code>: new rule <a href="#241"><span class="may-keyword"><strong>MAY</strong></span> expose compound keys as resource identifiers</a></p>
</li>
<li>
<p><code>2020-02-05</code>: add Sunset header, clarify deprecation producedure (<a href="#185"><span class="must-keyword"><strong>MUST</strong></span> obtain approval of clients before API shut down</a>, <a href="#186"><span class="must-keyword"><strong>MUST</strong></span> collect external partner consent on deprecation time span</a>, <a href="#187"><span class="must-keyword"><strong>MUST</strong></span> reflect deprecation in API specifications</a>, <a href="#188"><span class="must-keyword"><strong>MUST</strong></span> monitor usage of deprecated API scheduled for sunset</a>, <a href="#189"><span class="should-keyword"><strong>SHOULD</strong></span> add <code>Deprecation</code> and <code>Sunset</code> header to responses</a>, <a href="#190"><span class="should-keyword"><strong>SHOULD</strong></span> add monitoring for <code>Deprecation</code> and <code>Sunset</code> header</a>, <a href="#191"><span class="must-keyword"><strong>MUST</strong></span> not start using deprecated APIs</a>)</p>
</li>
<li>
<p><code>2020-01-21</code>: new rule <a href="#240"><span class="should-keyword"><strong>SHOULD</strong></span> declare enum values using UPPER_SNAKE_CASE string</a> (as MUST, changed later to SHOULD)</p>
</li>
<li>
<p><code>2020-01-15</code>: change "Warning" to "Deprecation" header in <a href="#189"><span class="should-keyword"><strong>SHOULD</strong></span> add <code>Deprecation</code> and <code>Sunset</code> header to responses</a>, <a href="#190"><span class="should-keyword"><strong>SHOULD</strong></span> add monitoring for <code>Deprecation</code> and <code>Sunset</code> header</a>.</p>
</li>
<li>
<p><code>2019-10-10</code>: remove never-implemented rule "<span class="must-keyword"><strong>MUST</strong></span> Permissions on events must correspond to API permissions"</p>
</li>
<li>
<p><code>2019-09-10</code>: remove duplicated rule "<span class="may-keyword"><strong>MAY</strong></span> Standards could be used for Language, Country and Currency", upgrade <a href="#170"><span class="must-keyword"><strong>MUST</strong></span> use standard formats for country, language and currency properties</a> from <span class="may-keyword"><strong>MAY</strong></span> to <span class="should-keyword"><strong>SHOULD</strong></span>.</p>
</li>
<li>
<p><code>2019-08-29</code>: new rule <a href="#239"><span class="must-keyword"><strong>MUST</strong></span> encode binary data in <code>base64url</code></a>, extend <a href="#167"><span class="must-keyword"><strong>MUST</strong></span> use JSON as payload data interchange format</a> pointing to <a href="https://tools.ietf.org/html/rfc7493">RFC-7493</a></p>
</li>
<li>
<p><code>2019-08-29</code>: new rules <a href="#236"><span class="should-keyword"><strong>SHOULD</strong></span> design simple query languages using query parameters</a>, <a href="#237"><span class="should-keyword"><strong>SHOULD</strong></span> design complex query languages using JSON</a></p>
</li>
<li>
<p><code>2019-07-30</code>: new rule <a href="#238"><span class="must-keyword"><strong>MUST</strong></span> use standard data formats</a></p>
</li>
<li>
<p><code>2019-07-30</code>: change <a href="#173"><span class="must-keyword"><strong>MUST</strong></span> use the common money object</a> from <span class="should-keyword"><strong>SHOULD</strong></span> to <span class="must-keyword"><strong>MUST</strong></span></p>
</li>
<li>
<p><code>2019-07-30</code>: change "<span class="should-keyword"><strong>SHOULD</strong></span> Null values should have their fields removed to" <a href="#123"><span class="must-keyword"><strong>MUST</strong></span> use same semantics for <code>null</code> and absent properties</a>.</p>
</li>
<li>
<p><code>2019-07-25</code>: new rule <a href="#235"><span class="should-keyword"><strong>SHOULD</strong></span> name date/time properties with <code>_at</code> suffix</a>.</p>
</li>
<li>
<p><code>2019-07-18</code>: improved cursor guideline for <a href="#get-with-body"><code>GET with body</code></a>.</p>
</li>
<li>
<p><code>2019-06-25</code>: change <a href="#154"><span class="must-keyword"><strong>MUST</strong></span> define collection format of header and query parameters</a> from <span class="should-keyword"><strong>SHOULD</strong></span> to <span class="must-keyword"><strong>MUST</strong></span>, use OpenAPI 3 syntax</p>
</li>
<li>
<p><code>2019-06-13</code>: remove <code>X-App-Domain</code> from <a href="#183"><span class="should-keyword"><strong>SHOULD</strong></span> use only the specified proprietary Zalando headers</a>.</p>
</li>
<li>
<p><code>2019-05-17</code>: add <code>X-Mobile-Advertising-Id</code> to <a href="#183"><span class="should-keyword"><strong>SHOULD</strong></span> use only the specified proprietary Zalando headers</a>.</p>
</li>
<li>
<p><code>2019-04-09</code> New rule <a href="#234"><span class="must-keyword"><strong>MUST</strong></span> only use durable and immutable remote references</a></p>
</li>
<li>
<p><code>2019-02-19</code>: New rule <a href="#233"><span class="must-keyword"><strong>MUST</strong></span> support <code>X-Flow-ID</code></a> extracted + expanded from <a href="#183"><span class="should-keyword"><strong>SHOULD</strong></span> use only the specified proprietary Zalando headers</a>.</p>
</li>
<li>
<p><code>2019-01-24:</code> Improve guidance on caching (<a href="#149"><span class="must-keyword"><strong>MUST</strong></span> fulfill common method properties</a>, <a href="#227"><span class="must-keyword"><strong>MUST</strong></span> document cacheable <code>GET</code>, <code>HEAD</code>, and <code>POST</code> endpoints</a>).</p>
</li>
<li>
<p><code>2019-01-21:</code> Improve guidance on idempotency, introduce idempotency-key (<a href="#229"><span class="should-keyword"><strong>SHOULD</strong></span> consider to design <code>POST</code> and <code>PATCH</code> idempotent</a>, <a href="#231"><span class="should-keyword"><strong>SHOULD</strong></span> use secondary key for idempotent <code>POST</code> design</a>).</p>
</li>
<li>
<p><code>2019-01-16</code>: Change <a href="#135"><span class="should-keyword"><strong>SHOULD</strong></span> not use /api as base path</a> from <span class="may-keyword"><strong>MAY</strong></span> to {SHOULD NOT}</p>
</li>
<li>
<p><code>2018-10-19</code>: Add <code>ordering_key_field</code> to event type definition schema (<a href="#197"><span class="must-keyword"><strong>MUST</strong></span> specify and register events as event types</a>, <a href="#203"><span class="should-keyword"><strong>SHOULD</strong></span> provide explicit event ordering for general events</a>)</p>
</li>
<li>
<p><code>2018-09-28</code>: New rule <a href="#228"><span class="must-keyword"><strong>MUST</strong></span> use URL-friendly resource identifiers</a></p>
</li>
<li>
<p><code>2018-09-13</code>: replaced OpenAPI 2.0 syntax with OpenAPI 3.0 in the example snippets</p>
</li>
<li>
<p><code>2018-08-10</code>: New rule <a href="#226"><span class="must-keyword"><strong>MUST</strong></span> document implicit response filtering</a></p>
</li>
<li>
<p><code>2018-07-12</code>: Add <code>audience</code> field to event type definition (<a href="#197"><span class="must-keyword"><strong>MUST</strong></span> specify and register events as event types</a>)</p>
</li>
<li>
<p><code>2018-06-11:</code> Introduced new naming guidelines for host, permission, and event names.</p>
</li>
<li>
<p><code>2018-01-10:</code> Moved meta information related aspects into new chapter <a href="#meta-information">REST Basics - Meta information</a>.</p>
</li>
<li>
<p><code>2018-01-09:</code> Changed publication requirements for API specifications (<a href="#192"><span class="must-keyword"><strong>MUST</strong></span> publish OpenAPI specification</a>).</p>
</li>
<li>
<p><code>2017-12-07:</code> Added best practices section including discussion about optimistic locking approaches.</p>
</li>
<li>
<p><code>2017-11-28:</code> Changed OAuth flow example from password to client credentials in <a href="#security">REST Basics - Security</a>.</p>
</li>
<li>
<p><code>2017-11-22:</code> Updated description of X-Tenant-ID header field</p>
</li>
<li>
<p><code>2017-08-22:</code> Migration to Asciidoc</p>
</li>
<li>
<p><code>2017-07-20:</code> Be more precise on client vs. server obligations for compatible API extensions.</p>
</li>
<li>
<p><code>2017-06-06:</code> Made money object guideline clearer.</p>
</li>
<li>
<p><code>2017-05-17:</code> Added guideline on query parameter collection format.</p>
</li>
<li>
<p><code>2017-05-10:</code> Added the convention of using RFC2119 to describe guideline levels, and replaced <code>book.could</code> with <code>book.may</code>.</p>
</li>
<li>
<p><code>2017-03-30:</code> Added rule that permissions on resources in events must correspond to permissions on API resources</p>
</li>
<li>
<p><code>2017-03-30:</code> Added rule that APIs should be modelled around business processes</p>
</li>
<li>
<p><code>2017-02-28:</code> Extended information about how to reference sub-resources and the usage of composite identifiers in the <a href="#143"><span class="must-keyword"><strong>MUST</strong></span> identify resources and sub-resources via path segments</a>
part.</p>
</li>
<li>
<p><code>2017-02-22:</code> Added guidance for conditional requests with If-Match/If-None-Match</p>
</li>
<li>
<p><code>2017-02-02:</code> Added guideline for batch and bulk request</p>
</li>
<li>
<p><code>2017-02-01:</code> <a href="#180"><span class="should-keyword"><strong>SHOULD</strong></span> use <code>Location</code> header instead of <code>Content-Location</code> header</a></p>
</li>
<li>
<p><code>2017-01-18:</code> Removed "Avoid Javascript Keywords" rule</p>
</li>
<li>
<p><code>2017-01-05:</code> Clarification on the usage of the term "REST/RESTful"</p>
</li>
<li>
<p><code>2016-12-07:</code> Introduced "API as a Product" principle</p>
</li>
<li>
<p><code>2016-12-06:</code> New guideline: "Should Only Use UUIDs If Necessary"</p>
</li>
<li>
<p><code>2016-12-04:</code> Changed OAuth flow example from implicit to password in <a href="#security">REST Basics - Security</a>.</p>
</li>
<li>
<p><code>2016-10-13:</code> <a href="#172"><span class="should-keyword"><strong>SHOULD</strong></span> use standard media types</a></p>
</li>
<li>
<p><code>2016-10-10:</code> Introduced the changelog. From now on all rule changes on API guidelines will be recorded here.</p>
</li>
</ul>
</div>
<!-- Adds rule id as a postfix to all rule titles -->
<script>
var ruleIdRegEx = /(\d)+/;
var h3headers = document.getElementsByTagName("h3");
for (var i = 0; i < h3headers.length; i++) {
    var header = h3headers[i];
    if (header.id && header.id.match(ruleIdRegEx)) {
        var a = header.getElementsByTagName("a")[0]
        a.innerHTML += " [" + header.id + "]";
    }
}
</script>

<!-- Add table of contents anchor and remove document title -->
<script>
var toc = document.getElementById('toc');
var div = document.createElement('div');
div.id = 'table-of-contents';
toc.parentNode.replaceChild(div, toc);
div.appendChild(toc);
var ul = toc.childNodes[3];
ul.removeChild(ul.childNodes[1]);
</script>

<!-- Adds sidebar navigation -->
<script>
var header = document.getElementById('header');
var nav = document.createElement('div');
nav.id = 'toc';
nav.classList.add('toc2');
var title = document.createElement('div');
title.id = 'toctitle';

var link = document.createElement('a');
link.innerText = 'API Guidelines';
link.href = '#';

title.append(link);
nav.append(title);

var ul = document.createElement('ul');
ul.classList.add('sectlevel1');

var link = document.createElement('a');
link.innerHTML = 'Table of Contents';
link.href = '#table-of-contents';
li = document.createElement('li');
li.append(link);
ul.append(li);

var link, li;
var h2headers = document.getElementsByTagName('h2');
for (var i = 1; i < h2headers.length; i++) {
    var a = h2headers[i].getElementsByTagName("a")[0];
    if (a !== undefined) {
        link = document.createElement('a');
        link.innerHTML = a.innerHTML;
        link.href = a.hash;
        li = document.createElement('li');
        li.append(link);
        ul.append(li);
    }
}

document.body.classList.add('toc2');
document.body.classList.add('toc-left');
nav.append(ul);
header.prepend(nav);
</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-130687305-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-130687305-1');

  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-130687305-1', 'auto');

  function trackPageview() {
    var title = (location.hash && location.hash.length > 0) ?
      document.getElementById(location.hash.replace('#','')).textContent :
      document.title;

    ga('send', 'pageview', {'page': location.pathname + location.hash, 'title': title});
  }

  if ("onhashchange" in window)
    window.onhashchange = trackPageview;

  trackPageview(); // track user's first pageview
</script>

<!-- Cookies Consent -->
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#eaf7f7",
      "text": "#5c7291"
    },
    "button": {
      "background": "#56cbdb",
      "text": "#ffffff"
    }
  },
  "content": {
    "message": "This web site uses cookies to analyze the general behavior of visitors."
  }
})});
</script>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. Per definition of R.Fielding REST APIs have to support HATEOAS (maturity level 3). Our guidelines do not strongly advocate for full REST compliance, but limited hypermedia usage, e.g. for pagination (see <a href="#hypermedia">REST Design - Hypermedia</a>). However, we still use the term "RESTful API", due to the absence of an alternative established term and to keep it like the very majority of web service industry that also use the term for their REST approximations — in fact, in today&#8217;s industry full HATEOAS compliant APIs are a very rare exception.
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. HTTP/1.1 standard (<a href="https://tools.ietf.org/html/rfc9110#section-7.6.1">RFC 9110 Section 7.6.1</a>) defines two types of headers: <em>end-to-end</em> and <em>hop-by-hop</em> headers. End-to-end headers must be transmitted to the ultimate recipient of a request or response. Hop-by-hop headers, on the contrary, are meaningful for a single connection only.
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2024-04-16 12:36:59 UTC
</div>
</div>
</body>
</html>